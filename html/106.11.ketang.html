<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>珠峰架构师成长计划</title>
    <link rel="stylesheet" type="text/css" href="../static/css/main.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" >
    <style>
        .page-toc > ul .red {
            background: #f3f3f3;
            z-index: 1;
            border-left: 3px solid #009a61;
            -webkit-transition: all .2s ease;
            transition: all .2s ease;
            color: #000
        }
    </style>
</head>
<body>
<div class="nav">
  <div class="logo">珠峰架构师成长计划</div>
  <ul>
    <li><a href="../index.html">0.api</a></li>
    <li><a href="../html/0.Async.html">0.Async</a></li>
    <li><a href="../html/0.module.html">0.module</a></li>
    <li><a href="../html/1.ES2015.html">1.ES2015</a></li>
    <li><a href="../html/2.Promise.html">2.Promise</a></li>
    <li><a href="../html/3.Node.html">3.Node</a></li>
    <li><a href="../html/4.NodeInstall.html">4.NodeInstall</a></li>
    <li><a href="../html/5.REPL.html">5.REPL</a></li>
    <li><a href="../html/6.NodeCore.html">6.NodeCore</a></li>
    <li><a href="../html/7.module&NPM.html">7.module&NPM</a></li>
    <li><a href="../html/8.Encoding.html">8.Encoding</a></li>
    <li><a href="../html/9.Buffer.html">9.Buffer</a></li>
    <li><a href="../html/10.fs.html">10.fs</a></li>
    <li><a href="../html/11.Stream-1.html">11.Stream-1</a></li>
    <li><a href="../html/11.Stream-2.html">11.Stream-2</a></li>
    <li><a href="../html/11.Stream-3.html">11.Stream-3</a></li>
    <li><a href="../html/11.Stream-4.html">11.Stream-4</a></li>
    <li><a href="../html/12-Network-2.html">12-Network-2</a></li>
    <li><a href="../html/12.NetWork-3.html">12.NetWork-3</a></li>
    <li><a href="../html/12.Network-1.html">12.Network-1</a></li>
    <li><a href="../html/13.tcp.html">13.tcp</a></li>
    <li><a href="../html/14.http-1.html">14.http-1</a></li>
    <li><a href="../html/14.http-2.html">14.http-2</a></li>
    <li><a href="../html/15.compress.html">15.compress</a></li>
    <li><a href="../html/16.crypto.html">16.crypto</a></li>
    <li><a href="../html/17.process.html">17.process</a></li>
    <li><a href="../html/18.yargs.html">18.yargs</a></li>
    <li><a href="../html/19.cache.html">19.cache</a></li>
    <li><a href="../html/20.action.html">20.action</a></li>
    <li><a href="../html/21.https.html">21.https</a></li>
    <li><a href="../html/22.cookie.html">22.cookie</a></li>
    <li><a href="../html/23.session.html">23.session</a></li>
    <li><a href="../html/24.express-1.html">24.express-1</a></li>
    <li><a href="../html/24.express-2.html">24.express-2</a></li>
    <li><a href="../html/24.express-3.html">24.express-3</a></li>
    <li><a href="../html/24.express-4.html">24.express-4</a></li>
    <li><a href="../html/25.koa-1.html">25.koa-1</a></li>
    <li><a href="../html/26.webpack-1-basic.html">26.webpack-1-basic</a></li>
    <li>
      <a href="../html/26.webpack-2-optimize.html">26.webpack-2-optimize</a>
    </li>
    <li><a href="../html/26.webpack-3-file.html">26.webpack-3-file</a></li>
    <li>
      <a href="../html/26.webpack-4.tapable.html">26.webpack-4.tapable</a>
    </li>
    <li><a href="../html/26.webpack-5-AST.html">26.webpack-5-AST</a></li>
    <li>
      <a href="../html/26.webpack-6-sources.html">26.webpack-6-sources</a>
    </li>
    <li><a href="../html/26.webpack-7-loader.html">26.webpack-7-loader</a></li>
    <li><a href="../html/26.webpack-8-plugin.html">26.webpack-8-plugin</a></li>
    <li><a href="../html/26.webpack-9-hand.html">26.webpack-9-hand</a></li>
    <li>
      <a href="../html/26.webpack-10-prepare.html">26.webpack-10-prepare</a>
    </li>
    <li><a href="../html/28.redux.html">28.redux</a></li>
    <li><a href="../html/28.redux-jwt-back.html">28.redux-jwt-back</a></li>
    <li><a href="../html/28.redux-jwt-front.html">28.redux-jwt-front</a></li>
    <li><a href="../html/29.mongodb-1.html">29.mongodb-1</a></li>
    <li><a href="../html/29.mongodb-2.html">29.mongodb-2</a></li>
    <li><a href="../html/29.mongodb-3.html">29.mongodb-3</a></li>
    <li><a href="../html/29.mongodb-4.html">29.mongodb-4</a></li>
    <li><a href="../html/29.mongodb-5.html">29.mongodb-5</a></li>
    <li><a href="../html/29.mongodb-6.html">29.mongodb-6</a></li>
    <li><a href="../html/30.cms-1-mysql.html">30.cms-1-mysql</a></li>
    <li><a href="../html/30.cms-2-mysql.html">30.cms-2-mysql</a></li>
    <li><a href="../html/30.cms-3-mysql.html">30.cms-3-mysql</a></li>
    <li><a href="../html/30.cms-4-nunjucks.html">30.cms-4-nunjucks</a></li>
    <li><a href="../html/30.cms-5-mock.html">30.cms-5-mock</a></li>
    <li><a href="../html/30.cms-6-egg.html">30.cms-6-egg</a></li>
    <li><a href="../html/30.cms-7-api.html">30.cms-7-api</a></li>
    <li><a href="../html/30.cms-8-roadhog.html">30.cms-8-roadhog</a></li>
    <li><a href="../html/30.cms-9-yaml.html">30.cms-9-yaml</a></li>
    <li><a href="../html/30.cms-10-umi.html">30.cms-10-umi</a></li>
    <li><a href="../html/30.cms-12-dva.html">30.cms-12-dva</a></li>
    <li><a href="../html/30.cms-13-dva-ant.html">30.cms-13-dva-ant</a></li>
    <li><a href="../html/30.cms-14-front.html">30.cms-14-front</a></li>
    <li><a href="../html/30.cms-15-deploy.html">30.cms-15-deploy</a></li>
    <li><a href="../html/31.dva.html">31.dva</a></li>
    <li>
      <a href="../html/31.cms-13-dva-antdesign.html">31.cms-13-dva-antdesign</a>
    </li>
    <li><a href="../html/33.redis.html">33.redis</a></li>
    <li><a href="../html/34.unittest.html">34.unittest</a></li>
    <li><a href="../html/35.jwt.html">35.jwt</a></li>
    <li><a href="../html/36.websocket-1.html">36.websocket-1</a></li>
    <li><a href="../html/36.websocket-2.html">36.websocket-2</a></li>
    <li><a href="../html/38.chat-api-1.html">38.chat-api-1</a></li>
    <li><a href="../html/38.chat-api-2.html">38.chat-api-2</a></li>
    <li><a href="../html/38.chat-3.html">38.chat-3</a></li>
    <li><a href="../html/38.chat-api-3.html">38.chat-api-3</a></li>
    <li><a href="../html/38.chat.html">38.chat</a></li>
    <li><a href="../html/38.chat2.html">38.chat2</a></li>
    <li><a href="../html/38.chat2.html">38.chat2</a></li>
    <li><a href="../html/39.crawl-0.html">39.crawl-0</a></li>
    <li><a href="../html/39.crawl-1.html">39.crawl-1</a></li>
    <li><a href="../html/39.crawl-2.html">39.crawl-2</a></li>
    <li><a href="../html/40.deploy.html">40.deploy</a></li>
    <li><a href="../html/41.safe.html">41.safe</a></li>
    <li><a href="../html/42.test.html">42.test</a></li>
    <li><a href="../html/43.nginx.html">43.nginx</a></li>
    <li><a href="../html/44.enzyme.html">44.enzyme</a></li>
    <li><a href="../html/45.docker.html">45.docker</a></li>
    <li><a href="../html/46.elastic.html">46.elastic</a></li>
    <li><a href="../html/47.oauth.html">47.oauth</a></li>
    <li><a href="../html/48.wxpay.html">48.wxpay</a></li>
    <li><a href="../html/index.html">index</a></li>
    <li><a href="../html/52.UML.html">52.UML</a></li>
    <li><a href="../html/53.design.html">53.design</a></li>
    <li><a href="../html/index.html">index</a></li>
    <li><a href="../html/54.linux.html">54.linux</a></li>
    <li><a href="../html/57.ts.html">57.ts</a></li>
    <li><a href="../html/56.react-ssr.html">56.react-ssr</a></li>
    <li><a href="../html/58.ts_react.html">58.ts_react</a></li>
    <li><a href="../html/59.ketang.html">59.ketang</a></li>
    <li><a href="../html/59.ketang2.html">59.ketang2</a></li>
    <li><a href="../html/61.1.devops-linux.html">61.1.devops-linux</a></li>
    <li><a href="../html/61.2.devops-vi.html">61.2.devops-vi</a></li>
    <li><a href="../html/61.3.devops-user.html">61.3.devops-user</a></li>
    <li><a href="../html/61.4.devops-auth.html">61.4.devops-auth</a></li>
    <li><a href="../html/61.5.devops-shell.html">61.5.devops-shell</a></li>
    <li><a href="../html/61.6.devops-install.html">61.6.devops-install</a></li>
    <li><a href="../html/61.7.devops-system.html">61.7.devops-system</a></li>
    <li><a href="../html/61.8.devops-service.html">61.8.devops-service</a></li>
    <li><a href="../html/61.9.devops-network.html">61.9.devops-network</a></li>
    <li><a href="../html/61.10.devops-nginx.html">61.10.devops-nginx</a></li>
    <li><a href="../html/61.11.devops-docker.html">61.11.devops-docker</a></li>
    <li><a href="../html/61.12.devops-jekins.html">61.12.devops-jekins</a></li>
    <li><a href="../html/61.13.devops-groovy.html">61.13.devops-groovy</a></li>
    <li><a href="../html/61.14.devops-php.html">61.14.devops-php</a></li>
    <li><a href="../html/61.15.devops-java.html">61.15.devops-java</a></li>
    <li><a href="../html/61.16.devops-node.html">61.16.devops-node</a></li>
    <li><a href="../html/61.17.devops-k8s.html">61.17.devops-k8s</a></li>
    <li><a href="../html/62.1.react-basic.html">62.1.react-basic</a></li>
    <li><a href="../html/62.2.react-state.html">62.2.react-state</a></li>
    <li><a href="../html/62.3.react-high.html">62.3.react-high</a></li>
    <li><a href="../html/62.4.react-optimize.html">62.4.react-optimize</a></li>
    <li><a href="../html/62.5.react-hooks.html">62.5.react-hooks</a></li>
    <li>
      <a href="../html/62.6.react-immutable.html">62.6.react-immutable</a>
    </li>
    <li><a href="../html/62.7.react-mobx.html">62.7.react-mobx</a></li>
    <li><a href="../html/62.8.react-source.html">62.8.react-source</a></li>
    <li><a href="../html/63.1.redux.html">63.1.redux</a></li>
    <li>
      <a href="../html/63.2.redux-middleware.html">63.2.redux-middleware</a>
    </li>
    <li><a href="../html/63.3.redux-hooks.html">63.3.redux-hooks</a></li>
    <li><a href="../html/63.4.redux-saga.html">63.4.redux-saga</a></li>
    <li>
      <a href="../html/63.5.redux-saga-hand.html">63.5.redux-saga-hand</a>
    </li>
    <li><a href="../html/64.1.router.html">64.1.router</a></li>
    <li>
      <a href="../html/64.2.router-connected.html">64.2.router-connected</a>
    </li>
    <li><a href="../html/65.1.typescript.html">65.1.typescript</a></li>
    <li><a href="../html/65.2.typescript.html">65.2.typescript</a></li>
    <li><a href="../html/65.3.typescript.html">65.3.typescript</a></li>
    <li><a href="../html/65.4.antd.html">65.4.antd</a></li>
    <li><a href="../html/65.4.definition.html">65.4.definition</a></li>
    <li><a href="../html/66-1.vue-base.html">66-1.vue-base</a></li>
    <li><a href="../html/66-2.vue-component.html">66-2.vue-component</a></li>
    <li><a href="../html/66-3.vue-cli3.0.html">66-3.vue-cli3.0</a></li>
    <li><a href="../html/66-4.$message组件.html">66-4.$message组件</a></li>
    <li><a href="../html/66-5.Form组件.html">66-5.Form组件</a></li>
    <li><a href="../html/66-6.tree.html">66-6.tree</a></li>
    <li>
      <a href="../html/66-7.vue-router-apply.html">66-7.vue-router-apply</a>
    </li>
    <li><a href="../html/66-8.axios-apply.html">66-8.axios-apply</a></li>
    <li><a href="../html/66-9.vuex-apply.html">66-9.vuex-apply</a></li>
    <li><a href="../html/66-10.jwt-vue.html">66-10.jwt-vue</a></li>
    <li><a href="../html/66-11.vue-ssr.html">66-11.vue-ssr</a></li>
    <li><a href="../html/66-12.nuxt-apply.html">66-12.nuxt-apply</a></li>
    <li><a href="../html/66-13.pwa.html">66-13.pwa</a></li>
    <li><a href="../html/66-14.vue单元测试.html">66-14.vue单元测试</a></li>
    <li><a href="../html/66-15.权限校验.html">66-15.权限校验</a></li>
    <li><a href="../html/67-1-network.html">67-1-network</a></li>
    <li><a href="../html/68-2-wireshark.html">68-2-wireshark</a></li>
    <li><a href="../html/7.npm2.html">7.npm2</a></li>
    <li><a href="../html/69-hooks.html">69-hooks</a></li>
    <li><a href="../html/70-deploy.html">70-deploy</a></li>
    <li><a href="../html/71-hmr.html">71-hmr</a></li>
    <li><a href="../html/72.deploy.html">72.deploy</a></li>
    <li><a href="../html/73.import.html">73.import</a></li>
    <li><a href="../html/74.mobile.html">74.mobile</a></li>
    <li>
      <a href="../html/75.webpack-1.文件分析.html">75.webpack-1.文件分析</a>
    </li>
    <li><a href="../html/75.webpack-2.loader.html">75.webpack-2.loader</a></li>
    <li>
      <a href="../html/75.webpack-3.源码流程.html">75.webpack-3.源码流程</a>
    </li>
    <li>
      <a href="../html/75.webpack-4.tapable.html">75.webpack-4.tapable</a>
    </li>
    <li>
      <a href="../html/75.webpack-5.prepare.html">75.webpack-5.prepare</a>
    </li>
    <li>
      <a href="../html/75.webpack-6.resolve.html">75.webpack-6.resolve</a>
    </li>
    <li><a href="../html/75.webpack-7.loader.html">75.webpack-7.loader</a></li>
    <li><a href="../html/75.webpack-8.module.html">75.webpack-8.module</a></li>
    <li><a href="../html/75.webpack-9.chunk.html">75.webpack-9.chunk</a></li>
    <li><a href="../html/75.webpack-10.asset.html">75.webpack-10.asset</a></li>
    <li><a href="../html/75.webpack-11.实现.html">75.webpack-11.实现</a></li>
    <li><a href="../html/76.react_optimize.html">76.react_optimize</a></li>
    <li><a href="../html/77.ts_ketang_back.html">77.ts_ketang_back</a></li>
    <li><a href="../html/77.ts_ketang_front.html">77.ts_ketang_front</a></li>
    <li><a href="../html/78.vue-domdiff.html">78.vue-domdiff</a></li>
    <li><a href="../html/79.grammar.html">79.grammar</a></li>
    <li><a href="../html/80.tree.html">80.tree</a></li>
    <li><a href="../html/81.axios.html">81.axios</a></li>
    <li><a href="../html/82.1.react.html">82.1.react</a></li>
    <li><a href="../html/82.2.react-high.html">82.2.react-high</a></li>
    <li><a href="../html/82.3.react-router.html">82.3.react-router</a></li>
    <li><a href="../html/82.4.redux.html">82.4.redux</a></li>
    <li>
      <a href="../html/82.5.redux_middleware.html">82.5.redux_middleware</a>
    </li>
    <li><a href="../html/82.6.connected.html">82.6.connected</a></li>
    <li><a href="../html/82.7.saga.html">82.7.saga</a></li>
    <li><a href="../html/82.8.dva.html">82.8.dva</a></li>
    <li><a href="../html/82.8.dva-source.html">82.8.dva-source</a></li>
    <li><a href="../html/82.9.roadhog.html">82.9.roadhog</a></li>
    <li><a href="../html/82.10.umi.html">82.10.umi</a></li>
    <li><a href="../html/82.11.antdesign.html">82.11.antdesign</a></li>
    <li><a href="../html/82.12.ketang-front.html">82.12.ketang-front</a></li>
    <li><a href="../html/82.12.ketang-back.html">82.12.ketang-back</a></li>
    <li><a href="../html/83.upload.html">83.upload</a></li>
    <li><a href="../html/84.graphql.html">84.graphql</a></li>
    <li><a href="../html/85.antpro.html">85.antpro</a></li>
    <li><a href="../html/86.1.uml.html">86.1.uml</a></li>
    <li><a href="../html/86.2.design.html">86.2.design</a></li>
    <li><a href="../html/87.postcss.html">87.postcss</a></li>
    <li><a href="../html/88.react16-1.html">88.react16-1</a></li>
    <li><a href="../html/89.nextjs.html">89.nextjs</a></li>
    <li><a href="../html/90.react-test.html">90.react-test</a></li>
    <li><a href="../html/91.react-ts.html">91.react-ts</a></li>
    <li><a href="../html/92.rbac.html">92.rbac</a></li>
    <li><a href="../html/93.tsnode.html">93.tsnode</a></li>
    <li><a href="../html/94.1.JavaScript.html">94.1.JavaScript</a></li>
    <li><a href="../html/94.2.JavaScript.html">94.2.JavaScript</a></li>
    <li><a href="../html/94.3.MODULE.html">94.3.MODULE</a></li>
    <li><a href="../html/94.4.EventLoop.html">94.4.EventLoop</a></li>
    <li><a href="../html/94.5.文件上传.html">94.5.文件上传</a></li>
    <li><a href="../html/94.6.https.html">94.6.https</a></li>
    <li><a href="../html/94.7. nginx.html">94.7. nginx</a></li>
    <li><a href="../html/95.1. react.html">95.1. react</a></li>
    <li><a href="../html/95.2.react.html">95.2.react</a></li>
    <li><a href="../html/96.1.react16.html">96.1.react16</a></li>
    <li><a href="../html/96.2.fiber.html">96.2.fiber</a></li>
    <li><a href="../html/96.3.fiber.html">96.3.fiber</a></li>
    <li><a href="../html/97.serverless.html">97.serverless</a></li>
    <li><a href="../html/98.websocket.html">98.websocket</a></li>
    <li><a href="../html/100.1.react-basic.html">100.1.react-basic</a></li>
    <li><a href="../html/101.1.monitor.html">101.1.monitor</a></li>
    <li><a href="../html/101.2.monitor.html">101.2.monitor</a></li>
    <li><a href="../html/102.java.html">102.java</a></li>
    <li><a href="../html/103.1.webpack-usage.html">103.1.webpack-usage</a></li>
    <li>
      <a href="../html/103.2.webpack-bundle.html">103.2.webpack-bundle</a>
    </li>
    <li><a href="../html/103.3.webpack-ast.html">103.3.webpack-ast</a></li>
    <li><a href="../html/103.4.webpack-flow.html">103.4.webpack-flow</a></li>
    <li>
      <a href="../html/103.5.webpack-loader.html">103.5.webpack-loader</a>
    </li>
    <li>
      <a href="../html/103.6.webpack-tapable.html">103.6.webpack-tapable</a>
    </li>
    <li>
      <a href="../html/103.7.webpack-plugin.html">103.7.webpack-plugin</a>
    </li>
    <li>
      <a href="../html/103.8.webpack-optimize1.html">103.8.webpack-optimize1</a>
    </li>
    <li>
      <a href="../html/103.9.webpack-optimize2.html">103.9.webpack-optimize2</a>
    </li>
    <li><a href="../html/103.10.webpack-hand.html">103.10.webpack-hand</a></li>
    <li><a href="../html/103.11.webpack-hmr.html">103.11.webpack-hmr</a></li>
    <li><a href="../html/103.13.splitChunks.html">103.13.splitChunks</a></li>
    <li>
      <a href="../html/103.14.webpack-sourcemap.html"
        >103.14.webpack-sourcemap</a
      >
    </li>
    <li>
      <a href="../html/103.15.webpack-compiler1.html"
        >103.15.webpack-compiler1</a
      >
    </li>
    <li>
      <a href="../html/103.15.webpack-compiler2.html"
        >103.15.webpack-compiler2</a
      >
    </li>
    <li><a href="../html/103.16.vite.basic.html">103.16.vite.basic</a></li>
    <li><a href="../html/103.16.vite.source.html">103.16.vite.source</a></li>
    <li><a href="../html/103.17.polyfill.html">103.17.polyfill</a></li>
    <li><a href="../html/104.1.binary.html">104.1.binary</a></li>
    <li><a href="../html/104.2.binary.html">104.2.binary</a></li>
    <li><a href="../html/105.skeleton.html">105.skeleton</a></li>
    <li><a href="../html/106.1.react.html">106.1.react</a></li>
    <li><a href="../html/106.2.react_hooks.html">106.2.react_hooks</a></li>
    <li><a href="../html/106.3.react_router.html">106.3.react_router</a></li>
    <li><a href="../html/106.4.redux.html">106.4.redux</a></li>
    <li>
      <a href="../html/106.5.redux_middleware.html">106.5.redux_middleware</a>
    </li>
    <li>
      <a href="../html/106.6.connected-react-router.html"
        >106.6.connected-react-router</a
      >
    </li>
    <li>
      <a href="../html/106.6.redux-first-history.html">106.6.redux-first-history</a>
    </li>
    <li><a href="../html/106.7.redux-saga.html">106.7.redux-saga</a></li>
    <li><a href="../html/106.8.dva.html">106.8.dva</a></li>
    <li><a href="../html/106.9.umi.html">106.9.umi</a></li>
    <li><a href="../html/106.10.ketang.html">106.10.ketang</a></li>
    <li><a href="../html/106.11.antdesign.html">106.11.antdesign</a></li>
    <li><a href="../html/106.12.antpro.html">106.12.antpro</a></li>
    <li><a href="../html/106.13.router-6.html">106.13.router-6</a></li>
    <li><a href="../html/107.fiber.html">107.fiber</a></li>
    <li><a href="../html/108.http.html">108.http</a></li>
    <li><a href="../html/109.1.webpack_usage.html">109.1.webpack_usage</a></li>
    <li>
      <a href="../html/109.2.webpack_source.html">109.2.webpack_source</a>
    </li>
    <li><a href="../html/109.3.dll.html">109.3.dll</a></li>
    <li><a href="../html/110.nest.js.html">110.nest.js</a></li>
    <li><a href="../html/111.xstate.html">111.xstate</a></li>
    <li><a href="../html/112.Form.html">112.Form</a></li>
    <li><a href="../html/113.redux-saga.html">113.redux-saga</a></li>
    <li>
      <a href="../html/114.react+typescript.html">114.react+typescript</a>
    </li>
    <li><a href="../html/115.immer.html">115.immer</a></li>
    <li><a href="../html/116.pro5.html">116.pro5</a></li>
    <li><a href="../html/117.css-loader.html">117.css-loader</a></li>
    <li><a href="../html/118.1.umi-core.html">118.1.umi-core</a></li>
    <li>
      <a href="../html/119.2.module-federation.html">119.2.module-federation</a>
    </li>
    <li>
      <a href="../html/119.1.module-federation.html">119.1.module-federation</a>
    </li>
    <li>
      <a href="../html/120.create-react-app.html">120.create-react-app</a>
    </li>
    <li><a href="../html/121.react-scripts.html">121.react-scripts</a></li>
    <li><a href="../html/122.react-optimize.html">122.react-optimize</a></li>
    <li><a href="../html/123.jsx-runtime.html">123.jsx-runtime</a></li>
    <li><a href="../html/124.next.js.html">124.next.js</a></li>
    <li><a href="../html/125.1.linux.html">125.1.linux</a></li>
    <li><a href="../html/125.2.linux-vi.html">125.2.linux-vi</a></li>
    <li><a href="../html/125.3.linux-user.html">125.3.linux-user</a></li>
    <li><a href="../html/125.4.linux-auth.html">125.4.linux-auth</a></li>
    <li><a href="../html/125.5.linux-shell.html">125.5.linux-shell</a></li>
    <li><a href="../html/125.6.linux-install.html">125.6.linux-install</a></li>
    <li><a href="../html/125.7.linux-system.html">125.7.linux-system</a></li>
    <li><a href="../html/125.8.linux-service.html">125.8.linux-service</a></li>
    <li><a href="../html/125.9.linux-network.html">125.9.linux-network</a></li>
    <li><a href="../html/125.10.nginx.html">125.10.nginx</a></li>
    <li><a href="../html/125.11.docker.html">125.11.docker</a></li>
    <li><a href="../html/125.12.ci.html">125.12.ci</a></li>
    <li><a href="../html/125.13.k8s.html">125.13.k8s</a></li>
    <li><a href="../html/125.14.k8s.html">125.14.k8s</a></li>
    <li><a href="../html/125.15.k8s.html">125.15.k8s</a></li>
    <li><a href="../html/125.16.k8s.html">125.16.k8s</a></li>
    <li><a href="../html/126.11.react-1.html">126.11.react-1</a></li>
    <li><a href="../html/126.12.react-2.html">126.12.react-2</a></li>
    <li><a href="../html/126.12.react-3.html">126.12.react-3</a></li>
    <li><a href="../html/126.12.react-4.html">126.12.react-4</a></li>
    <li><a href="../html/126.12.react-5.html">126.12.react-5</a></li>
    <li><a href="../html/127.frontend.html">127.frontend</a></li>
    <li><a href="../html/128.rollup.html">128.rollup</a></li>
    <li><a href="../html/129.px2rem-loader.html">129.px2rem-loader</a></li>
    <li><a href="../html/130.health.html">130.health</a></li>
    <li><a href="../html/131.hooks.html">131.hooks</a></li>
    <li><a href="../html/132.keepalive.html">132.keepalive</a></li>
    <li><a href="../html/133.vue-cli.html">133.vue-cli</a></li>
    <li><a href="../html/134.react18.html">134.react18</a></li>
    <li><a href="../html/135.function.html">135.function</a></li>
    <li><a href="../html/136.toolkit.html">136.toolkit</a></li>
    <li><a href="../html/137.lerna.html">137.lerna</a></li>
    <li><a href="../html/138.create-vite.html">138.create-vite</a></li>
    <li><a href="../html/139.cli.html">139.cli</a></li>
    <li><a href="../html/140.antd.html">140.antd</a></li>
    <li><a href="../html/141.react-dnd.html">141.react-dnd</a></li>
    <li><a href="../html/142.1.link.html">142.1.link</a></li>
    <li><a href="../html/143.1.gulp.html">143.1.gulp</a></li>
    <li><a href="../html/143.2.stream.html">143.2.stream</a></li>
    <li><a href="../html/143.3.gulp.html">143.3.gulp</a></li>
    <li><a href="../html/144.1.closure.html">144.1.closure</a></li>
    <li><a href="../html/144.2.v8.html">144.2.v8</a></li>
    <li><a href="../html/144.3.gc.html">144.3.gc</a></li>
    <li class="active"><a href="../html/145.react-router-v6.html">145.react-router-v6</a></li>
  </ul>
</div>

   
                    

                        
<div class="warpper">
    <div class="page-toc">
        <ul><li><a href="#t0第1章 搭建开发环境">第1章 搭建开发环境</a><ul><li><a href="#t11.1 本节目录">1.1 本节目录</a></li><li><a href="#t21.2 初始化项目">1.2 初始化项目</a></li><li><a href="#t31.3 安装依赖">1.3 安装依赖</a></li><li><a href="#t41.4 支持 typescript">1.4 支持 typescript</a></li><li><a href="#t51.5 编写 webpack 配置文件">1.5 编写 webpack 配置文件</a></li><li><a href="#t61.6 src\index.tsx">1.6 src\index.tsx</a></li><li><a href="#t71.7 public\index.html">1.7 public\index.html</a></li><li><a href="#t81.8 package.json">1.8 package.json</a></li></ul></li><li><a href="#t9第2天 实现底部路由">第2天 实现底部路由</a><ul><li><a href="#t102.1 src\index.tsx">2.1 src\index.tsx</a></li><li><a href="#t112.2 common.less">2.2 common.less</a></li><li><a href="#t122.3 Tabs\index.tsx">2.3 Tabs\index.tsx</a></li><li><a href="#t132.4 Tabs\index.less">2.4 Tabs\index.less</a></li><li><a href="#t142.5 history.tsx">2.5 history.tsx</a></li><li><a href="#t152.6 action-types.tsx">2.6 action-types.tsx</a></li><li><a href="#t162.7 reducers\home.tsx">2.7 reducers\home.tsx</a></li><li><a href="#t172.8 reducers\mine.tsx">2.8 reducers\mine.tsx</a></li><li><a href="#t182.9 reducers\profile.tsx">2.9 reducers\profile.tsx</a></li><li><a href="#t192.10 reducers\index.tsx">2.10 reducers\index.tsx</a></li><li><a href="#t202.11 store\index.tsx">2.11 store\index.tsx</a></li><li><a href="#t212.12 Home\index.tsx">2.12 Home\index.tsx</a></li><li><a href="#t222.13 Mine\index.tsx">2.13 Mine\index.tsx</a></li><li><a href="#t232.14 Profile\index.tsx">2.14 Profile\index.tsx</a></li></ul></li><li><a href="#t24第3章 实现首页头部导航">第3章 实现首页头部导航</a><ul><li><a href="#t253.1 资料">3.1 资料</a><ul><li><a href="#t263.1.1 文档">3.1.1 文档</a></li><li><a href="#t273.1.2 logo图">3.1.2 logo图</a></li><li><a href="#t283.1.3 本章代码">3.1.3 本章代码</a></li><li><a href="#t293.1.4 效果预览">3.1.4 效果预览</a></li><li><a href="#t303.1.5 本章布局">3.1.5 本章布局</a></li></ul></li><li><a href="#t313.2 tsconfig.json">3.2 tsconfig.json</a></li><li><a href="#t323.3 images.d.ts">3.3 images.d.ts</a></li><li><a href="#t333.4 HomeHeader\index.tsx">3.4 HomeHeader\index.tsx</a></li><li><a href="#t343.5 HomeHeader\index.less">3.5 HomeHeader\index.less</a></li><li><a href="#t353.6 action-types.tsx">3.6 action-types.tsx</a></li><li><a href="#t363.7 reducers\home.tsx">3.7 reducers\home.tsx</a></li><li><a href="#t373.8 actions\home.tsx">3.8 actions\home.tsx</a></li><li><a href="#t383.9 Home\index.tsx">3.9 Home\index.tsx</a></li><li><a href="#t393.10 Home\index.less">3.10 Home\index.less</a></li></ul></li><li><a href="#t40第4章 创建服务器端项目">第4章 创建服务器端项目</a><ul><li><a href="#t414.1 生成项目">4.1 生成项目</a></li><li><a href="#t424.2 安装依赖">4.2 安装依赖</a></li><li><a href="#t434.3 初始化 tsconfig.json">4.3 初始化 tsconfig.json</a></li><li><a href="#t444.4 .gitignore">4.4 .gitignore</a></li><li><a href="#t454.5 .env">4.5 .env</a></li><li><a href="#t464.6 src\index.ts">4.6 src\index.ts</a></li><li><a href="#t474.7 package.json">4.7 package.json</a></li><li><a href="#t484.8 测试">4.8 测试</a></li></ul></li><li><a href="#t49第5章 用户管理">第5章 用户管理</a><ul><li><a href="#t505.1 src/index.ts">5.1 src/index.ts</a></li><li><a href="#t515.2 src/exceptions/HttpException.ts">5.2 src/exceptions/HttpException.ts</a></li><li><a href="#t525.3 src/middlewares/errorMiddleware.ts">5.3 src/middlewares/errorMiddleware.ts</a></li><li><a href="#t535.4 src/utils/validator.ts">5.4 src/utils/validator.ts</a></li><li><a href="#t545.5 src/typings/jwt.ts">5.5 src/typings/jwt.ts</a></li><li><a href="#t555.6 src\models\index.ts">5.6 src\models\index.ts</a></li><li><a href="#t565.7 src/models/user.ts">5.7 src/models/user.ts</a></li><li><a href="#t575.8 src\controller\user.ts">5.8 src\controller\user.ts</a></li><li><a href="#t585.9 typings\express.d.ts">5.9 typings\express.d.ts</a></li><li><a href="#t595.10 .env">5.10 .env</a></li></ul></li><li><a href="#t60第6章 个人中心">第6章 个人中心</a><ul><li><a href="#t616.1  资料">6.1  资料</a><ul><li><a href="#t626.1.1 本章目录">6.1.1 本章目录</a></li><li><a href="#t636.1.2 本章效果">6.1.2 本章效果</a></li></ul></li><li><a href="#t646.2 Profile\index.tsx">6.2 Profile\index.tsx</a></li><li><a href="#t656.3 routes\Profile\index.less">6.3 routes\Profile\index.less</a></li><li><a href="#t666.4 action-types.tsx">6.4 action-types.tsx</a></li><li><a href="#t676.5 typings\login-types.tsx">6.5 typings\login-types.tsx</a></li><li><a href="#t686.6 reducers\profile.tsx">6.6 reducers\profile.tsx</a></li><li><a href="#t696.7 actions\profile.tsx">6.7 actions\profile.tsx</a></li><li><a href="#t706.8 api\index.tsx">6.8 api\index.tsx</a></li><li><a href="#t716.10 src\api\profile.tsx">6.10 src\api\profile.tsx</a></li><li><a href="#t726.11 NavHeader\index.tsx">6.11 NavHeader\index.tsx</a></li><li><a href="#t736.12 NavHeader\index.less">6.12 NavHeader\index.less</a></li></ul></li><li><a href="#t74第7章 注册登陆">第7章 注册登陆</a><ul><li><a href="#t757.1 参考">7.1 参考</a><ul><li><a href="#t767.1.1 目录结构">7.1.1 目录结构</a></li><li><a href="#t777.1.2 本章效果">7.1.2 本章效果</a></li></ul></li><li><a href="#t787.2 src\index.tsx">7.2 src\index.tsx</a></li><li><a href="#t797.3 api\profile.tsx">7.3 api\profile.tsx</a></li><li><a href="#t807.4 routes\Profile\index.tsx">7.4 routes\Profile\index.tsx</a></li><li><a href="#t817.5 action-types.tsx">7.5 action-types.tsx</a></li><li><a href="#t827.6 actions\profile.tsx">7.6 actions\profile.tsx</a></li><li><a href="#t837.7 src\typings\user.tsx">7.7 src\typings\user.tsx</a></li><li><a href="#t847.8 Register\index.tsx">7.8 Register\index.tsx</a></li><li><a href="#t857.9 Login\index.tsx">7.9 Login\index.tsx</a></li><li><a href="#t867.10 Login\index.less">7.10 Login\index.less</a></li></ul></li><li><a href="#t87第8章 上传头像">第8章 上传头像</a><ul><li><a href="#t888.1 参考">8.1 参考</a><ul><li><a href="#t898.1.1 本章目录">8.1.1 本章目录</a></li><li><a href="#t908.1.2 本章效果">8.1.2 本章效果</a></li></ul></li><li><a href="#t918.2 Profile\index.tsx">8.2 Profile\index.tsx</a></li><li><a href="#t928.3 action-types.tsx">8.3 action-types.tsx</a></li><li><a href="#t938.4 reducers\profile.tsx">8.4 reducers\profile.tsx</a></li><li><a href="#t948.5 actions\profile.tsx">8.5 actions\profile.tsx</a></li></ul></li><li><a href="#t95第9章 后台轮播图轮播图接口">第9章 后台轮播图轮播图接口</a><ul><li><a href="#t969.1 参考">9.1 参考</a><ul><li><a href="#t979.1.1 本章目录">9.1.1 本章目录</a></li></ul></li><li><a href="#t989.2 src\index.ts">9.2 src\index.ts</a></li><li><a href="#t999.3 controller\slider.ts">9.3 controller\slider.ts</a></li><li><a href="#t1009.4 models\slider.ts">9.4 models\slider.ts</a></li><li><a href="#t1019.5 src\models\index.ts">9.5 src\models\index.ts</a></li></ul></li><li><a href="#t102第10章 前台轮播图">第10章 前台轮播图</a><ul><li><a href="#t10310.1 参考">10.1 参考</a><ul><li><a href="#t10410.1.1 本章目录">10.1.1 本章目录</a></li><li><a href="#t10510.1.2 本章效果">10.1.2 本章效果</a></li></ul></li><li><a href="#t10610.2 action-types.tsx">10.2 action-types.tsx</a></li><li><a href="#t10710.3 actions\home.tsx">10.3 actions\home.tsx</a></li><li><a href="#t10810.4 typings\slider.tsx">10.4 typings\slider.tsx</a></li><li><a href="#t10910.5 reducers\home.tsx">10.5 reducers\home.tsx</a></li><li><a href="#t11010.6 api\home.tsx">10.6 api\home.tsx</a></li><li><a href="#t11110.7 HomeSliders\index.tsx">10.7 HomeSliders\index.tsx</a></li><li><a href="#t11210.8 HomeSliders\index.less">10.8 HomeSliders\index.less</a></li><li><a href="#t11310.9 routes\Home\index.tsx">10.9 routes\Home\index.tsx</a></li></ul></li><li><a href="#t114第11章 课程管理后端接口">第11章 课程管理后端接口</a><ul><li><a href="#t11511.1 参考">11.1 参考</a><ul><li><a href="#t11611.1.1 本章目录">11.1.1 本章目录</a></li><li><a href="#t11711.1.2 本章效果">11.1.2 本章效果</a></li></ul></li><li><a href="#t11811.2 src\index.ts">11.2 src\index.ts</a></li><li><a href="#t11911.3 src\models\index.ts">11.3 src\models\index.ts</a></li><li><a href="#t12011.4 controller\lesson.ts">11.4 controller\lesson.ts</a></li><li><a href="#t12111.5 models\lesson.ts">11.5 models\lesson.ts</a></li></ul></li><li><a href="#t122第12章 课程列表">第12章 课程列表</a><ul><li><a href="#t12312.1 参考">12.1 参考</a><ul><li><a href="#t12412.1.1 目录结构">12.1.1 目录结构</a></li><li><a href="#t12512.1.2 页面效果">12.1.2 页面效果</a></li></ul></li><li><a href="#t12612.2 src\api\home.tsx">12.2 src\api\home.tsx</a></li><li><a href="#t12712.3 action-types.tsx">12.3 action-types.tsx</a></li><li><a href="#t12812.4 typings\lesson.tsx">12.4 typings\lesson.tsx</a></li><li><a href="#t12912.5 reducers\home.tsx">12.5 reducers\home.tsx</a></li><li><a href="#t13012.6 actions\home.tsx">12.6 actions\home.tsx</a></li><li><a href="#t13112.7 src\utils.tsx">12.7 src\utils.tsx</a></li><li><a href="#t13212.8 LessonList\index.tsx">12.8 LessonList\index.tsx</a></li><li><a href="#t13312.9 LessonList\index.less">12.9 LessonList\index.less</a></li><li><a href="#t13412.10 routes\Home\index.tsx">12.10 routes\Home\index.tsx</a></li><li><a href="#t13512.11 routes\Home\index.less">12.11 routes\Home\index.less</a></li></ul></li><li><a href="#t136第13章 课程详情">第13章 课程详情</a><ul><li><a href="#t13713.1 参考">13.1 参考</a><ul><li><a href="#t13813.1.1 目录结构">13.1.1 目录结构</a></li><li><a href="#t13913.1.2 页面效果">13.1.2 页面效果</a></li></ul></li><li><a href="#t14013.2 src\index.tsx">13.2 src\index.tsx</a></li><li><a href="#t14113.3 src\api\home.tsx">13.3 src\api\home.tsx</a></li><li><a href="#t14213.4 routes\Detail\index.tsx">13.4 routes\Detail\index.tsx</a></li></ul></li><li><a href="#t143第14章 下拉刷新">第14章 下拉刷新</a><ul><li><a href="#t14414.1 参考">14.1 参考</a><ul><li><a href="#t14514.1.1 目录结构">14.1.1 目录结构</a></li></ul></li><li><a href="#t14614.2 src\utils.tsx">14.2 src\utils.tsx</a></li><li><a href="#t14714.3 action-types.tsx">14.3 action-types.tsx</a></li><li><a href="#t14814.4 reducers\home.tsx">14.4 reducers\home.tsx</a></li><li><a href="#t14914.5 Home\index.tsx">14.5 Home\index.tsx</a></li><li><a href="#t15014.6 Home\index.less">14.6 Home\index.less</a></li><li><a href="#t15114.7 HomeHeader\index.tsx">14.7 HomeHeader\index.tsx</a></li></ul></li><li><a href="#t152第15章 虚拟列表">第15章 虚拟列表</a><ul><li><a href="#t15315.1 参考">15.1 参考</a><ul><li><a href="#t15415.1.1 目录结构">15.1.1 目录结构</a></li><li><a href="#t15515.1.2 Home\index.tsx">15.1.2 Home\index.tsx</a></li><li><a href="#t15615.1.3 LessonList\index.tsx">15.1.3 LessonList\index.tsx</a></li></ul></li></ul></li><li><a href="#t157第16章 路由懒加载">第16章 路由懒加载</a><ul><li><a href="#t15816.1 src\index.tsx">16.1 src\index.tsx</a></li></ul></li><li><a href="#t159第17章 购物车">第17章 购物车</a><ul><li><a href="#t16017.1   src\index.tsx">17.1   src\index.tsx</a></li><li><a href="#t16117.2 Detail\index.tsx">17.2 Detail\index.tsx</a></li><li><a href="#t16217.3 action-types.tsx">17.3 action-types.tsx</a></li><li><a href="#t16317.4 typings\cart.tsx">17.4 typings\cart.tsx</a></li><li><a href="#t16417.5 cart.tsx">17.5 cart.tsx</a></li><li><a href="#t16517.6 reducers\home.tsx">17.6 reducers\home.tsx</a></li><li><a href="#t16617.7 reducers\index.tsx">17.7 reducers\index.tsx</a></li><li><a href="#t16717.8 store\index.tsx">17.8 store\index.tsx</a></li><li><a href="#t16817.9 actions\cart.tsx">17.9 actions\cart.tsx</a></li><li><a href="#t16917.10 Cart\index.tsx">17.10 Cart\index.tsx</a></li></ul></li></ul>
    </div>
    <div class="content markdown-body">
        <h2 id="t0&#x7B2C;1&#x7AE0; &#x642D;&#x5EFA;&#x5F00;&#x53D1;&#x73AF;&#x5883;">&#x7B2C;1&#x7AE0; &#x642D;&#x5EFA;&#x5F00;&#x53D1;&#x73AF;&#x5883; <a href="#t0&#x7B2C;1&#x7AE0; &#x642D;&#x5EFA;&#x5F00;&#x53D1;&#x73AF;&#x5883;"> # </a></h2>
<h3 id="t11.1 &#x672C;&#x8282;&#x76EE;&#x5F55;">1.1 &#x672C;&#x8282;&#x76EE;&#x5F55; <a href="#t11.1 &#x672C;&#x8282;&#x76EE;&#x5F55;"> # </a></h3>
<pre><code class="lang-js">-- client
    |-- package.json
    |-- public
    |   |-- index.html
    |-- src
    |   |-- index.tsx
    |-- tsconfig.json
    |-- webpack.config.js
</code></pre>
<h3 id="t21.2 &#x521D;&#x59CB;&#x5316;&#x9879;&#x76EE;">1.2 &#x521D;&#x59CB;&#x5316;&#x9879;&#x76EE; <a href="#t21.2 &#x521D;&#x59CB;&#x5316;&#x9879;&#x76EE;"> # </a></h3>
<pre><code class="lang-js">mkdir zfkt2020
cd zfkt2020
cnpm init -y
touch .gitignore
</code></pre>
<h3 id="t31.3 &#x5B89;&#x88C5;&#x4F9D;&#x8D56;">1.3 &#x5B89;&#x88C5;&#x4F9D;&#x8D56; <a href="#t31.3 &#x5B89;&#x88C5;&#x4F9D;&#x8D56;"> # </a></h3>
<ul>
<li>@types&#x5F00;&#x5934;&#x7684;&#x5305;&#x90FD;&#x662F;typeScript&#x7684;&#x58F0;&#x660E;&#x6587;&#x4EF6;&#xFF0C;&#x53EF;&#x4EE5;&#x8FDB;&#x5165;node_modules/@types/XX/index.d.ts&#x8FDB;&#x884C;&#x67E5;&#x770B;</li>
<li><a href="https://github.com/DefinitelyTyped/DefinitelyTyped">&#x5E38;&#x89C1;&#x7684;&#x58F0;&#x660E;&#x6587;&#x4EF6;</a></li>
<li><a href="https://ant.design/components/overview-cn/">ant.design</a></li>
</ul>
<pre><code class="lang-js">cnpm install react react-dom @types/react @types/react-dom react-router-dom @types/react-router-dom @ant-design/icons antd redux react-redux @types/react-redux redux-thunk  redux-logger @types/redux-logger redux-promise @types/redux-promise connected-react-router  classnames @types/classnames react-transition-group @types/react-transition-group express express-session body-parser cors axios  redux-persist immer redux-immer --save

cnpm install webpack webpack-cli webpack-dev-server html-webpack-plugin babel-loader typescript @babel/core @babel/preset-env @babel/preset-react @babel/preset-typescript  babel-plugin-<span class="hljs-keyword">import</span> style-loader css-loader postcss-loader less-loader less autoprefixer px2rem-loader  lib-flexible eslint @types/eslint --save-dev
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left">&#x6A21;&#x5757;&#x540D;</th>
<th style="text-align:left">&#x82F1;&#x6587;</th>
<th style="text-align:left">&#x4E2D;&#x6587;</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">react</td>
<td style="text-align:left">React is a JavaScript library for creating user interfaces.</td>
<td style="text-align:left">React &#x662F;&#x4E00;&#x4E2A;&#x7528;&#x4E8E;&#x521B;&#x5EFA;&#x7528;&#x6237;&#x754C;&#x9762;&#x7684; JavaScript &#x5E93;</td>
</tr>
<tr>
<td style="text-align:left">@types/react</td>
<td style="text-align:left">This package contains type definitions for React</td>
<td style="text-align:left">&#x5305;&#x542B; React &#x7684;&#x7C7B;&#x578B;&#x5B9A;&#x4E49;</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">react-dom</td>
<td style="text-align:left">This package serves as the entry point to the DOM and server renderers for React. It is intended to be paired with the generic React package, which is shipped as react to npm</td>
<td style="text-align:left">&#x628A; React &#x6E32;&#x67D3;&#x5230; DOM &#x4E0A;</td>
</tr>
<tr>
<td style="text-align:left">@types/react-dom</td>
<td style="text-align:left">This package contains type definitions for React (react-dom)</td>
<td style="text-align:left">&#x5305;&#x542B; React (react-dom)&#x7684;&#x7C7B;&#x578B;&#x5B9A;&#x4E49;</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">react-router-dom</td>
<td style="text-align:left">DOM bindings for React Router</td>
<td style="text-align:left">React &#x8DEF;&#x7531;&#x7684; DOM &#x6E32;&#x67D3;</td>
</tr>
<tr>
<td style="text-align:left">@types/react-router-dom</td>
<td style="text-align:left">This package contains type definitions for React Router</td>
<td style="text-align:left">React Router &#x7684;&#x7C7B;&#x578B;&#x5B9A;&#x4E49;</td>
</tr>
<tr>
<td style="text-align:left">react-transition-group</td>
<td style="text-align:left">A set of components for managing component states (including mounting and unmounting) over time, specifically designed with animation in mind</td>
<td style="text-align:left">&#x4E00;&#x7EC4;&#x7528;&#x4E8E;&#x968F;&#x65F6;&#x95F4;&#x7BA1;&#x7406;&#x7EC4;&#x4EF6;&#x72B6;&#x6001;&#xFF08;&#x5305;&#x62EC;&#x5B89;&#x88C5;&#x548C;&#x5378;&#x8F7D;&#xFF09;&#x7684;&#x7EC4;&#x4EF6;&#xFF0C;&#x7279;&#x522B;&#x8BBE;&#x8BA1;&#x65F6;&#x8003;&#x8651;&#x4E86;&#x52A8;&#x753B;</td>
</tr>
<tr>
<td style="text-align:left">@types/react-transition-group</td>
<td style="text-align:left">This package contains type definitions for react-transition-group</td>
<td style="text-align:left">react-transition-group &#x7684;&#x7C7B;&#x578B;&#x5B9A;&#x4E49;</td>
</tr>
<tr>
<td style="text-align:left">react-swipe</td>
<td style="text-align:left">Brad Birdsall&apos;s Swipe.js as a React component</td>
<td style="text-align:left">React &#x8F6E;&#x64AD;&#x56FE;&#x7EC4;&#x4EF6;</td>
</tr>
<tr>
<td style="text-align:left">@types/react-swipe</td>
<td style="text-align:left">This package contains type definitions for react-swipe</td>
<td style="text-align:left">React &#x8F6E;&#x64AD;&#x56FE;&#x7EC4;&#x4EF6;&#x7684;&#x7C7B;&#x578B;&#x5B9A;&#x4E49;</td>
</tr>
<tr>
<td style="text-align:left">antd</td>
<td style="text-align:left">An enterprise-class UI design language and React UI library</td>
<td style="text-align:left">&#x4F01;&#x4E1A;&#x7EA7; UI &#x8BBE;&#x8BA1;&#x8BED;&#x8A00;&#x548C; React UI &#x5E93;</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">qs</td>
<td style="text-align:left">A querystring parsing and stringifying library with some added security</td>
<td style="text-align:left">&#x4E00;&#x4E2A;&#x5E26;&#x6709;&#x4E00;&#x4E9B;&#x9644;&#x52A0;&#x5B89;&#x5168;&#x6027;&#x7684; querystring &#x89E3;&#x6790;&#x548C;&#x5B57;&#x7B26;&#x4E32;&#x5316;&#x5E93;</td>
</tr>
<tr>
<td style="text-align:left">@types/qs</td>
<td style="text-align:left">This package contains type definitions for qs</td>
<td style="text-align:left">&#x8BE5;&#x8F6F;&#x4EF6;&#x5305;&#x5305;&#x542B; qs &#x7684;&#x7C7B;&#x578B;&#x5B9A;&#x4E49;</td>
</tr>
<tr>
<td style="text-align:left">webpack</td>
<td style="text-align:left">webpack is a module bundler. Its main purpose is to bundle JavaScript files for usage in a browser, yet it is also capable of transforming, bundling, or packaging just about any resource or asset.</td>
<td style="text-align:left">webpack &#x662F;&#x4E00;&#x4E2A;&#x6A21;&#x5757;&#x6253;&#x5305;&#x5668;&#x3002;&#x5B83;&#x7684;&#x4E3B;&#x8981;&#x76EE;&#x7684;&#x662F;&#x6253;&#x5305; JavaScript &#x6587;&#x4EF6;&#x4EE5;&#x5728;&#x6D4F;&#x89C8;&#x5668;&#x4E2D;&#x4F7F;&#x7528;&#xFF0C;&#x4F46;&#x5B83;&#x4E5F;&#x80FD;&#x591F;&#x8F6C;&#x6362;&#x6216;&#x6253;&#x5305;&#x51E0;&#x4E4E;&#x4EFB;&#x4F55;&#x8D44;&#x6E90;</td>
<td></td>
</tr>
<tr>
<td style="text-align:left">webpack-cli</td>
<td style="text-align:left">webpack CLI provides a flexible set of commands for developers to increase speed when setting up a custom webpack project. As of webpack v4, webpack is not expecting a configuration file, but often developers want to create a more custom webpack configuration based on their use-cases and needs. webpack CLI addresses these needs by providing a set of tools to improve the setup of custom webpack configuration.</td>
<td style="text-align:left">webpack cli &#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x7EC4;&#x7075;&#x6D3B;&#x7684;&#x547D;&#x4EE4;&#xFF0C;&#x4F9B;&#x5F00;&#x53D1;&#x4EBA;&#x5458;&#x5728;&#x8BBE;&#x7F6E;&#x81EA;&#x5B9A;&#x4E49; webpack &#x9879;&#x76EE;&#x65F6;&#x63D0;&#x9AD8;&#x901F;&#x5EA6;</td>
</tr>
<tr>
<td style="text-align:left">webpack-dev-server</td>
<td style="text-align:left">Use webpack with a development server that provides live reloading. This should be used for development only</td>
<td style="text-align:left">&#x5C06; webpack &#x4E0E;&#x63D0;&#x4F9B;&#x5B9E;&#x65F6;&#x91CD;&#x8F7D;&#x7684;&#x5F00;&#x53D1;&#x670D;&#x52A1;&#x5668;&#x4E00;&#x8D77;&#x4F7F;&#x7528;&#x3002; &#x8FD9;&#x5E94;&#x8BE5;&#x4EC5;&#x7528;&#x4E8E;&#x5F00;&#x53D1;</td>
</tr>
<tr>
<td style="text-align:left">html-webpack-plugin</td>
<td style="text-align:left">Plugin that simplifies creation of HTML files to serve your bundles</td>
<td style="text-align:left">&#x7B80;&#x5316; HTML &#x6587;&#x4EF6;&#x7684;&#x521B;&#x5EFA;&#x63D2;&#x4EF6;</td>
</tr>
<tr>
<td style="text-align:left">ts-import-plugin</td>
<td style="text-align:left">Modular import plugin for TypeScript, compatible with antd, antd-mobile and so on</td>
<td style="text-align:left">&#x7528;&#x4E8E; TypeScript &#x7684;&#x6A21;&#x5757;&#x5316;&#x5BFC;&#x5165;&#x63D2;&#x4EF6;&#xFF0C;&#x4E0E; antd&#xFF0C;antd-mobile &#x7B49;&#x517C;&#x5BB9;</td>
</tr>
<tr>
<td style="text-align:left">typescript</td>
<td style="text-align:left">TypeScript is a language for application-scale JavaScript</td>
<td style="text-align:left">TypeScript &#x662F;&#x7528;&#x4E8E;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7EA7; JavaScript &#x7684;&#x8BED;&#x8A00;</td>
</tr>
<tr>
<td style="text-align:left">ts-loader</td>
<td style="text-align:left">TypeScript loader for webpack</td>
<td style="text-align:left">&#x7528;&#x4E8E; Webpack &#x7684; TypeScript &#x52A0;&#x8F7D;&#x5668;</td>
</tr>
<tr>
<td style="text-align:left">source-map-loader</td>
<td style="text-align:left">Extracts source maps from existing source files (from their sourceMappingURL)</td>
<td style="text-align:left">&#x4ECE;&#x73B0;&#x6709;&#x6E90;&#x6587;&#x4EF6;(&#x4ECE;&#x5176; sourceMappingURL)&#x4E2D;&#x63D0;&#x53D6;&#x6E90;&#x6620;&#x5C04;</td>
</tr>
<tr>
<td style="text-align:left">style-loader</td>
<td style="text-align:left">Inject CSS into the DOM</td>
<td style="text-align:left">&#x5C06; CSS &#x6CE8;&#x5165; DOM</td>
</tr>
<tr>
<td style="text-align:left">css-loader</td>
<td style="text-align:left">The css-loader interprets @import and url() like import/require() and will resolve them</td>
<td style="text-align:left">css-loader &#x4F1A;&#x50CF; importt()/require()&#x4E00;&#x6837;&#x89E3;&#x91CA;@import &#x548C; url &#x5E76;&#x5C06;&#x89E3;&#x6790;&#x5B83;&#x4EEC;</td>
<td>&#x628A; less &#x7F16;&#x8BD1;&#x6210; CSS</td>
</tr>
<tr>
<td style="text-align:left">less-loader</td>
<td style="text-align:left">A Less loader for webpack. Compiles Less to CSS</td>
<td style="text-align:left">&#x628A; less &#x7F16;&#x8BD1;&#x6210; CSS</td>
</tr>
<tr>
<td style="text-align:left">less</td>
<td style="text-align:left">This is the JavaScript, official, stable version of Less</td>
<td style="text-align:left">&#x8FD9;&#x662F; Less &#x7684; JavaScript &#x5B98;&#x65B9;&#x7A33;&#x5B9A;&#x7248;&#x672C;</td>
</tr>
<tr>
<td style="text-align:left">url-loader</td>
<td style="text-align:left">A loader for webpack which transforms files into base64 URIs</td>
<td style="text-align:left">Webpack &#x7684;&#x52A0;&#x8F7D;&#x7A0B;&#x5E8F;&#xFF0C;&#x53EF;&#x5C06;&#x6587;&#x4EF6;&#x8F6C;&#x6362;&#x4E3A; base64 URI</td>
</tr>
<tr>
<td style="text-align:left">file-loader</td>
<td style="text-align:left">The file-loader resolves import/require() on a file into a url and emits the file into the output directory</td>
<td style="text-align:left">&#x5C06;&#x6587;&#x4EF6;&#x4E0A;&#x7684; import()/require()&#x89E3;&#x6790;&#x4E3A; url &#x5E76;&#x5C06;&#x6587;&#x4EF6;&#x5199;&#x5165;&#x5230;&#x8F93;&#x51FA;&#x76EE;&#x5F55;&#x4E2D;</td>
</tr>
<tr>
<td style="text-align:left">autoprefixer</td>
<td style="text-align:left">PostCSS plugin to parse CSS and add vendor prefixes to CSS rules using values from Can I Use. It is recommended by Google and used in Twitter and Alibaba</td>
<td style="text-align:left">&#x6839;&#x636E;<code>can i use</code>&#x7F51;&#x7AD9;&#x7684; CSS &#x89C4;&#x5219;&#x7ED9; CSS &#x89C4;&#x5219;&#x6DFB;&#x52A0;&#x5382;&#x5546;&#x524D;&#x7F00;</td>
</tr>
<tr>
<td style="text-align:left">px2rem-loader</td>
<td style="text-align:left">a webpack loader for px2rem</td>
<td style="text-align:left">px2rem &#x7684; Webpack &#x52A0;&#x8F7D;&#x5668;</td>
</tr>
<tr>
<td style="text-align:left">postcss-loader</td>
<td style="text-align:left">Loader for webpack to process CSS with PostCSS</td>
<td style="text-align:left">&#x7528;&#x4E8E; webpack &#x7684; Loader &#x4EE5;&#x4F7F;&#x7528; PostCSS &#x5904;&#x7406; CSS</td>
</tr>
<tr>
<td style="text-align:left">lib-flexible</td>
<td style="text-align:left">&#x53EF;&#x4F38;&#x7F29;&#x5E03;&#x5C40;&#x89E3;&#x51B3;&#x65B9;&#x6848;</td>
</tr>
<tr>
<td style="text-align:left">redux</td>
<td style="text-align:left">Redux is a predictable state container for JavaScript apps</td>
<td style="text-align:left">Redux &#x662F; JavaScript &#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7684;&#x53EF;&#x9884;&#x6D4B;&#x72B6;&#x6001;&#x5BB9;&#x5668;</td>
</tr>
<tr>
<td style="text-align:left">react-redux</td>
<td style="text-align:left">Official React bindings for Redux</td>
<td style="text-align:left">Redux &#x7684;&#x5B98;&#x65B9; React &#x7ED1;&#x5B9A;</td>
</tr>
<tr>
<td style="text-align:left">@types/react-redux</td>
<td style="text-align:left">his package contains type definitions for react-redux</td>
<td style="text-align:left">&#x8BE5;&#x8F6F;&#x4EF6;&#x5305;&#x5305;&#x542B; react-redux &#x7684;&#x7C7B;&#x578B;&#x5B9A;&#x4E49;</td>
</tr>
<tr>
<td style="text-align:left">redux-thunk</td>
<td style="text-align:left">Thunk middleware for Redux</td>
<td style="text-align:left">&#x7528;&#x4E8E; Redux &#x7684; Thunk &#x4E2D;&#x95F4;&#x4EF6;</td>
</tr>
<tr>
<td style="text-align:left">redux-logger</td>
<td style="text-align:left">Logger for Redux</td>
<td style="text-align:left">&#x7528;&#x4E8E; Redux &#x7684; logger &#x4E2D;&#x95F4;&#x4EF6;</td>
</tr>
<tr>
<td style="text-align:left">@types/redux-logger</td>
<td style="text-align:left">This package contains type definitions for redux-logger</td>
<td style="text-align:left">&#x8BE5;&#x8F6F;&#x4EF6;&#x5305;&#x5305;&#x542B; redux-logger &#x7684;&#x7C7B;&#x578B;&#x5B9A;&#x4E49;</td>
</tr>
<tr>
<td style="text-align:left">redux-promise</td>
<td style="text-align:left">FSA-compliant promise middleware for Redux.</td>
<td style="text-align:left">&#x7B26;&#x5408; FSA &#x7684; Redux &#x7684; promise &#x4E2D;&#x95F4;&#x4EF6;</td>
</tr>
<tr>
<td style="text-align:left">@types/redux-promise</td>
<td style="text-align:left">This package contains type definitions for redux-promise</td>
<td style="text-align:left">&#x8BE5;&#x8F6F;&#x4EF6;&#x5305;&#x5305;&#x542B; redux-promise &#x7684;&#x7C7B;&#x578B;&#x5B9A;&#x4E49;</td>
</tr>
<tr>
<td style="text-align:left">immer</td>
<td style="text-align:left">Create the next immutable state tree by simply modifying the current tree</td>
<td style="text-align:left">&#x901A;&#x8FC7;&#x7B80;&#x5355;&#x5730;&#x4FEE;&#x6539;&#x5F53;&#x524D;&#x6811;&#x6765;&#x521B;&#x5EFA;&#x4E0B;&#x4E00;&#x4E2A;&#x4E0D;&#x53EF;&#x53D8;&#x72B6;&#x6001;&#x6811;</td>
</tr>
<tr>
<td style="text-align:left">redux-immer</td>
<td style="text-align:left">redux-immer is used to create an equivalent function of Redux combineReducers that works with immer state.</td>
<td style="text-align:left">redux-immer &#x7528;&#x4E8E;&#x521B;&#x5EFA;<code>Redux combineReducers</code>&#x7684;&#x7B49;&#x6548;&#x529F;&#x80FD;&#xFF0C;&#x8BE5;&#x529F;&#x80FD;&#x53EF;&#x4E0E;<code>immer</code>&#x72B6;&#x6001;&#x4E00;&#x8D77;&#x4F7F;&#x7528;</td>
</tr>
<tr>
<td style="text-align:left">connected-react-router</td>
<td style="text-align:left">A Redux binding for React Router v4 and v5</td>
<td style="text-align:left">&#x7528;&#x4E8E; React Router v4 &#x548C; v5 &#x7684; Redux &#x7ED1;&#x5B9A;</td>
</tr>
</tbody>
</table>
<h3 id="t41.4 &#x652F;&#x6301; typescript">1.4 &#x652F;&#x6301; typescript <a href="#t41.4 &#x652F;&#x6301; typescript"> # </a></h3>
<ul>
<li>&#x9700;&#x8981;&#x751F;&#x6210;&#x4E00;&#x4E2A;tsconfig.json&#x6587;&#x4EF6;&#x6765;&#x544A;&#x8BC9;ts-loader&#x5982;&#x4F55;&#x7F16;&#x8BD1;&#x4EE3;&#x7801;TypeScript&#x4EE3;&#x7801;</li>
</ul>
<pre><code class="lang-js">tsc --init
</code></pre>
<pre><code class="lang-json">{
  <span class="hljs-attr">&quot;compilerOptions&quot;</span>: {
    <span class="hljs-attr">&quot;moduleResolution&quot;</span>:<span class="hljs-string">&quot;Node&quot;</span>,
    <span class="hljs-attr">&quot;outDir&quot;</span>: <span class="hljs-string">&quot;./dist&quot;</span>,
    <span class="hljs-attr">&quot;sourceMap&quot;</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">&quot;noImplicitAny&quot;</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">&quot;module&quot;</span>: <span class="hljs-string">&quot;ESNext&quot;</span>,
    <span class="hljs-attr">&quot;target&quot;</span>: <span class="hljs-string">&quot;es5&quot;</span>,
    <span class="hljs-attr">&quot;jsx&quot;</span>: <span class="hljs-string">&quot;react&quot;</span>,
    <span class="hljs-attr">&quot;esModuleInterop&quot;</span>:<span class="hljs-literal">true</span>
  },
  <span class="hljs-attr">&quot;include&quot;</span>: [
    <span class="hljs-string">&quot;./src/**/*&quot;</span>
  ]
}
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left">&#x9879;&#x76EE;</th>
<th style="text-align:left">&#x542B;&#x4E49;</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">outDir</td>
<td style="text-align:left">&#x6307;&#x5B9A;&#x8F93;&#x51FA;&#x76EE;&#x5F55;</td>
</tr>
<tr>
<td style="text-align:left">sourceMap</td>
<td style="text-align:left">&#x628A; ts &#x6587;&#x4EF6;&#x7F16;&#x8BD1;&#x6210; js &#x6587;&#x4EF6;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x540C;&#x65F6;&#x751F;&#x6210;&#x5BF9;&#x5E94;&#x7684; sourceMap &#x6587;&#x4EF6;</td>
</tr>
<tr>
<td style="text-align:left">noImplicitAny</td>
<td style="text-align:left">&#x5982;&#x679C;&#x4E3A; true &#x7684;&#x8BDD;&#xFF0C;TypeScript &#x7F16;&#x8BD1;&#x5668;&#x65E0;&#x6CD5;&#x63A8;&#x65AD;&#x51FA;&#x7C7B;&#x578B;&#x65F6;&#xFF0C;&#x5B83;&#x4ECD;&#x7136;&#x4F1A;&#x751F;&#x6210; JavaScript &#x6587;&#x4EF6;&#xFF0C;&#x4F46;&#x662F;&#x5B83;&#x4E5F;&#x4F1A;&#x62A5;&#x544A;&#x4E00;&#x4E2A;&#x9519;&#x8BEF;</td>
</tr>
<tr>
<td style="text-align:left">module&#xFF1A;&#x4EE3;&#x7801;&#x89C4;&#x8303;</td>
<td style="text-align:left">target&#xFF1A;&#x8F6C;&#x6362;&#x6210; es5</td>
</tr>
<tr>
<td style="text-align:left">jsx</td>
<td style="text-align:left">react &#x6A21;&#x5F0F;&#x4F1A;&#x751F;&#x6210; React.createElement&#xFF0C;&#x5728;&#x4F7F;&#x7528;&#x524D;&#x4E0D;&#x9700;&#x8981;&#x518D;&#x8FDB;&#x884C;&#x8F6C;&#x6362;&#x64CD;&#x4F5C;&#x4E86;&#xFF0C;&#x8F93;&#x51FA;&#x6587;&#x4EF6;&#x7684;&#x6269;&#x5C55;&#x540D;&#x4E3A;.js</td>
</tr>
<tr>
<td style="text-align:left">include</td>
<td style="text-align:left">&#x9700;&#x8981;&#x7F16;&#x8BD1;&#x7684;&#x76EE;&#x5F55;</td>
</tr>
<tr>
<td style="text-align:left">allowSyntheticDefaultImports</td>
<td style="text-align:left">&#x5141;&#x8BB8;&#x4ECE;&#x6CA1;&#x6709;&#x8BBE;&#x7F6E;&#x9ED8;&#x8BA4;&#x5BFC;&#x51FA;&#x7684;&#x6A21;&#x5757;&#x4E2D;&#x9ED8;&#x8BA4;&#x5BFC;&#x5165;&#x3002;&#x8FD9;&#x5E76;&#x4E0D;&#x5F71;&#x54CD;&#x4EE3;&#x7801;&#x7684;&#x8F93;&#x51FA;&#xFF0C;&#x4EC5;&#x4E3A;&#x4E86;&#x7C7B;&#x578B;&#x68C0;&#x67E5;&#x3002;</td>
</tr>
<tr>
<td style="text-align:left">esModuleInterop</td>
<td style="text-align:left">&#x8BBE;&#x7F6E; esModuleInterop: true &#x4F7F; typescript &#x6765;&#x517C;&#x5BB9;&#x6240;&#x6709;&#x6A21;&#x5757;&#x65B9;&#x6848;&#x7684;&#x5BFC;&#x5165;</td>
</tr>
</tbody>
</table>
<blockquote>
<p>&#x5728; TypeScript &#x4E2D;&#xFF0C;&#x6709;&#x591A;&#x79CD; import &#x7684;&#x65B9;&#x5F0F;&#xFF0C;&#x5206;&#x522B;&#x5BF9;&#x5E94;&#x4E86; JavaScript &#x4E2D;&#x4E0D;&#x540C;&#x7684; export</p>
</blockquote>
<pre><code class="lang-js"><span class="hljs-comment">// commonjs &#x6A21;&#x5757;</span>
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> xx <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;xx&quot;</span>;
<span class="hljs-comment">// &#x6807;&#x51C6; es6 &#x6A21;&#x5757;</span>
<span class="hljs-keyword">import</span> xx <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;xx&quot;</span>;
</code></pre>
<h3 id="t51.5 &#x7F16;&#x5199; webpack &#x914D;&#x7F6E;&#x6587;&#x4EF6;">1.5 &#x7F16;&#x5199; webpack &#x914D;&#x7F6E;&#x6587;&#x4EF6; <a href="#t51.5 &#x7F16;&#x5199; webpack &#x914D;&#x7F6E;&#x6587;&#x4EF6;"> # </a></h3>
<p>webpack.config.js</p>
<pre><code class="lang-js"><span class="hljs-keyword">const</span> webpack = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;webpack&quot;</span>);
<span class="hljs-keyword">const</span> HtmlWebpackPlugin = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;html-webpack-plugin&quot;</span>);
<span class="hljs-keyword">const</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">&quot;path&quot;</span>);
<span class="hljs-comment">//process.env.NODE_ENV == &apos;production&apos; ? &apos;production&apos; : &apos;development&apos;;</span>
<span class="hljs-built_in">module</span>.exports = {
  <span class="hljs-attr">mode</span>: process.env.NODE_ENV == <span class="hljs-string">&quot;production&quot;</span> ? <span class="hljs-string">&quot;production&quot;</span> : <span class="hljs-string">&quot;development&quot;</span>, <span class="hljs-comment">//&#x9ED8;&#x8BA4;&#x662F;&#x5F00;&#x53D1;&#x6A21;&#x5757;</span>
  <span class="hljs-attr">entry</span>: <span class="hljs-string">&quot;./src/index.tsx&quot;</span>,
  <span class="hljs-attr">output</span>: {
    <span class="hljs-attr">path</span>: path.join(__dirname, <span class="hljs-string">&quot;dist&quot;</span>),
    <span class="hljs-attr">filename</span>: <span class="hljs-string">&quot;main.js&quot;</span>,
  },
  <span class="hljs-attr">devtool</span>: <span class="hljs-string">&quot;source-map&quot;</span>,
  <span class="hljs-attr">devServer</span>: {
    <span class="hljs-attr">hot</span>: <span class="hljs-literal">true</span>, <span class="hljs-comment">//&#x70ED;&#x66F4;&#x65B0;&#x63D2;&#x4EF6;</span>
    <span class="hljs-attr">contentBase</span>: path.join(__dirname, <span class="hljs-string">&quot;dist&quot;</span>),
    <span class="hljs-attr">historyApiFallback</span>: {
      <span class="hljs-comment">//browserHistory&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5237;&#x65B0;&#x4F1A;&#x62A5;404. &#x81EA;&#x52A8;&#x91CD;&#x5B9A;&#x5411;&#x5230;index.html</span>
      <span class="hljs-attr">index</span>: <span class="hljs-string">&quot;./index.html&quot;</span>,
    },
  },
  <span class="hljs-attr">resolve</span>: {
    <span class="hljs-attr">alias</span>: {
      <span class="hljs-string">&quot;@&quot;</span>: path.resolve(__dirname, <span class="hljs-string">&quot;src&quot;</span>),
      <span class="hljs-string">&quot;~&quot;</span>: path.resolve(__dirname, <span class="hljs-string">&quot;node_modules&quot;</span>),
    },
    <span class="hljs-comment">//&#x5F53;&#x4F60;&#x52A0;&#x8F7D;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x7684;&#x65F6;&#x5019;,&#x6CA1;&#x6709;&#x6307;&#x5B9A;&#x6269;&#x5C55;&#x540D;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4F1A;&#x81EA;&#x52A8;&#x5BFB;&#x627E;&#x54EA;&#x4E9B;&#x6269;&#x5C55;&#x540D;</span>
    <span class="hljs-attr">extensions</span>: [<span class="hljs-string">&quot;.ts&quot;</span>, <span class="hljs-string">&quot;.tsx&quot;</span>, <span class="hljs-string">&quot;.js&quot;</span>, <span class="hljs-string">&quot;.json&quot;</span>],
  },
  <span class="hljs-attr">module</span>: {
    <span class="hljs-attr">rules</span>: [
      {
        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(j|t)sx?$/</span>,
        <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;babel-loader&quot;</span>,
        <span class="hljs-attr">options</span>: {
          <span class="hljs-attr">presets</span>:[
            <span class="hljs-string">&apos;@babel/preset-env&apos;</span>,
            <span class="hljs-string">&apos;@babel/preset-react&apos;</span>,
            <span class="hljs-string">&apos;@babel/preset-typescript&apos;</span>
          ],
          <span class="hljs-attr">plugins</span>: [<span class="hljs-comment">//&#x9ED8;&#x8BA4;&#x5F15;less,&#x6211;&#x4EEC;&#x5F15;css</span>
            [<span class="hljs-string">&apos;import&apos;</span>, { <span class="hljs-attr">libraryName</span>: <span class="hljs-string">&apos;antd&apos;</span>, <span class="hljs-attr">style</span>: <span class="hljs-string">&apos;css&apos;</span> }]
          ]
        },
        <span class="hljs-attr">include</span>:path.resolve(<span class="hljs-string">&apos;src&apos;</span>),
        <span class="hljs-attr">exclude</span>:<span class="hljs-regexp">/node_modules/</span>
      },
      {<span class="hljs-comment">//&#x5F15;&#x5165;antdesign&#x4E2D;&#x7528;&#x7684;css</span>
        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.css$/</span>,
        <span class="hljs-attr">use</span>: [
          <span class="hljs-string">&quot;style-loader&quot;</span>,
          {
            <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;css-loader&quot;</span>,
            <span class="hljs-attr">options</span>: { <span class="hljs-attr">importLoaders</span>: <span class="hljs-number">0</span> },
          }
        ]
      },
      {<span class="hljs-comment">//&#x6211;&#x4EEC;&#x81EA;&#x5DF1;&#x7684;&#x4EE3;&#x7801;&#x90FD;&#x662F;less</span>
        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.less$/</span>,
        <span class="hljs-attr">use</span>: [
          <span class="hljs-string">&quot;style-loader&quot;</span>,
          {
            <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;css-loader&quot;</span>,
            <span class="hljs-attr">options</span>: { <span class="hljs-attr">importLoaders</span>: <span class="hljs-number">3</span> },
          },
          {
            <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;postcss-loader&quot;</span>,
            <span class="hljs-attr">options</span>: {
              <span class="hljs-attr">postcssOptions</span>: {
                <span class="hljs-attr">plugins</span>: [
                  <span class="hljs-string">&quot;autoprefixer&quot;</span>
                ],
              }
            },
          },
          {
            <span class="hljs-attr">loader</span>: <span class="hljs-string">&quot;px2rem-loader&quot;</span>,
            <span class="hljs-attr">options</span>: {
              <span class="hljs-attr">remUnit</span>: <span class="hljs-number">75</span>,
              <span class="hljs-attr">remPrecesion</span>: <span class="hljs-number">8</span>,
            },
          },
          <span class="hljs-string">&quot;less-loader&quot;</span>,
        ],
      },
      {
        <span class="hljs-attr">test</span>: <span class="hljs-regexp">/\.(jpg|png|gif|svg|jpeg)$/</span>,
        <span class="hljs-attr">type</span>:<span class="hljs-string">&apos;asset&apos;</span>
      },
    ],
  },
  <span class="hljs-attr">plugins</span>: [
    <span class="hljs-keyword">new</span> HtmlWebpackPlugin({
      <span class="hljs-attr">template</span>: <span class="hljs-string">&quot;./public/index.html&quot;</span>,
    }),
    <span class="hljs-keyword">new</span> webpack.HotModuleReplacementPlugin(),
  ],
};
</code></pre>
<h3 id="t61.6 src\index.tsx">1.6 src\index.tsx <a href="#t61.6 src\index.tsx"> # </a></h3>
<p>src\index.tsx</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;
<span class="hljs-keyword">import</span> ReactDOM <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-dom&quot;</span>;
ReactDOM.render(<span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>hello<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span></span>,<span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&quot;root&quot;</span>));
</code></pre>
<h3 id="t71.7 public\index.html">1.7 public\index.html <a href="#t71.7 public\index.html"> # </a></h3>
<p>public\index.html</p>
<pre><code class="lang-html"><span class="hljs-meta">&lt;!DOCTYPE <span class="hljs-meta-keyword">html</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">html</span> <span class="hljs-attr">lang</span>=<span class="hljs-string">&quot;en&quot;</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">charset</span>=<span class="hljs-string">&quot;UTF-8&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">meta</span> <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;viewport&quot;</span> <span class="hljs-attr">content</span>=<span class="hljs-string">&quot;width=device-width, initial-scale=1.0&quot;</span> /&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>&#x73E0;&#x5CF0;&#x8BFE;&#x5802;<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-name">body</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">
      <span class="hljs-keyword">let</span> docEle = <span class="hljs-built_in">document</span>.documentElement;
      <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">setRemUnit</span>(<span class="hljs-params"></span>) </span>{
        docEle.style.fontSize = docEle.clientWidth / <span class="hljs-number">10</span> + <span class="hljs-string">&quot;px&quot;</span>;
      }
      setRemUnit();
      <span class="hljs-built_in">window</span>.addEventListener(<span class="hljs-string">&quot;resize&quot;</span>, setRemUnit);
    </span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">id</span>=<span class="hljs-string">&quot;root&quot;</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">body</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</code></pre>
<h3 id="t81.8 package.json">1.8 package.json <a href="#t81.8 package.json"> # </a></h3>
<pre><code class="lang-json">  &quot;scripts&quot;: {
    &quot;build&quot;: &quot;webpack&quot;,
    &quot;dev&quot;: &quot;webpack serve&quot;,
    &quot;lint&quot;: &quot;eslint --ext .tsx src --fix&quot;,
  }
</code></pre>
<h2 id="t9&#x7B2C;2&#x5929; &#x5B9E;&#x73B0;&#x5E95;&#x90E8;&#x8DEF;&#x7531;">&#x7B2C;2&#x5929; &#x5B9E;&#x73B0;&#x5E95;&#x90E8;&#x8DEF;&#x7531; <a href="#t9&#x7B2C;2&#x5929; &#x5B9E;&#x73B0;&#x5E95;&#x90E8;&#x8DEF;&#x7531;"> # </a></h2>
<ul>
<li>&#x8FD9;&#x4E00;&#x7AE0;&#x6211;&#x4EEC;&#x5F00;&#x59CB;&#x914D;&#x7F6E;&#x8DEF;&#x7531;,&#x6211;&#x4EEC;&#x7684;&#x5E94;&#x7528;&#x5728;&#x5C3E;&#x90E8;&#x6709;&#x4E09;&#x4E2A;&#x9875;&#x7B7E;,&#x5206;&#x522B;&#x5BF9;&#x5E94;&#x9996;&#x9875;,&#x8D2D;&#x7269;&#x8F66;&#x548C;&#x4E2A;&#x4EBA;&#x4E2D;&#x5FC3;&#x4E09;&#x4E2A;&#x9875;&#x9762;</li>
<li>&#x5728;&#x672C;&#x7AE0;&#x8282;&#x6211;&#x4EEC;&#x5B9E;&#x8DF5;&#x4EE5;&#x4E0B;&#x5185;&#x5BB9;<ul>
<li><ol>
<li>&#x5982;&#x4F55;&#x4F7F;&#x7528; react &#x5168;&#x5BB6;&#x6876;&#x914D;&#x7F6E;&#x8DEF;&#x7531;</li>
</ol>
</li>
<li><ol start="2">
<li>&#x5982;&#x4F55;&#x6309;&#x9700;&#x52A0;&#x8F7D;<code>antd</code>&#x5E76;&#x4F7F;&#x7528;&#x56FE;&#x6807;&#x7EC4;&#x4EF6;</li>
</ol>
</li>
<li><ol start="3">
<li>&#x5982;&#x4F55;&#x5728; react &#x6837;&#x5F0F;&#x4E2D;&#x4F7F;&#x7528;<code>less</code>&#x7F16;&#x5199;&#x6837;&#x5F0F;</li>
</ol>
</li>
<li><ol start="4">
<li>&#x5982;&#x4F55;&#x5728;&#x79FB;&#x52A8;&#x7AEF;&#x4E2D;&#x4F7F;&#x7528; <code>rem</code> &#x5B9E;&#x73B0;&#x5E03;&#x5C40;&#x4EE5;&#x53CA;&#x5982;&#x4F55;&#x4F7F;&#x7528; <code>flex</code>&#x5E03;&#x5C40;</li>
</ol>
</li>
<li><ol start="5">
<li>&#x5982;&#x4F55;&#x4F7F;&#x7528; typescript &#x7F16;&#x5199; react &#x4EE3;&#x7801;</li>
</ol>
</li>
</ul>
</li>
</ul>
<p>&#x672C;&#x7AE0;&#x76EE;&#x5F55;</p>
<pre><code class="lang-js">&#x251C;&#x2500;&#x2500; package.json
&#x251C;&#x2500;&#x2500; public
&#x2502;   &#x2514;&#x2500;&#x2500; index.html
&#x251C;&#x2500;&#x2500; src
&#x2502;   &#x251C;&#x2500;&#x2500; assets
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; css
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; common.less
&#x2502;   &#x251C;&#x2500;&#x2500; components
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; Tabs
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; routes
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Home
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Mine
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; Profile
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2514;&#x2500;&#x2500; store
&#x2502;       &#x251C;&#x2500;&#x2500; action-types.tsx
&#x2502;       &#x251C;&#x2500;&#x2500; history.tsx
&#x2502;       &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;       &#x2514;&#x2500;&#x2500; reducers
&#x2502;           &#x251C;&#x2500;&#x2500; home.tsx
&#x2502;           &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;           &#x251C;&#x2500;&#x2500; mine.tsx
&#x2502;           &#x2514;&#x2500;&#x2500; profile.tsx
&#x251C;&#x2500;&#x2500; tsconfig.json
&#x251C;&#x2500;&#x2500; webpack.config.js
</code></pre>
<p>&#x672C;&#x7AE0;&#x6548;&#x679C;&#x9884;&#x89C8;</p>
<p><img src="http://img.zhufengpeixun.cn/zhufengketang_day1.gif" alt="day1"></p>
<p>&#x9875;&#x9762;&#x5E03;&#x5C40;
<img src="https://img.zhufengpeixun.com/tabs.png" alt="tabs"></p>
<h3 id="t102.1 src\index.tsx">2.1 src\index.tsx <a href="#t102.1 src\index.tsx"> # </a></h3>
<p>src\index.tsx</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;
<span class="hljs-keyword">import</span> ReactDOM <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-dom&quot;</span>;
<span class="hljs-keyword">import</span> { Switch, Route, Redirect } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-router-dom&quot;</span>;
<span class="hljs-keyword">import</span> { Provider } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-redux&quot;</span>;
<span class="hljs-keyword">import</span> store <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./store&quot;</span>;
<span class="hljs-keyword">import</span> { ConfigProvider } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;antd&quot;</span>;
<span class="hljs-keyword">import</span> zh_CN <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;antd/lib/locale-provider/zh_CN&quot;</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./assets/css/common.less&quot;</span>;
<span class="hljs-keyword">import</span> Tabs <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./components/Tabs&quot;</span>;
<span class="hljs-keyword">import</span> Home <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./routes/Home&quot;</span>;
<span class="hljs-keyword">import</span> Mine <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./routes/Mine&quot;</span>;
<span class="hljs-keyword">import</span> Profile <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./routes/Profile&quot;</span>;
<span class="hljs-keyword">import</span> { ConnectedRouter } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;connected-react-router&quot;</span>;
<span class="hljs-keyword">import</span> history <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./store/history&quot;</span>;
ReactDOM.render(
  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Provider</span> <span class="hljs-attr">store</span>=<span class="hljs-string">{store}</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-name">ConnectedRouter</span> <span class="hljs-attr">history</span>=<span class="hljs-string">{history}</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">ConfigProvider</span> <span class="hljs-attr">locale</span>=<span class="hljs-string">{zh_CN}</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">main</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;main-container&quot;</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Switch</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">&quot;/&quot;</span> <span class="hljs-attr">exact</span> <span class="hljs-attr">component</span>=<span class="hljs-string">{Home}</span> /&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">&quot;/Mine&quot;</span> <span class="hljs-attr">component</span>=<span class="hljs-string">{Mine}</span> /&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Route</span> <span class="hljs-attr">path</span>=<span class="hljs-string">&quot;/profile&quot;</span> <span class="hljs-attr">component</span>=<span class="hljs-string">{Profile}</span> /&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Redirect</span> <span class="hljs-attr">to</span>=<span class="hljs-string">&quot;/&quot;</span> /&gt;</span>
          <span class="hljs-tag">&lt;/<span class="hljs-name">Switch</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">main</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Tabs</span> /&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">ConfigProvider</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">ConnectedRouter</span>&gt;</span>
  <span class="hljs-tag">&lt;/<span class="hljs-name">Provider</span>&gt;</span></span>,
  <span class="hljs-built_in">document</span>.getElementById(<span class="hljs-string">&quot;root&quot;</span>)
);
</code></pre>
<h3 id="t112.2 common.less">2.2 common.less <a href="#t112.2 common.less"> # </a></h3>
<p>src\assets\css\common.less</p>
<pre><code class="lang-less">*{
    <span class="hljs-attribute">padding</span>: <span class="hljs-number">0</span>;
    <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span>;
}
<span class="hljs-selector-tag">ul</span>,<span class="hljs-selector-tag">li</span>{
    <span class="hljs-attribute">list-style</span>: none;
}
<span class="hljs-selector-id">#root</span>{
    <span class="hljs-attribute">margin</span>:<span class="hljs-number">0</span> auto;
    <span class="hljs-attribute">max-width</span>: <span class="hljs-number">750px</span>;
    <span class="hljs-attribute">box-sizing</span>: border-box;
}
<span class="hljs-selector-class">.main-container</span>{
    <span class="hljs-attribute">padding</span>:<span class="hljs-number">100px</span> <span class="hljs-number">0</span> <span class="hljs-number">120px</span> <span class="hljs-number">0</span>;
}
</code></pre>
<h3 id="t122.3 Tabs\index.tsx">2.3 Tabs\index.tsx <a href="#t122.3 Tabs\index.tsx"> # </a></h3>
<p>src\components\Tabs\index.tsx</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;
<span class="hljs-keyword">import</span> { withRouter, NavLink } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-router-dom&quot;</span>;
<span class="hljs-keyword">import</span> {HomeOutlined,ShoppingCartOutlined,UserOutlined} <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@ant-design/icons&quot;</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./index.less&quot;</span>;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Tabs</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">footer</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">NavLink</span> <span class="hljs-attr">exact</span> <span class="hljs-attr">to</span>=<span class="hljs-string">&quot;/&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">HomeOutlined</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>&#x9996;&#x9875;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">NavLink</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">NavLink</span> <span class="hljs-attr">to</span>=<span class="hljs-string">&quot;/cart&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">ShoppingCartOutlined</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>&#x8D2D;&#x7269;&#x8F66;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">NavLink</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">NavLink</span> <span class="hljs-attr">to</span>=<span class="hljs-string">&quot;/profile&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">UserOutlined</span> /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">span</span>&gt;</span>&#x4E2A;&#x4EBA;&#x4E2D;&#x5FC3;<span class="hljs-tag">&lt;/<span class="hljs-name">span</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">NavLink</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">footer</span>&gt;</span></span>
  );
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> withRouter(Tabs);
</code></pre>
<h3 id="t132.4 Tabs\index.less">2.4 Tabs\index.less <a href="#t132.4 Tabs\index.less"> # </a></h3>
<p>src\components\Tabs\index.less</p>
<pre><code class="lang-less"><span class="hljs-selector-tag">footer</span> {
  <span class="hljs-attribute">position</span>: fixed;
  <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">bottom</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">120px</span>;
  <span class="hljs-attribute">z-index</span>: <span class="hljs-number">1000</span>;
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#fff</span>;
  <span class="hljs-attribute">border-top</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#d5d5d5</span>;
  <span class="hljs-attribute">display</span>: flex;
  <span class="hljs-attribute">justify-content</span>: center;
  <span class="hljs-attribute">align-items</span>: center;
  <span class="hljs-selector-tag">a</span> {
    <span class="hljs-attribute">display</span>: flex;
    <span class="hljs-attribute">flex</span>: <span class="hljs-number">1</span>;
    <span class="hljs-attribute">flex-direction</span>: column;
    <span class="hljs-attribute">justify-content</span>: center;
    <span class="hljs-attribute">align-items</span>: center;
    <span class="hljs-attribute">color</span>: <span class="hljs-number">#000</span>;
    <span class="hljs-selector-tag">span</span> {
      <span class="hljs-attribute">font-size</span>: <span class="hljs-number">30px</span>;
      <span class="hljs-attribute">line-height</span>: <span class="hljs-number">50px</span>;
      <span class="hljs-selector-tag">&amp;</span><span class="hljs-selector-class">.anticon</span> {
        <span class="hljs-attribute">font-size</span>: <span class="hljs-number">50px</span>;
      }
    }
    <span class="hljs-selector-tag">&amp;</span><span class="hljs-selector-class">.active</span> {
      <span class="hljs-attribute">color</span>: blue;
      <span class="hljs-attribute">font-weight</span>: bold;
    }
  }
}
</code></pre>
<h3 id="t142.5 history.tsx">2.5 history.tsx <a href="#t142.5 history.tsx"> # </a></h3>
<p>src\store\history.tsx</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> { createHashHistory } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;history&quot;</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> createHashHistory();
</code></pre>
<h3 id="t152.6 action-types.tsx">2.6 action-types.tsx <a href="#t152.6 action-types.tsx"> # </a></h3>
<p>src\store\action-types.tsx</p>
<pre><code class="lang-js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> ADD = <span class="hljs-string">&quot;ADD&quot;</span>;
</code></pre>
<h3 id="t162.7 reducers\home.tsx">2.7 reducers\home.tsx <a href="#t162.7 reducers\home.tsx"> # </a></h3>
<p>src\store\reducers\home.tsx</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> { AnyAction } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;redux&quot;</span>;
<span class="hljs-keyword">export</span> interface HomeState {}
<span class="hljs-keyword">let</span> initialState: HomeState = {};
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">
  state: HomeState = initialState,
  action: AnyAction
</span>): <span class="hljs-title">HomeState</span> </span>{
  <span class="hljs-keyword">switch</span> (action.type) {
    <span class="hljs-attr">default</span>:
      <span class="hljs-keyword">return</span> state;
  }
}
</code></pre>
<h3 id="t172.8 reducers\mine.tsx">2.8 reducers\mine.tsx <a href="#t172.8 reducers\mine.tsx"> # </a></h3>
<p>src\store\reducers\mine.tsx</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> { AnyAction } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;redux&quot;</span>;
<span class="hljs-keyword">export</span> interface MineState {}
<span class="hljs-keyword">let</span> initialState: MineState = {};
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">
  state: MineState = initialState,
  action: AnyAction
</span>): <span class="hljs-title">MineState</span> </span>{
  <span class="hljs-keyword">switch</span> (action.type) {
    <span class="hljs-attr">default</span>:
      <span class="hljs-keyword">return</span> state;
  }
}
</code></pre>
<h3 id="t182.9 reducers\profile.tsx">2.9 reducers\profile.tsx <a href="#t182.9 reducers\profile.tsx"> # </a></h3>
<p>src\store\reducers\profile.tsx</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> { AnyAction } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;redux&quot;</span>;
<span class="hljs-keyword">export</span> interface ProfileState {}
<span class="hljs-keyword">let</span> initialState: ProfileState = {};
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">
  state: ProfileState = initialState,
  action: AnyAction
</span>): <span class="hljs-title">ProfileState</span> </span>{
  <span class="hljs-keyword">switch</span> (action.type) {
    <span class="hljs-attr">default</span>:
      <span class="hljs-keyword">return</span> state;
  }
}
</code></pre>
<h3 id="t192.10 reducers\index.tsx">2.10 reducers\index.tsx <a href="#t192.10 reducers\index.tsx"> # </a></h3>
<p>src\store\reducers\index.tsx</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> { combineReducers, ReducersMapObject, Reducer } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;redux&apos;</span>;
<span class="hljs-keyword">import</span> { connectRouter } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;connected-react-router&apos;</span>;
<span class="hljs-keyword">import</span> history <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;../history&apos;</span>;
<span class="hljs-keyword">import</span> home <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;./home&apos;</span>;
<span class="hljs-keyword">import</span> mine <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;./mine&apos;</span>;
<span class="hljs-keyword">import</span> profile <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;./profile&apos;</span>;
<span class="hljs-keyword">let</span> reducers: ReducersMapObject = {
    <span class="hljs-attr">router</span>: connectRouter(history),
    home,
    mine,
    profile,
};
type CombinedState = {
    [key <span class="hljs-keyword">in</span> keyof <span class="hljs-keyword">typeof</span> reducers]: ReturnType&lt;<span class="hljs-keyword">typeof</span> reducers[key]&gt;
}
<span class="hljs-keyword">let</span> reducer: Reducer&lt;CombinedState&gt; = combineReducers&lt;CombinedState&gt;(reducers);

<span class="hljs-keyword">export</span> { CombinedState }
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> reducer;
</code></pre>
<h3 id="t202.11 store\index.tsx">2.11 store\index.tsx <a href="#t202.11 store\index.tsx"> # </a></h3>
<p>src\store\index.tsx</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> { createStore, applyMiddleware, Store, AnyAction } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;redux&apos;</span>;
<span class="hljs-keyword">import</span> reducers <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;./reducers&apos;</span>;
<span class="hljs-keyword">import</span> logger <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;redux-logger&apos;</span>;
<span class="hljs-keyword">import</span> thunk <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;redux-thunk&apos;</span>;
<span class="hljs-keyword">import</span> promise <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;redux-promise&apos;</span>;
<span class="hljs-keyword">import</span> { routerMiddleware } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;connected-react-router&apos;</span>;
<span class="hljs-keyword">import</span> history <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;./history&apos;</span>;
<span class="hljs-keyword">let</span> store = applyMiddleware(thunk, routerMiddleware(history), promise, logger)(createStore)(reducers);
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> store;
</code></pre>
<h3 id="t212.12 Home\index.tsx">2.12 Home\index.tsx <a href="#t212.12 Home\index.tsx"> # </a></h3>
<p>src\routes\Home\index.tsx</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> React, { PropsWithChildren } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;
<span class="hljs-keyword">import</span> { connect } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-redux&quot;</span>;
<span class="hljs-keyword">import</span> { RouteComponentProps } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-router-dom&quot;</span>;
interface Params {}
type Props = PropsWithChildren&lt;RouteComponentProps&lt;Params&gt;&gt;;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Home</span>(<span class="hljs-params">props: Props</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Home<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> connect()(Home);
</code></pre>
<h3 id="t222.13 Mine\index.tsx">2.13 Mine\index.tsx <a href="#t222.13 Mine\index.tsx"> # </a></h3>
<p>src\routes\Mine\index.tsx</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> React, { PropsWithChildren } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;
<span class="hljs-keyword">import</span> { connect } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-redux&quot;</span>;
<span class="hljs-keyword">import</span> { RouteComponentProps } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-router-dom&quot;</span>;
interface Params {}
type Props = PropsWithChildren&lt;RouteComponentProps&lt;Params&gt;&gt;;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Mine</span>(<span class="hljs-params">props: Props</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Mine<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> connect()(Mine);
</code></pre>
<h3 id="t232.14 Profile\index.tsx">2.14 Profile\index.tsx <a href="#t232.14 Profile\index.tsx"> # </a></h3>
<p>src\routes\Profile\index.tsx</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> React, { PropsWithChildren } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;
<span class="hljs-keyword">import</span> { connect } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-redux&quot;</span>;
<span class="hljs-keyword">import</span> { RouteComponentProps } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-router-dom&quot;</span>;
interface Params {}
type Props = PropsWithChildren&lt;RouteComponentProps&lt;Params&gt;&gt;;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Profile</span>(<span class="hljs-params">props: Props</span>) </span>{
  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>Profile<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> connect()(Profile);
</code></pre>
<h2 id="t24&#x7B2C;3&#x7AE0; &#x5B9E;&#x73B0;&#x9996;&#x9875;&#x5934;&#x90E8;&#x5BFC;&#x822A;">&#x7B2C;3&#x7AE0; &#x5B9E;&#x73B0;&#x9996;&#x9875;&#x5934;&#x90E8;&#x5BFC;&#x822A; <a href="#t24&#x7B2C;3&#x7AE0; &#x5B9E;&#x73B0;&#x9996;&#x9875;&#x5934;&#x90E8;&#x5BFC;&#x822A;"> # </a></h2>
<ul>
<li>&#x672C;&#x7AE0;&#x6211;&#x4EEC;&#x5C06;&#x8981;&#x5B9E;&#x73B0;&#x9996;&#x9875;&#x7684;&#x5934;&#x90E8;&#x5BFC;&#x822A;</li>
<li>&#x672C;&#x7AE0;&#x6211;&#x4EEC;&#x8981;&#x638C;&#x63E1;&#x7684;&#x77E5;&#x8BC6;&#x70B9;<ul>
<li>&#x914D;&#x7F6E; ts &#x80FD;&#x8BC6;&#x522B;&#x7684;&#x8DEF;&#x5F84;&#x522B;&#x540D;</li>
<li>&#x5982;&#x4F55;&#x5728; ts &#x4E2D;&#x5BFC;&#x5165;&#x56FE;&#x7247;</li>
<li>React &#x52A8;&#x753B;&#x5E93;&#x7684;&#x4F7F;&#x7528;</li>
<li>&#x5982;&#x4F55;&#x521B;&#x5EFA; redux &#x4ED3;&#x5E93;&#x4EE5;&#x53CA;&#x5982;&#x4F55;&#x5173;&#x8054;&#x7EC4;&#x4EF6;</li>
</ul>
</li>
</ul>
<h3 id="t253.1 &#x8D44;&#x6599;">3.1 &#x8D44;&#x6599; <a href="#t253.1 &#x8D44;&#x6599;"> # </a></h3>
<h4 id="t263.1.1 &#x6587;&#x6863;">3.1.1 &#x6587;&#x6863; <a href="#t263.1.1 &#x6587;&#x6863;"> # </a></h4>
<ul>
<li><a href="https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/react/index.d.ts">react&#x7C7B;&#x578B;&#x58F0;&#x660E;</a></li>
</ul>
<h4 id="t273.1.2 logo&#x56FE;">3.1.2 logo&#x56FE; <a href="#t273.1.2 logo&#x56FE;"> # </a></h4>
<p><img src="https://img.zhufengpeixun.com/logo.png" alt="logo"></p>
<h4 id="t283.1.3 &#x672C;&#x7AE0;&#x4EE3;&#x7801;">3.1.3 &#x672C;&#x7AE0;&#x4EE3;&#x7801; <a href="#t283.1.3 &#x672C;&#x7AE0;&#x4EE3;&#x7801;"> # </a></h4>
<pre><code class="lang-js">&#x251C;&#x2500;&#x2500; package.json
&#x251C;&#x2500;&#x2500; public
&#x2502;   &#x2514;&#x2500;&#x2500; index.html
&#x251C;&#x2500;&#x2500; src
&#x2502;   &#x251C;&#x2500;&#x2500; assets
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; css
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; common.less
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; images
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; logo.png
&#x2502;   &#x251C;&#x2500;&#x2500; components
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; Tabs
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; routes
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Home
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; components
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; HomeHeader
&#x2502;   &#x2502;   &#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Mine
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; Profile
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; store
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; actions
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; home.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; action-types.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; history.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; reducers
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; home.tsx
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; mine.tsx
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; profile.tsx
&#x2502;   &#x2514;&#x2500;&#x2500; typings
&#x2502;       &#x2514;&#x2500;&#x2500; images.d.ts
&#x251C;&#x2500;&#x2500; tsconfig.json
&#x251C;&#x2500;&#x2500; webpack.config.js
</code></pre>
<h4 id="t293.1.4 &#x6548;&#x679C;&#x9884;&#x89C8;">3.1.4 &#x6548;&#x679C;&#x9884;&#x89C8; <a href="#t293.1.4 &#x6548;&#x679C;&#x9884;&#x89C8;"> # </a></h4>
<p><img src="http://img.zhufengpeixun.cn/homenavigation.gif" alt="homenavigation"></p>
<h4 id="t303.1.5 &#x672C;&#x7AE0;&#x5E03;&#x5C40;">3.1.5 &#x672C;&#x7AE0;&#x5E03;&#x5C40; <a href="#t303.1.5 &#x672C;&#x7AE0;&#x5E03;&#x5C40;"> # </a></h4>
<p><img src="https://img.zhufengpeixun.com/home-header.png" alt="home-header.png"></p>
<h3 id="t313.2 tsconfig.json">3.2 tsconfig.json <a href="#t313.2 tsconfig.json"> # </a></h3>
<ul>
<li>&#x4F7F;&#x7528; typescript &#x5F00;&#x53D1;&#x9879;&#x76EE;&#x65F6;&#xFF0C;&#x4E3A;&#x4E86;&#x63D0;&#x9AD8;&#x5F00;&#x53D1;&#x4F53;&#x9A8C;&#xFF0C;&#x7ECF;&#x5E38;&#x4F1A;&#x914D;&#x7F6E;<code>paths</code>&#x6620;&#x5C04;&#x6A21;&#x5757;&#x8DEF;&#x5F84;</li>
</ul>
<p>tsconfig.json</p>
<pre><code class="lang-diff">  &quot;compilerOptions&quot;: {
<span class="hljs-addition">+    &quot;baseUrl&quot;: &quot;.&quot;,  // &#x89E3;&#x6790;&#x975E;&#x76F8;&#x5BF9;&#x6A21;&#x5757;&#x7684;&#x57FA;&#x5730;&#x5740;&#xFF0C;&#x9ED8;&#x8BA4;&#x662F;&#x5F53;&#x524D;&#x76EE;&#x5F55;</span>
<span class="hljs-addition">+    &quot;paths&quot;: {       // &#x8DEF;&#x5F84;&#x6620;&#x5C04;&#xFF0C;&#x76F8;&#x5BF9;&#x4E8E;baseUrl</span>
<span class="hljs-addition">+      &quot;@/*&quot;: [&quot;./src/*&quot; ] //&#x628A;@&#x6620;&#x5C04;&#x4E3A;src&#x76EE;&#x5F55;</span>
<span class="hljs-addition">+    }</span>
  },
</code></pre>
<h3 id="t323.3 images.d.ts">3.3 images.d.ts <a href="#t323.3 images.d.ts"> # </a></h3>
<p>src\typings\images.d.ts</p>
<pre><code class="lang-js"><span class="hljs-comment">/**
 * &#x5982;&#x679C;&#x5728;js&#x4E2D;&#x5F15;&#x5165;&#x672C;&#x5730;&#x9759;&#x6001;&#x8D44;&#x6E90;&#x56FE;&#x7247;&#x65F6;&#x4F7F;&#x7528;import img from &apos;./img/logo.png&apos;&#x8FD9;&#x79CD;&#x5199;&#x6CD5;&#x662F;&#x6CA1;&#x6709;&#x95EE;&#x9898;&#x7684;
 * &#x4F46;&#x662F;&#x5728;typescript&#x4E2D;&#x662F;&#x65E0;&#x6CD5;&#x8BC6;&#x522B;&#x975E;&#x4EE3;&#x7801;&#x8D44;&#x6E90;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x4F1A;&#x62A5;&#x9519;TS2307: cannot find module &apos;.png&apos;
 * &#x56E0;&#x6B64;&#xFF0C;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x4E3B;&#x52A8;&#x7684;&#x53BB;&#x58F0;&#x660E;&#x8FD9;&#x4E2A;module
 * &#x65B0;&#x5EFA;&#x4E00;&#x4E2A;ts&#x58F0;&#x660E;&#x6587;&#x4EF6;&#x5982;&#xFF1A;images.d.ts&#x5C31;&#x53EF;&#x4EE5;&#x4E86;,&#x8FD9;&#x6837;ts&#x5C31;&#x53EF;&#x4EE5;&#x8BC6;&#x522B;svg&#x3001;png&#x3001;jpg&#x7B49;&#x7B49;&#x56FE;&#x7247;&#x7C7B;&#x578B;&#x6587;&#x4EF6;
 * &#x9879;&#x76EE;&#x7F16;&#x8BD1;&#x8FC7;&#x7A0B;&#x4E2D;&#x4F1A;&#x81EA;&#x52A8;&#x53BB;&#x8BFB;&#x53D6;.d.ts&#x8FD9;&#x79CD;&#x7C7B;&#x578B;&#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x6240;&#x4EE5;&#x4E0D;&#x9700;&#x8981;&#x6211;&#x4EEC;&#x624B;&#x52A8;&#x5730;&#x52A0;&#x8F7D;&#x4ED6;&#x4EEC;
 * &#x5F53;&#x7136;.d.ts&#x6587;&#x4EF6;&#x4E5F;&#x4E0D;&#x80FD;&#x968F;&#x4FBF;&#x653E;&#x7F6E;&#x5728;&#x9879;&#x76EE;&#x4E2D;&#xFF0C;&#x8FD9;&#x7C7B;&#x6587;&#x4EF6;&#x548C;ts&#x6587;&#x4EF6;&#x4E00;&#x6837;&#x9700;&#x8981;&#x88AB;typescript&#x7F16;&#x8BD1;&#xFF0C;&#x6240;&#x4EE5;&#x4E00;&#x6837;&#x53EA;&#x80FD;&#x653E;&#x7F6E;&#x5728;tsconfig.json&#x4E2D;include&#x5C5E;&#x6027;&#x6240;&#x914D;&#x7F6E;&#x7684;&#x6587;&#x4EF6;&#x5939;&#x4E0B;
 * 
 */</span>
declare <span class="hljs-built_in">module</span> <span class="hljs-string">&apos;*.svg&apos;</span>;
declare <span class="hljs-built_in">module</span> <span class="hljs-string">&apos;*.png&apos;</span>;
declare <span class="hljs-built_in">module</span> <span class="hljs-string">&apos;*.jpg&apos;</span>;
declare <span class="hljs-built_in">module</span> <span class="hljs-string">&apos;*.jpeg&apos;</span>;
declare <span class="hljs-built_in">module</span> <span class="hljs-string">&apos;*.gif&apos;</span>;
declare <span class="hljs-built_in">module</span> <span class="hljs-string">&apos;*.bmp&apos;</span>;
declare <span class="hljs-built_in">module</span> <span class="hljs-string">&apos;*.tiff&apos;</span>;
</code></pre>
<h3 id="t333.4 HomeHeader\index.tsx">3.4 HomeHeader\index.tsx <a href="#t333.4 HomeHeader\index.tsx"> # </a></h3>
<p>src\routes\Home\components\HomeHeader\index.tsx</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> React, { useState, CSSProperties } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;react&apos;</span>;
<span class="hljs-keyword">import</span> {BarsOutlined} <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@ant-design/icons&apos;</span>;
<span class="hljs-keyword">import</span> classnames <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;classnames&apos;</span>;
<span class="hljs-keyword">import</span> { Transition } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;react-transition-group&apos;</span>;
<span class="hljs-comment">//ts&#x9ED8;&#x8BA4;&#x4E0D;&#x652F;&#x6301;png&#x683C;&#x5F0F;,&#x9700;&#x8981;&#x6DFB;&#x52A0;images.d.ts&#x58F0;&#x660E;&#x6587;&#x4EF6;&#x4EE5;&#x652F;&#x6301;&#x52A0;&#x8F7D;png</span>
<span class="hljs-keyword">import</span> logo <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;@/assets/images/logo.png&apos;</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">&apos;./index.less&apos;</span>;
<span class="hljs-keyword">const</span> duration = <span class="hljs-number">1000</span>;
<span class="hljs-comment">//&#x9ED8;&#x8BA4;&#x6837;&#x5F0F;</span>
<span class="hljs-keyword">const</span> defaultStyle = {
    <span class="hljs-attr">transition</span>: <span class="hljs-string">`opacity <span class="hljs-subst">${duration}</span>ms ease-in-out`</span>,
    <span class="hljs-attr">opacity</span>: <span class="hljs-number">0</span>,
}
interface TransitionStyles {
    <span class="hljs-attr">entering</span>: CSSProperties;<span class="hljs-comment">//&#x8FDB;&#x5165;&#x65F6;&#x7684;&#x6837;&#x5F0F;</span>
    entered: CSSProperties;<span class="hljs-comment">//&#x8FDB;&#x5165;&#x6210;&#x529F;&#x65F6;&#x7684;&#x6837;&#x5F0F;</span>
    exiting: CSSProperties;<span class="hljs-comment">//&#x9000;&#x51FA;&#x65F6;&#x7684;&#x6837;&#x5F0F;</span>
    exited: CSSProperties;<span class="hljs-comment">//&#x9000;&#x51FA;&#x6210;&#x529F;&#x65F6;&#x7684;&#x6837;&#x5F0F;</span>
}
<span class="hljs-keyword">const</span> transitionStyles: TransitionStyles = {
    <span class="hljs-attr">entering</span>: { <span class="hljs-attr">opacity</span>: <span class="hljs-number">1</span> },<span class="hljs-comment">//&#x4E0D;&#x900F;&#x660E;&#x5EA6;&#x4E3A;1</span>
    <span class="hljs-attr">entered</span>: { <span class="hljs-attr">opacity</span>: <span class="hljs-number">1</span> }, <span class="hljs-comment">//&#x4E0D;&#x900F;&#x660E;&#x5EA6;&#x4E3A;1</span>
    <span class="hljs-attr">exiting</span>: { <span class="hljs-attr">opacity</span>: <span class="hljs-number">0</span> }, <span class="hljs-comment">//&#x4E0D;&#x900F;&#x660E;&#x5EA6;&#x4E3A;0</span>
    <span class="hljs-attr">exited</span>: { <span class="hljs-attr">opacity</span>: <span class="hljs-number">0</span> },  <span class="hljs-comment">//&#x4E0D;&#x900F;&#x660E;&#x5EA6;&#x4E3A;0</span>
};


interface Props {
    <span class="hljs-attr">currentCategory</span>: string;<span class="hljs-comment">//&#x5F53;&#x524D;&#x9009;&#x4E2D;&#x7684;&#x5206;&#x7C7B; &#x6B64;&#x6570;&#x636E;&#x4F1A;&#x653E;&#x5728;redux&#x4ED3;&#x5E93;&#x4E2D;</span>
    setCurrentCategory: <span class="hljs-function">(<span class="hljs-params">currentCategory: string</span>) =&gt;</span> any;<span class="hljs-comment">// &#x6539;&#x53D8;&#x4ED3;&#x5E93;&#x4E2D;&#x7684;&#x5206;&#x7C7B;</span>
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">HomeHeader</span>(<span class="hljs-params">props: Props</span>) </span>{
    <span class="hljs-keyword">let</span> [isMenuVisible, setIsMenuVisible] = useState(<span class="hljs-literal">false</span>);<span class="hljs-comment">//&#x8BBE;&#x5B9A;&#x6807;&#x8BC6;&#x4F4D;&#x8868;&#x793A;&#x83DC;&#x5355;&#x662F;&#x5426;&#x663E;&#x793A;</span>
    <span class="hljs-comment">//&#x8BBE;&#x7F6E;&#x5F53;&#x524D;&#x5206;&#x7C7B;,&#x628A;&#x5F53;&#x524D;&#x9009;&#x4E2D;&#x7684;&#x5206;&#x7C7B;&#x4F20;&#x9012;&#x7ED9;redux&#x4ED3;&#x5E93;</span>
    <span class="hljs-keyword">const</span> setCurrentCategory = <span class="hljs-function">(<span class="hljs-params">event: React.MouseEvent&lt;HTMLUListElement&gt;</span>) =&gt;</span> {
        <span class="hljs-keyword">let</span> target: HTMLUListElement = event.target <span class="hljs-keyword">as</span> HTMLUListElement;
        <span class="hljs-keyword">let</span> category = target.dataset.category;<span class="hljs-comment">//&#x83B7;&#x53D6;&#x7528;&#x6237;&#x9009;&#x62E9;&#x7684;&#x5206;&#x7C7B;&#x540D;&#x79F0;</span>
        props.setCurrentCategory(category);<span class="hljs-comment">//&#x8BBE;&#x7F6E;&#x5206;&#x7C7B;&#x540D;&#x79F0;</span>
        setIsMenuVisible(<span class="hljs-literal">false</span>);<span class="hljs-comment">//&#x5173;&#x95ED;&#x5206;&#x7C7B;&#x9009;&#x62E9;&#x5C42;</span>
    }
    <span class="hljs-keyword">return</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">header</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;home-header&quot;</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;logo-header&quot;</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{logo}</span> /&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">BarsOutlined</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> setIsMenuVisible(!isMenuVisible)} /&gt;
            <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Transition</span> <span class="hljs-attr">in</span>=<span class="hljs-string">{isMenuVisible}</span> <span class="hljs-attr">timeout</span>=<span class="hljs-string">{duration}</span>&gt;</span>
                {
                    (state: keyof TransitionStyles) =&gt; (
                        <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>
                            <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;category&quot;</span>
                            <span class="hljs-attr">onClick</span>=<span class="hljs-string">{setCurrentCategory}</span>
                            <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span>
                                <span class="hljs-attr">...defaultStyle</span>,
                                <span class="hljs-attr">...transitionStyles</span>[<span class="hljs-attr">state</span>]
                            }}
                        &gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">data-category</span>=<span class="hljs-string">&quot;all&quot;</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{classnames({</span> <span class="hljs-attr">active:</span> <span class="hljs-attr">props.currentCategory</span> === <span class="hljs-string">&apos;all&apos;</span> })}&gt;</span>&#x5168;&#x90E8;&#x8BFE;&#x7A0B;<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">data-category</span>=<span class="hljs-string">&quot;react&quot;</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{classnames({</span> <span class="hljs-attr">active:</span> <span class="hljs-attr">props.currentCategory</span> === <span class="hljs-string">&apos;react&apos;</span> })}&gt;</span>React&#x8BFE;&#x7A0B;<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
                            <span class="hljs-tag">&lt;<span class="hljs-name">li</span> <span class="hljs-attr">data-category</span>=<span class="hljs-string">&quot;vue&quot;</span> <span class="hljs-attr">className</span>=<span class="hljs-string">{classnames({</span> <span class="hljs-attr">active:</span> <span class="hljs-attr">props.currentCategory</span> === <span class="hljs-string">&apos;vue&apos;</span> })}&gt;</span>Vue&#x8BFE;&#x7A0B;<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
                        <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
                    )
                }
            <span class="hljs-tag">&lt;/<span class="hljs-name">Transition</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">header</span>&gt;</span></span>
    )
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> HomeHeader;
</code></pre>
<h3 id="t343.5 HomeHeader\index.less">3.5 HomeHeader\index.less <a href="#t343.5 HomeHeader\index.less"> # </a></h3>
<p>src\routes\Home\components\HomeHeader\index.less</p>
<pre><code class="lang-less"><span class="hljs-variable">@BG:</span> <span class="hljs-number">#2a2a2a</span>;
<span class="hljs-selector-class">.home-header</span> {
  <span class="hljs-attribute">position</span>: fixed;
  <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">z-index</span>: <span class="hljs-number">999</span>;
  <span class="hljs-selector-class">.logo-header</span> {
    <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>;
    <span class="hljs-attribute">background</span>: <span class="hljs-variable">@BG</span>;
    <span class="hljs-attribute">color</span>: <span class="hljs-number">#fff</span>;
    <span class="hljs-attribute">display</span>: flex;
    <span class="hljs-attribute">justify-content</span>: space-between;
    <span class="hljs-attribute">align-items</span>: center;
    <span class="hljs-selector-tag">img</span> {
      <span class="hljs-attribute">width</span>: <span class="hljs-number">200px</span>;
      <span class="hljs-attribute">margin-left</span>: <span class="hljs-number">20px</span>;
    }
    <span class="hljs-selector-tag">span</span><span class="hljs-selector-class">.anticon</span><span class="hljs-selector-class">.anticon-bars</span> {
      <span class="hljs-attribute">font-size</span>: <span class="hljs-number">60px</span>;
      <span class="hljs-attribute">margin-right</span>: <span class="hljs-number">20px</span>;
    }
  }
  <span class="hljs-selector-class">.category</span> {
    <span class="hljs-attribute">position</span>: absolute;
    <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
    <span class="hljs-attribute">top</span>: <span class="hljs-number">100px</span>;
    <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
    <span class="hljs-attribute">background</span>: <span class="hljs-variable">@BG</span>;
    <span class="hljs-selector-tag">li</span> {
      <span class="hljs-attribute">line-height</span>: <span class="hljs-number">60px</span>;
      <span class="hljs-attribute">text-align</span>: center;
      <span class="hljs-attribute">color</span>: <span class="hljs-number">#fff</span>;
      <span class="hljs-attribute">font-size</span>: <span class="hljs-number">30px</span>;
      <span class="hljs-attribute">border-top</span>: <span class="hljs-number">1px</span> solid lighten(<span class="hljs-variable">@BG</span>, <span class="hljs-number">20%</span>);
      <span class="hljs-selector-tag">&amp;</span><span class="hljs-selector-class">.active</span> {
        <span class="hljs-attribute">color</span>: red;
      }
    }
  }
}
</code></pre>
<h3 id="t353.6 action-types.tsx">3.6 action-types.tsx <a href="#t353.6 action-types.tsx"> # </a></h3>
<p>src\store\action-types.tsx</p>
<pre><code class="lang-diff">//&#x8BBE;&#x7F6E;&#x5F53;&#x524D;&#x5206;&#x7C7B;&#x7684;&#x540D;&#x79F0;
<span class="hljs-addition">+export const SET_CURRENT_CATEGORY = &apos;SET_CURRENT_CATEGORY&apos;;</span>
</code></pre>
<h3 id="t363.7 reducers\home.tsx">3.7 reducers\home.tsx <a href="#t363.7 reducers\home.tsx"> # </a></h3>
<p>src\store\reducers\home.tsx</p>
<pre><code class="lang-diff">import { AnyAction } from &apos;redux&apos;;
<span class="hljs-addition">+import * as TYPES from &quot;../action-types&quot;;</span>
export interface HomeState {
<span class="hljs-addition">+    currentCategory: string;</span>
}
let initialState: HomeState = {
<span class="hljs-addition">+    currentCategory: &apos;all&apos;//&#x9ED8;&#x8BA4;&#x5F53;&#x524D;&#x7684;&#x5206;&#x7C7B;&#x662F;&#x663E;&#x793A;&#x5168;&#x90E8;&#x7C7B;&#x578B;&#x7684;&#x8BFE;&#x7A0B;</span>
};
export default function (state: HomeState = initialState, action: AnyAction): HomeState {
    switch (action.type) {
<span class="hljs-addition">+        case TYPES.SET_CURRENT_CATEGORY://&#x4FEE;&#x6539;&#x5F53;&#x524D;&#x5206;&#x7C7B;</span>
<span class="hljs-addition">+            return { ...state, currentCategory: action.payload };</span>
        default:
            return state;
    }
}
</code></pre>
<h3 id="t373.8 actions\home.tsx">3.8 actions\home.tsx <a href="#t373.8 actions\home.tsx"> # </a></h3>
<p>src\store\actions\home.tsx</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> TYPES <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../action-types&quot;</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  setCurrentCategory(currentCategory: string) {
    <span class="hljs-keyword">return</span> { <span class="hljs-attr">type</span>: TYPES.SET_CURRENT_CATEGORY, <span class="hljs-attr">payload</span>: currentCategory };
  },
};
</code></pre>
<h3 id="t383.9 Home\index.tsx">3.9 Home\index.tsx <a href="#t383.9 Home\index.tsx"> # </a></h3>
<p>src\routes\Home\index.tsx</p>
<pre><code class="lang-diff">import React, { PropsWithChildren } from &apos;react&apos;;
import { connect } from &apos;react-redux&apos;;
import { RouteComponentProps } from &apos;react-router-dom&apos;;
<span class="hljs-addition">+import actions from &apos;@/store/actions/home&apos;;</span>
<span class="hljs-addition">+import HomeHeader from &apos;./components/HomeHeader&apos;;</span>
<span class="hljs-addition">+import { CombinedState } from &apos;@/store/reducers&apos;;</span>
<span class="hljs-addition">+import { HomeState } from &apos;@/store/reducers/home&apos;;</span>
<span class="hljs-addition">+import &apos;./index.less&apos;;</span>
<span class="hljs-addition">+type StateProps = ReturnType&lt;typeof mapStateToProps&gt;;</span>
<span class="hljs-addition">+type DispatchProps = typeof actions;</span>
<span class="hljs-addition">+interface Params { }</span>
<span class="hljs-addition">+type Props = PropsWithChildren&lt;RouteComponentProps&lt;Params&gt; &amp; StateProps &amp; DispatchProps&gt;;</span>
<span class="hljs-addition">+function Home(props: Props) {</span>
<span class="hljs-addition">+    return (</span>
<span class="hljs-addition">+        &lt;&gt;</span>
<span class="hljs-addition">+            &lt;HomeHeader</span>
<span class="hljs-addition">+                currentCategory={props.currentCategory}</span>
<span class="hljs-addition">+                setCurrentCategory={props.setCurrentCategory}</span>
<span class="hljs-addition">+            /&gt;</span>
<span class="hljs-addition">+        &lt;/&gt;</span>
<span class="hljs-addition">+    )</span>
<span class="hljs-addition">+}</span>
<span class="hljs-addition">+let mapStateToProps = (state: CombinedState): HomeState =&gt; state.home;</span>
<span class="hljs-addition">+export default connect(</span>
<span class="hljs-addition">+    mapStateToProps,</span>
<span class="hljs-addition">+    actions</span>
<span class="hljs-addition">+)(Home);</span>
</code></pre>
<h3 id="t393.10 Home\index.less">3.10 Home\index.less <a href="#t393.10 Home\index.less"> # </a></h3>
<p>src\routes\Home\index.less</p>
<pre><code class="lang-less">
</code></pre>
<h2 id="t40&#x7B2C;4&#x7AE0; &#x521B;&#x5EFA;&#x670D;&#x52A1;&#x5668;&#x7AEF;&#x9879;&#x76EE;">&#x7B2C;4&#x7AE0; &#x521B;&#x5EFA;&#x670D;&#x52A1;&#x5668;&#x7AEF;&#x9879;&#x76EE; <a href="#t40&#x7B2C;4&#x7AE0; &#x521B;&#x5EFA;&#x670D;&#x52A1;&#x5668;&#x7AEF;&#x9879;&#x76EE;"> # </a></h2>
<ul>
<li><a href="https://robomongo.org/download">&#x5B89;&#x88C5;&#x5BA2;&#x6237;&#x7AEF;&#x5DE5;&#x5177; Robo 3T</a></li>
<li><a href="https://insomnia.rest/download/#windows">&#x5B89;&#x88C5; api &#x6D4B;&#x8BD5;&#x5DE5;&#x5177; Insomnia Core</a></li>
</ul>
<p>&#x76EE;&#x5F55;&#x7ED3;&#x6784;</p>
<pre><code class="lang-js">.
&#x251C;&#x2500;&#x2500; package.json
&#x251C;&#x2500;&#x2500; src
&#x2502;   &#x2514;&#x2500;&#x2500; index.ts
&#x2514;&#x2500;&#x2500; tsconfig.json
</code></pre>
<h3 id="t414.1 &#x751F;&#x6210;&#x9879;&#x76EE;">4.1 &#x751F;&#x6210;&#x9879;&#x76EE; <a href="#t414.1 &#x751F;&#x6210;&#x9879;&#x76EE;"> # </a></h3>
<pre><code class="lang-js">mkdir zfkt2020-api
cd zfkt2020-api
cnpm init -y
</code></pre>
<h3 id="t424.2 &#x5B89;&#x88C5;&#x4F9D;&#x8D56;">4.2 &#x5B89;&#x88C5;&#x4F9D;&#x8D56; <a href="#t424.2 &#x5B89;&#x88C5;&#x4F9D;&#x8D56;"> # </a></h3>
<pre><code class="lang-js">cnpm i express mongoose body-parser bcryptjs jsonwebtoken morgan cors validator helmet dotenv multer http-status-codes -S
cnpm i typescript  @types/node @types/express @types/mongoose @types/bcryptjs @types/jsonwebtoken  @types/morgan @types/cors @types/validator ts-node-dev nodemon  @types/helmet @types/multer cross-env -D
</code></pre>
<table>
<thead>
<tr>
<th style="text-align:left">&#x6A21;&#x5757;&#x540D;</th>
<th style="text-align:left">&#x82F1;&#x6587;</th>
<th style="text-align:left">&#x4E2D;&#x6587;</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">express</td>
<td style="text-align:left">Fast, unopinionated, minimalist web framework for node.</td>
<td style="text-align:left">&#x57FA;&#x4E8E; Node.js &#x5E73;&#x53F0;&#xFF0C;&#x5FEB;&#x901F;&#x3001;&#x5F00;&#x653E;&#x3001;&#x6781;&#x7B80;&#x7684; Web &#x5F00;&#x53D1;&#x6846;&#x67B6;</td>
</tr>
<tr>
<td style="text-align:left">@types/express</td>
<td style="text-align:left">This package contains type definitions for Express</td>
<td style="text-align:left">express &#x7684;&#x7C7B;&#x578B;&#x58F0;&#x660E;</td>
</tr>
<tr>
<td style="text-align:left">mongoose</td>
<td style="text-align:left">Mongoose is a MongoDB object modeling tool designed to work in an asynchronous environment. Mongoose supports both promises and callbacks.</td>
<td style="text-align:left">Mongoose &#x4E3A;&#x6A21;&#x578B;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x79CD;&#x76F4;&#x63A5;&#x7684;&#xFF0C;&#x57FA;&#x4E8E; scheme &#x7ED3;&#x6784;&#x53BB;&#x5B9A;&#x4E49;&#x4F60;&#x7684;&#x6570;&#x636E;&#x6A21;&#x578B;&#x3002;&#x5B83;&#x5185;&#x7F6E;&#x6570;&#x636E;&#x9A8C;&#x8BC1;&#xFF0C; &#x67E5;&#x8BE2;&#x6784;&#x5EFA;&#xFF0C;&#x4E1A;&#x52A1;&#x903B;&#x8F91;&#x94A9;&#x5B50;&#x7B49;&#xFF0C;&#x5F00;&#x7BB1;&#x5373;&#x7528;</td>
</tr>
<tr>
<td style="text-align:left">@types/mongoose</td>
<td style="text-align:left">This package contains type definitions for Mongoose</td>
<td style="text-align:left">mongoose &#x7684;&#x7C7B;&#x578B;&#x58F0;&#x660E;</td>
</tr>
<tr>
<td style="text-align:left">body-parser</td>
<td style="text-align:left">Node.js body parsing middleware.</td>
<td style="text-align:left">body-parser &#x662F;&#x4E00;&#x4E2A; HTTP &#x8BF7;&#x6C42;&#x4F53;&#x89E3;&#x6790;&#x4E2D;&#x95F4;&#x4EF6;&#xFF0C;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x6A21;&#x5757;&#x53EF;&#x4EE5;&#x89E3;&#x6790; JSON&#x3001;Raw&#x3001;&#x6587;&#x672C;&#x3001;URL-encoded &#x683C;&#x5F0F;&#x7684;&#x8BF7;&#x6C42;&#x4F53;&#xFF0C;Express &#x6846;&#x67B6;&#x4E2D;&#x5C31;&#x662F;&#x4F7F;&#x7528;&#x8FD9;&#x4E2A;&#x6A21;&#x5757;&#x505A;&#x4E3A;&#x8BF7;&#x6C42;&#x4F53;&#x89E3;&#x6790;&#x4E2D;&#x95F4;&#x4EF6;</td>
</tr>
<tr>
<td style="text-align:left">bcryptjs</td>
<td style="text-align:left">Optimized bcrypt in JavaScript with zero dependencies. Compatible to the C++ bcrypt binding on node.js and also working in the browser.</td>
<td style="text-align:left">bcryptjs &#x662F;&#x4E00;&#x4E2A;&#x7B2C;&#x4E09;&#x65B9;&#x52A0;&#x5BC6;&#x5E93;&#xFF0C;&#x7528;&#x6765;&#x5B9E;&#x73B0;&#x5728; Node &#x73AF;&#x5883;&#x4E0B;&#x7684; bcrypt &#x52A0;&#x5BC6;</td>
</tr>
<tr>
<td style="text-align:left">@types/bcryptjs</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">jsonwebtoken</td>
<td style="text-align:left">An implementation of JSON Web Tokens</td>
<td style="text-align:left">JSON Web Token&#xFF08;JWT&#xFF09;&#x662F;&#x4E00;&#x4E2A;&#x975E;&#x5E38;&#x8F7B;&#x5DE7;&#x7684;&#x89C4;&#x8303;&#x3002;&#x8FD9;&#x4E2A;&#x89C4;&#x8303;&#x5141;&#x8BB8;&#x6211;&#x4EEC;&#x4F7F;&#x7528; JWT &#x5728;&#x7528;&#x6237;&#x548C;&#x670D;&#x52A1;&#x5668;&#x4E4B;&#x95F4;&#x4F20;&#x9012;&#x5B89;&#x5168;&#x53EF;&#x9760;&#x7684;&#x4FE1;&#x606F;</td>
</tr>
<tr>
<td style="text-align:left">@types/jsonwebtoken</td>
<td style="text-align:left">This package contains type definitions for jsonwebtoken</td>
<td style="text-align:left">jsonwebtoken &#x7684;&#x7C7B;&#x578B;&#x58F0;&#x660E;</td>
</tr>
<tr>
<td style="text-align:left">morgan</td>
<td style="text-align:left">HTTP request logger middleware for node.js</td>
<td style="text-align:left">morgan &#x662F; express &#x9ED8;&#x8BA4;&#x7684;&#x65E5;&#x5FD7;&#x4E2D;&#x95F4;&#x4EF6;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x8131;&#x79BB; express&#xFF0C;&#x4F5C;&#x4E3A; node.js &#x7684;&#x65E5;&#x5FD7;&#x7EC4;&#x4EF6;&#x5355;&#x72EC;&#x4F7F;&#x7528;</td>
</tr>
<tr>
<td style="text-align:left">@types/morgan</td>
<td style="text-align:left">This package contains type definitions for morgan</td>
<td style="text-align:left">morgan &#x7684;&#x7C7B;&#x578B;&#x58F0;&#x660E;</td>
</tr>
<tr>
<td style="text-align:left">cors</td>
<td style="text-align:left">CORS is a node.js package for providing a Connect/Express middleware that can be used to enable CORS with various options.</td>
<td style="text-align:left">CORS &#x662F;&#x7528;&#x4E8E;&#x63D0;&#x4F9B; Connect / Express &#x4E2D;&#x95F4;&#x4EF6;&#x7684; node.js &#x7A0B;&#x5E8F;&#x5305;&#xFF0C;&#x53EF;&#x7528;&#x4E8E;&#x542F;&#x7528;&#x5177;&#x6709;&#x5404;&#x79CD;&#x9009;&#x9879;&#x7684; CORS</td>
</tr>
<tr>
<td style="text-align:left">@types/cors</td>
<td style="text-align:left">This package contains type definitions for cors</td>
<td style="text-align:left">cors &#x7684;&#x7C7B;&#x578B;&#x58F0;&#x660E;</td>
</tr>
<tr>
<td style="text-align:left">validator</td>
<td style="text-align:left">A library of string validators and sanitizers</td>
<td style="text-align:left">&#x4E00;&#x4E2A;&#x7528;&#x4E8E;&#x5B57;&#x7B26;&#x4E32;&#x9A8C;&#x8BC1;&#x548C;&#x51C0;&#x5316;&#x7684;&#x5E93;</td>
</tr>
<tr>
<td style="text-align:left">@types/validator</td>
<td style="text-align:left">This package contains type definitions for validator.js</td>
<td style="text-align:left">validator &#x7684;&#x7C7B;&#x578B;&#x58F0;&#x660E;</td>
</tr>
<tr>
<td style="text-align:left">helmet</td>
<td style="text-align:left">Helmet helps you secure your Express apps by setting various HTTP headers. It&apos;s not a silver bullet, but it can help!</td>
<td style="text-align:left">Helmet &#x53EF;&#x901A;&#x8FC7;&#x8BBE;&#x7F6E;&#x5404;&#x79CD; HTTP &#x6807;&#x5934;&#x6765;&#x5E2E;&#x52A9;&#x60A8;&#x4FDD;&#x62A4; Express &#x5E94;&#x7528;&#x7A0B;&#x5E8F;</td>
</tr>
<tr>
<td style="text-align:left">@types/helmet</td>
<td style="text-align:left">This package contains type definitions for helmet</td>
<td style="text-align:left">helmet &#x7684;&#x7C7B;&#x578B;&#x58F0;&#x660E;</td>
</tr>
<tr>
<td style="text-align:left">dotenv</td>
<td style="text-align:left">Dotenv is a zero-dependency module that loads environment variables from a .env file into process.env. Storing configuration in the environment separate from code is based on The Twelve-Factor App methodology.</td>
<td style="text-align:left">Dotenv &#x662F;&#x4E00;&#x4E2A;&#x96F6;&#x4F9D;&#x8D56;&#x6A21;&#x5757;&#xFF0C;&#x53EF;&#x5C06;&#x73AF;&#x5883;&#x53D8;&#x91CF;&#x4ECE;.env &#x6587;&#x4EF6;&#x52A0;&#x8F7D;&#x5230; process.env &#x4E2D;</td>
</tr>
<tr>
<td style="text-align:left">multer</td>
<td style="text-align:left">Multer is a node.js middleware for handling multipart/form-data, which is primarily used for uploading files. It is written on top of busboy for maximum efficiency.</td>
<td style="text-align:left">Multer &#x662F;&#x7528;&#x4E8E;&#x5904;&#x7406;<code>multyparty/formdata</code>&#x7C7B;&#x578B;&#x8BF7;&#x6C42;&#x4F53;&#x7684; node.js &#x4E2D;&#x95F4;&#x4EF6;&#xFF0C;&#x4E3B;&#x8981;&#x7528;&#x4E8E;&#x4E0A;&#x4F20;&#x6587;&#x4EF6;&#x3002; &#x5B83;&#x662F;&#x5728; busboy &#x4E4B;&#x4E0A;&#x7F16;&#x5199;&#x7684;&#xFF0C;&#x4EE5;&#x5B9E;&#x73B0;&#x6700;&#x5927;&#x6548;&#x7387;&#x3002;</td>
</tr>
<tr>
<td style="text-align:left">@types/multer</td>
<td style="text-align:left">This package contains type definitions for multer</td>
<td style="text-align:left">multer &#x7684;&#x7C7B;&#x578B;&#x58F0;&#x660E;</td>
</tr>
<tr>
<td style="text-align:left">typescript</td>
<td style="text-align:left">TypeScript is a language for application-scale JavaScript</td>
<td style="text-align:left">ypeScript &#x662F;&#x7528;&#x4E8E;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x7EA7; JavaScript &#x7684;&#x8BED;&#x8A00;</td>
</tr>
<tr>
<td style="text-align:left">@types/node</td>
<td style="text-align:left">This package contains type definitions for Node.js</td>
<td style="text-align:left">&#x8BE5;&#x8F6F;&#x4EF6;&#x5305;&#x5305;&#x542B; Node.js &#x7684;&#x7C7B;&#x578B;&#x5B9A;&#x4E49;</td>
</tr>
<tr>
<td style="text-align:left">ts-node-dev</td>
<td style="text-align:left">Tweaked version of node-dev that uses ts-node under the hood.</td>
<td style="text-align:left">&#x8C03;&#x6574;&#x540E;&#x7684;&#x7248;&#x672C;&#xFF0C;&#x5728;&#x540E;&#x53F0;&#x4F7F;&#x7528; ts-node</td>
</tr>
<tr>
<td style="text-align:left">nodemon</td>
<td style="text-align:left">nodemon is a tool that helps develop node.js based applications by automatically restarting the node application when file changes in the directory are detected.</td>
<td style="text-align:left">nodemon &#x662F;&#x4E00;&#x79CD;&#x5DE5;&#x5177;&#xFF0C;&#x53EF;&#x5728;&#x68C0;&#x6D4B;&#x5230;&#x76EE;&#x5F55;&#x4E2D;&#x7684;&#x6587;&#x4EF6;&#x66F4;&#x6539;&#x65F6;&#x901A;&#x8FC7;&#x81EA;&#x52A8;&#x91CD;&#x65B0;&#x542F;&#x52A8;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x6765;&#x5E2E;&#x52A9;&#x5F00;&#x53D1;&#x57FA;&#x4E8E; node.js &#x7684;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x3002;</td>
</tr>
</tbody>
</table>
<h3 id="t434.3 &#x521D;&#x59CB;&#x5316; tsconfig.json">4.3 &#x521D;&#x59CB;&#x5316; tsconfig.json <a href="#t434.3 &#x521D;&#x59CB;&#x5316; tsconfig.json"> # </a></h3>
<ul>
<li>&#x6267;&#x884C;&#x4EE5;&#x4E0B;&#x547D;&#x4EE4;&#x5E76;&#x9009;&#x62E9;<code>node</code></li>
</ul>
<pre><code class="lang-json">npx tsconfig.json
</code></pre>
<h3 id="t444.4 .gitignore">4.4 .gitignore <a href="#t444.4 .gitignore"> # </a></h3>
<pre><code class="lang-js">node_modules
src/public/upload/
.env
</code></pre>
<h3 id="t454.5 .env">4.5 .env <a href="#t454.5 .env"> # </a></h3>
<pre><code class="lang-js">JWT_SECRET_KEY=zhufeng
MONGODB_URL=mongodb:<span class="hljs-comment">//localhost/zhufengketang</span>
</code></pre>
<h3 id="t464.6 src\index.ts">4.6 src\index.ts <a href="#t464.6 src\index.ts"> # </a></h3>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> express, { Express } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;express&quot;</span>;
<span class="hljs-keyword">const</span> app: Express = express();
<span class="hljs-keyword">const</span> PORT: number = (process.env.PORT &amp;&amp; <span class="hljs-built_in">parseInt</span>(process.env.PORT)) || <span class="hljs-number">8000</span>;
app.listen(PORT, () =&gt; {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Running on http://localhost:<span class="hljs-subst">${PORT}</span>`</span>);
});
</code></pre>
<h3 id="t474.7 package.json">4.7 package.json <a href="#t474.7 package.json"> # </a></h3>
<pre><code class="lang-diff"><span class="hljs-addition">+  &quot;scripts&quot;: {</span>
<span class="hljs-addition">+    &quot;build&quot;: &quot;tsc&quot;,</span>
<span class="hljs-addition">+    &quot;start&quot;: &quot;cross-env PORT=8000  ts-node-dev --respawn src/index.ts&quot;,</span>
<span class="hljs-addition">+    &quot;dev&quot;: &quot;cross-env PORT=8000 nodemon --exec ts-node --files src/index.ts&quot;</span>
<span class="hljs-addition">+  }</span>
</code></pre>
<h3 id="t484.8 &#x6D4B;&#x8BD5;">4.8 &#x6D4B;&#x8BD5; <a href="#t484.8 &#x6D4B;&#x8BD5;"> # </a></h3>
<pre><code class="lang-js">npm run build
npm run dev 
npm run start
</code></pre>
<h2 id="t49&#x7B2C;5&#x7AE0; &#x7528;&#x6237;&#x7BA1;&#x7406;">&#x7B2C;5&#x7AE0; &#x7528;&#x6237;&#x7BA1;&#x7406; <a href="#t49&#x7B2C;5&#x7AE0; &#x7528;&#x6237;&#x7BA1;&#x7406;"> # </a></h2>
<ul>
<li>&#x672C;&#x7AE0;&#x7684;&#x662F;&#x7F16;&#x5199;&#x7528;&#x6237;&#x7BA1;&#x7406;&#x76F8;&#x5173;&#x7684;&#x63A5;&#x53E3;</li>
<li>&#x672C;&#x7AE0;&#x9700;&#x8981;&#x7F16;&#x5199;&#x4EE5;&#x4E0B;&#x63A5;&#x53E3;<ul>
<li>&#x7528;&#x6237;&#x6CE8;&#x518C;</li>
<li>&#x7528;&#x6237;&#x767B;&#x5F55;</li>
<li>&#x9A8C;&#x8BC1;&#x7528;&#x6237;&#x662F;&#x5426;&#x767B;&#x5F55;</li>
<li>&#x4E0A;&#x4F20;&#x5934;&#x50CF;</li>
</ul>
</li>
</ul>
<p>&#x672C;&#x7AE0;&#x76EE;&#x5F55;</p>
<pre><code class="lang-js">.
&#x251C;&#x2500;&#x2500; package.json
&#x251C;&#x2500;&#x2500; src
&#x2502;   &#x251C;&#x2500;&#x2500; controller
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; slider.ts
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; user.ts
&#x2502;   &#x251C;&#x2500;&#x2500; exceptions
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; HttpException.ts
&#x2502;   &#x251C;&#x2500;&#x2500; index.ts
&#x2502;   &#x251C;&#x2500;&#x2500; middlewares
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; errorMiddleware.ts
&#x2502;   &#x251C;&#x2500;&#x2500; models
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.ts
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; slider.ts
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; user.ts
&#x2502;   &#x251C;&#x2500;&#x2500; public
&#x2502;   &#x251C;&#x2500;&#x2500; typings
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; express.d.ts
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; jwt.ts
&#x2502;   &#x2514;&#x2500;&#x2500; utils
&#x2502;       &#x2514;&#x2500;&#x2500; validator.ts
&#x2514;&#x2500;&#x2500; tsconfig.json
</code></pre>
<p>&#x672C;&#x7AE0;&#x6548;&#x679C;</p>
<p><img src="http://img.zhufengpeixun.cn/userinterface.gif" alt="userinterface"></p>
<h4 id="t505.1 src/index.ts">5.1 src/index.ts <a href="#t505.1 src/index.ts"> # </a></h4>
<p>src/index.ts</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> express, { Express, Request, Response, NextFunction } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;express&quot;</span>;
<span class="hljs-keyword">import</span> mongoose <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mongoose&quot;</span>;
<span class="hljs-keyword">import</span> HttpException <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./exceptions/HttpException&quot;</span>;
<span class="hljs-keyword">import</span> cors <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;cors&quot;</span>;
<span class="hljs-keyword">import</span> morgan <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;morgan&quot;</span>;
<span class="hljs-keyword">import</span> helmet <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;helmet&quot;</span>;
<span class="hljs-keyword">import</span> errorMiddleware <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./middlewares/errorMiddleware&quot;</span>;
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> userController <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./controller/user&quot;</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">&quot;dotenv/config&quot;</span>;
<span class="hljs-keyword">import</span> multer <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;multer&quot;</span>;
<span class="hljs-keyword">import</span> path <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;path&quot;</span>;
<span class="hljs-keyword">const</span> storage = multer.diskStorage({
  <span class="hljs-attr">destination</span>: path.join(__dirname, <span class="hljs-string">&quot;public&quot;</span>, <span class="hljs-string">&quot;uploads&quot;</span>),
  filename(_req: Request, <span class="hljs-attr">file</span>: Express.Multer.File, cb) {
    cb(<span class="hljs-literal">null</span>, <span class="hljs-built_in">Date</span>.now() + path.extname(file.originalname));
  },
});
<span class="hljs-keyword">const</span> upload = multer({ storage });
<span class="hljs-keyword">const</span> app: Express = express();
app.use(morgan(<span class="hljs-string">&quot;dev&quot;</span>));
app.use(cors());
app.use(helmet());
app.use(express.static(path.resolve(__dirname, <span class="hljs-string">&quot;public&quot;</span>)));
app.use(express.json());
app.use(express.urlencoded({ <span class="hljs-attr">extended</span>: <span class="hljs-literal">false</span> }));
app.get(<span class="hljs-string">&quot;/&quot;</span>, (_req: Request, <span class="hljs-attr">res</span>: Response) =&gt; {
  res.json({ <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">message</span>: <span class="hljs-string">&quot;hello world&quot;</span> });
});
app.get(<span class="hljs-string">&quot;/user/validate&quot;</span>, userController.validate);
app.post(<span class="hljs-string">&quot;/user/register&quot;</span>, userController.register);
app.post(<span class="hljs-string">&quot;/user/login&quot;</span>, userController.login);
app.post(
  <span class="hljs-string">&quot;/user/uploadAvatar&quot;</span>,
  upload.single(<span class="hljs-string">&quot;avatar&quot;</span>),
  userController.uploadAvatar
);
app.use(<span class="hljs-function">(<span class="hljs-params">_req: Request, _res: Response, next: NextFunction</span>) =&gt;</span> {
  <span class="hljs-keyword">const</span> error: HttpException = <span class="hljs-keyword">new</span> HttpException(<span class="hljs-number">404</span>, <span class="hljs-string">&quot;Route not found&quot;</span>);
  next(error);
});
app.use(errorMiddleware);
<span class="hljs-keyword">const</span> PORT: number = (process.env.PORT &amp;&amp; <span class="hljs-built_in">parseInt</span>(process.env.PORT)) || <span class="hljs-number">8000</span>;
(<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  mongoose.set(<span class="hljs-string">&quot;useNewUrlParser&quot;</span>, <span class="hljs-literal">true</span>);
  mongoose.set(<span class="hljs-string">&quot;useUnifiedTopology&quot;</span>, <span class="hljs-literal">true</span>);
  <span class="hljs-keyword">await</span> mongoose.connect(<span class="hljs-string">&quot;mongodb://localhost/zhufengketang&quot;</span>);
  app.listen(PORT, () =&gt; {
    <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Running on http://localhost:<span class="hljs-subst">${PORT}</span>`</span>);
  });
})();
</code></pre>
<h4 id="t515.2 src/exceptions/HttpException.ts">5.2 src/exceptions/HttpException.ts <a href="#t515.2 src/exceptions/HttpException.ts"> # </a></h4>
<p>src/exceptions/HttpException.ts</p>
<pre><code class="lang-js"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HttpException</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Error</span> </span>{
    <span class="hljs-keyword">constructor</span>(public status: number, public message: string, public errors?: any) {
        <span class="hljs-keyword">super</span>(message);
    }
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> HttpException;
</code></pre>
<h4 id="t525.3 src/middlewares/errorMiddleware.ts">5.3 src/middlewares/errorMiddleware.ts <a href="#t525.3 src/middlewares/errorMiddleware.ts"> # </a></h4>
<p>src/middlewares/errorMiddleware.ts</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> HttpException <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../exceptions/HttpException&quot;</span>;
<span class="hljs-keyword">import</span> { Request, Response, NextFunction } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;express&quot;</span>;
<span class="hljs-keyword">import</span> statusCodes <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;http-status-codes&quot;</span>;
<span class="hljs-keyword">const</span> errorMiddleware = (
  error: HttpException,
  <span class="hljs-attr">_request</span>: Request,
  <span class="hljs-attr">response</span>: Response,
  <span class="hljs-attr">_next</span>: NextFunction
) =&gt; {
  response.status(error.status || statusCodes.INTERNAL_SERVER_ERROR).send({
    <span class="hljs-attr">success</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">message</span>: error.message,
    <span class="hljs-attr">errors</span>: error.errors,
  });
};
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> errorMiddleware;
</code></pre>
<h4 id="t535.4 src/utils/validator.ts">5.4 src/utils/validator.ts <a href="#t535.4 src/utils/validator.ts"> # </a></h4>
<p>src/utils/validator.ts</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> validator <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;validator&quot;</span>;
<span class="hljs-keyword">import</span> { IUserDocument } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../models/user&quot;</span>;

<span class="hljs-keyword">export</span> interface RegisterInput extends Partial&lt;IUserDocument&gt; {
  confirmPassword?: string;
}

<span class="hljs-keyword">export</span> interface RegisterInputValidateResult {
  <span class="hljs-attr">errors</span>: RegisterInput;
  valid: boolean;
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> validateRegisterInput = (
  username: string,
  <span class="hljs-attr">password</span>: string,
  <span class="hljs-attr">confirmPassword</span>: string,
  <span class="hljs-attr">email</span>: string
): <span class="hljs-function"><span class="hljs-params">RegisterInputValidateResult</span> =&gt;</span> {
  <span class="hljs-keyword">let</span> errors: RegisterInput = {};
  <span class="hljs-keyword">if</span> (username == <span class="hljs-literal">undefined</span> || validator.isEmpty(username)) {
    errors.username = <span class="hljs-string">&quot;&#x7528;&#x6237;&#x540D;&#x4E0D;&#x80FD;&#x4E3A;&#x7A7A;&quot;</span>;
  }
  <span class="hljs-keyword">if</span> (password == <span class="hljs-literal">undefined</span> || validator.isEmpty(password)) {
    errors.password = <span class="hljs-string">&quot;&#x5BC6;&#x7801;&#x4E0D;&#x80FD;&#x4E3A;&#x7A7A;&quot;</span>;
  }
  <span class="hljs-keyword">if</span> (confirmPassword == <span class="hljs-literal">undefined</span> || validator.isEmpty(confirmPassword)) {
    errors.password = <span class="hljs-string">&quot;&#x786E;&#x8BA4;&#x5BC6;&#x7801;&#x4E0D;&#x80FD;&#x4E3A;&#x7A7A;&quot;</span>;
  }
  <span class="hljs-keyword">if</span> (!validator.equals(password, confirmPassword)) {
    errors.confirmPassword = <span class="hljs-string">&quot;&#x786E;&#x8BA4;&#x5BC6;&#x7801;&#x548C;&#x5BC6;&#x7801;&#x4E0D;&#x76F8;&#x7B49;&quot;</span>;
  }
  <span class="hljs-keyword">if</span> (email == <span class="hljs-literal">undefined</span> || validator.isEmpty(password)) {
    errors.email = <span class="hljs-string">&quot;&#x90AE;&#x7BB1;&#x4E0D;&#x80FD;&#x4E3A;&#x7A7A;&quot;</span>;
  }
  <span class="hljs-keyword">if</span> (!validator.isEmail(email)) {
    errors.email = <span class="hljs-string">&quot;&#x90AE;&#x7BB1;&#x683C;&#x5F0F;&#x5FC5;&#x987B;&#x5408;&#x6CD5;&quot;</span>;
  }
  <span class="hljs-keyword">return</span> { errors, <span class="hljs-attr">valid</span>: <span class="hljs-built_in">Object</span>.keys(errors).length == <span class="hljs-number">0</span> };
};
</code></pre>
<h4 id="t545.5 src/typings/jwt.ts">5.5 src/typings/jwt.ts <a href="#t545.5 src/typings/jwt.ts"> # </a></h4>
<p>src/typings/jwt.ts</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> { IUserDocument } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../models/user&quot;</span>;

<span class="hljs-keyword">export</span> interface UserPayload {
    <span class="hljs-attr">id</span>: IUserDocument[<span class="hljs-string">&apos;_id&apos;</span>]
}
</code></pre>
<h4 id="t555.6 src\models\index.ts">5.6 src\models\index.ts <a href="#t555.6 src\models\index.ts"> # </a></h4>
<p>src\models\index.ts</p>
<pre><code class="lang-js"><span class="hljs-keyword">export</span> * <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./user&quot;</span>;
</code></pre>
<h4 id="t565.7 src/models/user.ts">5.7 src/models/user.ts <a href="#t565.7 src/models/user.ts"> # </a></h4>
<p>src/models/user.ts</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> mongoose, { Schema, Model, Document, HookNextFunction } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;mongoose&apos;</span>;
<span class="hljs-keyword">import</span> validator <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;validator&apos;</span>;
<span class="hljs-keyword">import</span> jwt <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;jsonwebtoken&apos;</span>;
<span class="hljs-keyword">import</span> { UserPayload } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;../typings/jwt&apos;</span>;
<span class="hljs-keyword">import</span> bcrypt <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;bcryptjs&apos;</span>;
<span class="hljs-keyword">export</span> interface IUserDocument extends Document {
    <span class="hljs-attr">username</span>: string,
    <span class="hljs-attr">password</span>: string,
    <span class="hljs-attr">email</span>: string;
    avatar: string;
    generateToken: <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> string
}
<span class="hljs-keyword">const</span> UserSchema: Schema&lt;IUserDocument&gt; = <span class="hljs-keyword">new</span> Schema({
    <span class="hljs-attr">username</span>: {
        <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span>,
        <span class="hljs-attr">required</span>: [<span class="hljs-literal">true</span>, <span class="hljs-string">&apos;&#x7528;&#x6237;&#x540D;&#x4E0D;&#x80FD;&#x4E3A;&#x7A7A;&apos;</span>],
        <span class="hljs-attr">minlength</span>: [<span class="hljs-number">6</span>, <span class="hljs-string">&apos;&#x6700;&#x5C0F;&#x957F;&#x5EA6;&#x4E0D;&#x80FD;&#x5C11;&#x4E8E;6&#x4F4D;&apos;</span>],
        <span class="hljs-attr">maxlength</span>: [<span class="hljs-number">12</span>, <span class="hljs-string">&apos;&#x6700;&#x5927;&#x957F;&#x5EA6;&#x4E0D;&#x80FD;&#x5927;&#x4E8E;12&#x4F4D;&apos;</span>]
    },
    <span class="hljs-attr">password</span>: <span class="hljs-built_in">String</span>,
    <span class="hljs-attr">avatar</span>: <span class="hljs-built_in">String</span>,
    <span class="hljs-attr">email</span>: {
        <span class="hljs-attr">type</span>: <span class="hljs-built_in">String</span>,
        <span class="hljs-attr">validate</span>: {
            <span class="hljs-attr">validator</span>: validator.isEmail
        },
        <span class="hljs-attr">trim</span>: <span class="hljs-literal">true</span>,
    }
}, { <span class="hljs-attr">timestamps</span>: <span class="hljs-literal">true</span>,<span class="hljs-attr">toJSON</span>:{
    transform(_doc,ret){
        ret.id=ret._id;
        <span class="hljs-keyword">delete</span> ret._id;
        <span class="hljs-keyword">delete</span> ret.__v;
        <span class="hljs-keyword">delete</span> ret.password;
        <span class="hljs-keyword">return</span> ret;
    }
} });

UserSchema.methods.generateToken = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>): <span class="hljs-title">string</span> </span>{
    <span class="hljs-keyword">let</span> payload: UserPayload = ({ <span class="hljs-attr">id</span>: <span class="hljs-keyword">this</span>._id });
    <span class="hljs-keyword">return</span> jwt.sign(payload, process.env.JWT_SECRET_KEY!, { <span class="hljs-attr">expiresIn</span>: <span class="hljs-string">&apos;1h&apos;</span> });
}
UserSchema.pre&lt;IUserDocument&gt;(<span class="hljs-string">&apos;save&apos;</span>, <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">next: HookNextFunction</span>) </span>{
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>.isModified(<span class="hljs-string">&apos;password&apos;</span>)) {
        <span class="hljs-keyword">return</span> next();
    }
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">this</span>.password = <span class="hljs-keyword">await</span> bcrypt.hash(<span class="hljs-keyword">this</span>.password, <span class="hljs-number">10</span>);
        next();
    } <span class="hljs-keyword">catch</span> (error) {
        next(error);
    }
});
UserSchema.static(<span class="hljs-string">&apos;login&apos;</span>, <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">this: any, username: string, password: string</span>): <span class="hljs-title">Promise</span>&lt;<span class="hljs-title">IUserDocument</span> | <span class="hljs-title">null</span>&gt; </span>{
    <span class="hljs-keyword">let</span> user: IUserDocument | <span class="hljs-literal">null</span> = <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.model(<span class="hljs-string">&apos;User&apos;</span>).findOne({ username });
    <span class="hljs-keyword">if</span> (user) {
        <span class="hljs-keyword">const</span> matched = <span class="hljs-keyword">await</span> bcrypt.compare(password, user.password);
        <span class="hljs-keyword">if</span> (matched) {
            <span class="hljs-keyword">return</span> user;
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;
        }
    }
    <span class="hljs-keyword">return</span> user;
});
interface IUserModel&lt;T extends Document&gt; extends Model&lt;T&gt; {
    <span class="hljs-attr">login</span>: <span class="hljs-function">(<span class="hljs-params">username: string, password: string</span>) =&gt;</span> IUserDocument | <span class="hljs-literal">null</span>
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> User: IUserModel&lt;IUserDocument&gt; = mongoose.model&lt;IUserDocument, IUserModel&lt;IUserDocument&gt;&gt;(<span class="hljs-string">&apos;User&apos;</span>, UserSchema);
</code></pre>
<h4 id="t575.8 src\controller\user.ts">5.8 src\controller\user.ts <a href="#t575.8 src\controller\user.ts"> # </a></h4>
<p>src\controller\user.ts</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> { Request, Response, NextFunction } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;express&apos;</span>;
<span class="hljs-keyword">import</span> { validateRegisterInput } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;../utils/validator&apos;</span>;
<span class="hljs-keyword">import</span> HttpException <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;../exceptions/HttpException&apos;</span>;
<span class="hljs-keyword">import</span> StatusCodes <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;http-status-codes&apos;</span>;
<span class="hljs-keyword">import</span> { IUserDocument, User } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;../models/user&apos;</span>;
<span class="hljs-keyword">import</span> { UserPayload } <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;../typings/jwt&apos;</span>;
<span class="hljs-keyword">import</span> jwt <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;jsonwebtoken&apos;</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> validate = <span class="hljs-keyword">async</span> (req: Request, <span class="hljs-attr">res</span>: Response, <span class="hljs-attr">next</span>: NextFunction) =&gt; {
    <span class="hljs-keyword">const</span> authorization = req.headers[<span class="hljs-string">&apos;authorization&apos;</span>];
    <span class="hljs-keyword">if</span> (authorization) {
        <span class="hljs-keyword">const</span> token = authorization.split(<span class="hljs-string">&apos; &apos;</span>)[<span class="hljs-number">1</span>];
        <span class="hljs-keyword">if</span> (token) {
            <span class="hljs-keyword">try</span> {
                <span class="hljs-keyword">const</span> payload: UserPayload = jwt.verify(token, process.env.JWT_SECRET_KEY!) <span class="hljs-keyword">as</span> UserPayload;
                <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> User.findById(payload.id);
                <span class="hljs-keyword">if</span> (user) {
                    res.json({
                        <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>,
                        <span class="hljs-attr">data</span>: user.toJSON()
                    });
                } <span class="hljs-keyword">else</span> {
                    next(<span class="hljs-keyword">new</span> HttpException(StatusCodes.UNAUTHORIZED, <span class="hljs-string">`&#x7528;&#x6237;&#x4E0D;&#x5408;&#x6CD5;!`</span>));
                }
            } <span class="hljs-keyword">catch</span> (error) {
                next(<span class="hljs-keyword">new</span> HttpException(StatusCodes.UNAUTHORIZED, <span class="hljs-string">`token&#x4E0D;&#x5408;&#x6CD5;!`</span>));
            }

        } <span class="hljs-keyword">else</span> {
            next(<span class="hljs-keyword">new</span> HttpException(StatusCodes.UNAUTHORIZED, <span class="hljs-string">`token&#x672A;&#x63D0;&#x4F9B;!`</span>));
        }
    } <span class="hljs-keyword">else</span> {
        next(<span class="hljs-keyword">new</span> HttpException(StatusCodes.UNAUTHORIZED, <span class="hljs-string">`authorization&#x672A;&#x63D0;&#x4F9B;!`</span>));
    }
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> register = <span class="hljs-keyword">async</span> (req: Request, <span class="hljs-attr">res</span>: Response, <span class="hljs-attr">next</span>: NextFunction) =&gt; {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">let</span> { username, password, confirmPassword, email, addresses } = req.body;
        <span class="hljs-keyword">const</span> { valid, errors } = validateRegisterInput(username, password, confirmPassword, email);
        <span class="hljs-keyword">if</span> (!valid) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> HttpException(StatusCodes.UNPROCESSABLE_ENTITY, <span class="hljs-string">`&#x53C2;&#x6570;&#x9A8C;&#x8BC1;&#x5931;&#x8D25;!`</span>, errors);
        }
        <span class="hljs-keyword">let</span> user: IUserDocument = <span class="hljs-keyword">new</span> User({
            username,
            email,
            password,
            addresses
        });
        <span class="hljs-keyword">let</span> oldUser: IUserDocument | <span class="hljs-literal">null</span> = <span class="hljs-keyword">await</span> User.findOne({ <span class="hljs-attr">username</span>: user.username });
        <span class="hljs-keyword">if</span> (oldUser) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> HttpException(StatusCodes.UNPROCESSABLE_ENTITY, <span class="hljs-string">`&#x7528;&#x6237;&#x540D;&#x91CD;&#x590D;!`</span>);
        }
        <span class="hljs-keyword">await</span> user.save();
        <span class="hljs-keyword">let</span> token = user.generateToken();
        res.json({
            <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>,
            <span class="hljs-attr">data</span>: { token }
        });
    } <span class="hljs-keyword">catch</span> (error) {
        next(error);
    }
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> login = <span class="hljs-keyword">async</span> (req: Request, <span class="hljs-attr">res</span>: Response, <span class="hljs-attr">next</span>: NextFunction) =&gt; {
    <span class="hljs-keyword">try</span> {
        <span class="hljs-keyword">let</span> { username, password } = req.body;
        <span class="hljs-keyword">let</span> user = <span class="hljs-keyword">await</span> User.login(username, password);
        <span class="hljs-keyword">if</span> (user) {
            <span class="hljs-keyword">let</span> token = user.generateToken();
            res.json({
                <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>,
                <span class="hljs-attr">data</span>: {
                    token
                }
            });
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> HttpException(StatusCodes.UNAUTHORIZED, <span class="hljs-string">`&#x767B;&#x5F55;&#x5931;&#x8D25;`</span>);
        }
    } <span class="hljs-keyword">catch</span> (error) {
        next(error);
    }
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> uploadAvatar = <span class="hljs-keyword">async</span> (req: Request, <span class="hljs-attr">res</span>: Response, <span class="hljs-attr">_next</span>: NextFunction) =&gt; {
    <span class="hljs-keyword">let</span> { userId } = req.body;
    <span class="hljs-keyword">let</span> domain = process.env.DOMAIN || <span class="hljs-string">`<span class="hljs-subst">${req.protocol}</span>://<span class="hljs-subst">${req.headers.host}</span>`</span>;
    <span class="hljs-keyword">let</span> avatar = <span class="hljs-string">`<span class="hljs-subst">${domain}</span>/uploads/<span class="hljs-subst">${req.file.filename}</span>`</span>;
    <span class="hljs-keyword">await</span> User.updateOne({ <span class="hljs-attr">_id</span>: userId }, { avatar });
    res.send({ <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">data</span>: avatar });
}
</code></pre>
<h4 id="t585.9 typings\express.d.ts">5.9 typings\express.d.ts <a href="#t585.9 typings\express.d.ts"> # </a></h4>
<p>src\typings\express.d.ts</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> { IUserDocument } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../models/user&quot;</span>;
declare global {
    namespace Express {
        <span class="hljs-keyword">export</span> interface Request {
            currentUser?: IUserDocument | <span class="hljs-literal">null</span>;
            file: Multer.File
        }
    }
}
</code></pre>
<h4 id="t595.10 .env">5.10 .env <a href="#t595.10 .env"> # </a></h4>
<p>.env</p>
<pre><code class="lang-js">JWT_SECRET_KEY=zhufeng
MONGODB_URL=mongodb:<span class="hljs-comment">//localhost:27017/zhufengketang</span>
PORT=<span class="hljs-number">8899</span>
DOMAIN=http:<span class="hljs-comment">//localhost:8899</span>
</code></pre>
<h2 id="t60&#x7B2C;6&#x7AE0; &#x4E2A;&#x4EBA;&#x4E2D;&#x5FC3;">&#x7B2C;6&#x7AE0; &#x4E2A;&#x4EBA;&#x4E2D;&#x5FC3; <a href="#t60&#x7B2C;6&#x7AE0; &#x4E2A;&#x4EBA;&#x4E2D;&#x5FC3;"> # </a></h2>
<ul>
<li>&#x672C;&#x7AE0;&#x4E3B;&#x8981;&#x7F16;&#x5199;<code>Profile</code>&#x7EC4;&#x4EF6;,&#x5C31;&#x662F;&#x5207;&#x6362;&#x5230;&#x4E2A;&#x4EBA;&#x4E2D;&#x5FC3;&#x9875;&#x7684;&#x65F6;&#x5019;,&#x5148;&#x53D1;&#x8D77;&#x4E00;&#x4E2A; ajax &#x8BF7;&#x6C42;&#x5224;&#x65AD;&#x6B64;&#x7528;&#x6237;&#x662F;&#x5426;&#x767B;&#x5F55;,&#x5982;&#x679C;&#x5DF2;&#x7ECF;&#x767B;&#x5F55;&#x7684;&#x8BDD;&#x663E;&#x793A;&#x7528;&#x6237;&#x4FE1;&#x606F;,&#x5982;&#x679C;&#x672A;&#x767B;&#x5F55;&#x7684;&#x8BF7;&#x63D0;&#x793A;&#x8DF3;&#x8F6C;&#x5230;&#x767B;&#x5F55;&#x548C;&#x6CE8;&#x518C;&#x9875;</li>
<li>&#x672C;&#x7AE0;&#x5B9E;&#x8DF5;&#x7684;&#x5185;&#x5BB9;<ul>
<li>&#x8DEF;&#x7531;&#x7684;&#x5207;&#x6362;</li>
<li>&#x5982;&#x4F55;&#x5728; hooks &#x4E2D;&#x53D1;&#x8D77; ajax &#x8BF7;&#x6C42;</li>
<li>&#x5982;&#x4F55;&#x4FDD;&#x5B58;&#x53CA;&#x53D1;&#x9001;&#x65F6;&#x643A;&#x5E26; jwt &#x548C; token</li>
<li>&#x5982;&#x4F55;&#x6839;&#x636E;&#x73AF;&#x5883;&#x4E0D;&#x540C;&#x52A0;&#x8F7D;&#x4E0D;&#x540C;&#x7684;&#x63A5;&#x53E3;&#x5730;&#x5740;</li>
<li>&#x5982;&#x4F55;&#x7F16;&#x5199;<code>axios</code>&#x62E6;&#x622A;&#x5668;</li>
</ul>
</li>
</ul>
<h3 id="t616.1  &#x8D44;&#x6599;">6.1  &#x8D44;&#x6599; <a href="#t616.1  &#x8D44;&#x6599;"> # </a></h3>
<h4 id="t626.1.1 &#x672C;&#x7AE0;&#x76EE;&#x5F55;">6.1.1 &#x672C;&#x7AE0;&#x76EE;&#x5F55; <a href="#t626.1.1 &#x672C;&#x7AE0;&#x76EE;&#x5F55;"> # </a></h4>
<pre><code class="lang-js">.
&#x251C;&#x2500;&#x2500; package.json
&#x251C;&#x2500;&#x2500; public
&#x2502;   &#x2514;&#x2500;&#x2500; index.html
&#x251C;&#x2500;&#x2500; src
&#x2502;   &#x251C;&#x2500;&#x2500; api
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; profile.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; assets
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; css
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; common.less
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; images
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; logo.png
&#x2502;   &#x251C;&#x2500;&#x2500; components
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; NavHeader
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; Tabs
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; routes
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Home
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; components
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; HomeHeader
&#x2502;   &#x2502;   &#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Mine
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; Profile
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; store
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; actions
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; home.tsx
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; profile.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; action-types.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; history.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; reducers
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; home.tsx
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; mine.tsx
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; profile.tsx
&#x2502;   &#x2514;&#x2500;&#x2500; typings
&#x2502;       &#x251C;&#x2500;&#x2500; images.d.ts
&#x2502;       &#x2514;&#x2500;&#x2500; login-types.tsx
&#x251C;&#x2500;&#x2500; tsconfig.json
&#x251C;&#x2500;&#x2500; webpack.config.js
</code></pre>
<h4 id="t636.1.2 &#x672C;&#x7AE0;&#x6548;&#x679C;">6.1.2 &#x672C;&#x7AE0;&#x6548;&#x679C; <a href="#t636.1.2 &#x672C;&#x7AE0;&#x6548;&#x679C;"> # </a></h4>
<p><img src="http://img.zhufengpeixun.cn/profileroute.gif" alt="profileroute"></p>
<h3 id="t646.2 Profile\index.tsx">6.2 Profile\index.tsx <a href="#t646.2 Profile\index.tsx"> # </a></h3>
<p>src\routes\Profile\index.tsx</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> React, { PropsWithChildren, useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;
<span class="hljs-keyword">import</span> { connect } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-redux&quot;</span>;
<span class="hljs-keyword">import</span> { CombinedState } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../../store/reducers&quot;</span>;
<span class="hljs-keyword">import</span> { ProfileState } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../../store/reducers/profile&quot;</span>;
<span class="hljs-keyword">import</span> actions <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../../store/actions/profile&quot;</span>;
<span class="hljs-keyword">import</span> LOGIN_TYPES <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../../typings/login-types&quot;</span>;
<span class="hljs-keyword">import</span> { RouteComponentProps } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-router&quot;</span>;
<span class="hljs-keyword">import</span> { Descriptions, Button, Alert, message } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;antd&quot;</span>;
<span class="hljs-keyword">import</span> NavHeader <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../../components/NavHeader&quot;</span>;
<span class="hljs-keyword">import</span> { AxiosError } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;axios&quot;</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./index.less&quot;</span>;
<span class="hljs-comment">//&#x5F53;&#x524D;&#x7684;&#x7EC4;&#x4EF6;&#x6709;&#x4E09;&#x4E2A;&#x5C5E;&#x6027;&#x6765;&#x6E90;</span>
<span class="hljs-comment">//1.mapStateToProps&#x7684;&#x8FD4;&#x56DE;&#x503C; 2.actions&#x5BF9;&#x8C61;&#x7C7B;&#x578B; 3. &#x6765;&#x81EA;&#x8DEF;&#x7531; 4.&#x7528;&#x6237;&#x4F20;&#x5165;&#x8FDB;&#x6765;&#x7684;&#x5176;&#x5B83;&#x5C5E;&#x6027;</span>
type StateProps = ReturnType&lt;<span class="hljs-keyword">typeof</span> mapStateToProps&gt;;
type DispatchProps = <span class="hljs-keyword">typeof</span> actions;
interface Params {}
type RouteProps = RouteComponentProps&lt;Params&gt;;
type Props = PropsWithChildren&lt;StateProps &amp; DispatchProps &amp; RouteProps&gt;;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Profile</span>(<span class="hljs-params">props: Props</span>) </span>{
  <span class="hljs-comment">//&#x7EC4;&#x4EF6;&#x52A0;&#x8F7D;&#x540E;&#x76F4;&#x63A5; &#x53D1;&#x8D77;&#x9A8C;&#x8BC1;&#x8BF7;&#x6C42;,&#x67E5;&#x770B;&#x6B64;&#x7528;&#x6237;&#x662F;&#x5426;&#x5DF2;&#x7ECF;&#x767B;&#x5F55;&#x8FC7;&#x4E86;,&#x5982;&#x679C;&#x6CA1;&#x6709;&#x767B;&#x5F55;&#x5219;&#x63D0;&#x793A;&#x9519;&#x8BEF;</span>
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    props.validate().catch(<span class="hljs-function">(<span class="hljs-params">error: AxiosError</span>) =&gt;</span> message.error(error.message));
  }, []);
  <span class="hljs-keyword">let</span> content; <span class="hljs-comment">//&#x91CC;&#x5B58;&#x653E;&#x7740;&#x8981;&#x6E32;&#x67D3;&#x7684;&#x5185;&#x5BB9;</span>
  <span class="hljs-keyword">if</span> (props.loginState == LOGIN_TYPES.UN_VALIDATE) {
    <span class="hljs-comment">//&#x5982;&#x679C;&#x672A;&#x9A8C;&#x8BC1;&#x5219;&#x5185;&#x5BB9;&#x4E3A;null</span>
    content = <span class="hljs-literal">null</span>;
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (props.loginState == LOGIN_TYPES.LOGINED) {
    <span class="hljs-comment">//&#x5982;&#x679C;&#x5DF2;&#x7ECF;&#x767B;&#x5F55;&#x663E;&#x793A;&#x7528;&#x6237;&#x4FE1;&#x606F;</span>
    content = (
      <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;user-info&quot;</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Descriptions</span> <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;&#x5F53;&#x524D;&#x767B;&#x5F55;&#x7528;&#x6237;&quot;</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Descriptions.Item</span> <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;&#x7528;&#x6237;&#x540D;&quot;</span>&gt;</span>&#x73E0;&#x5CF0;&#x67B6;&#x6784;<span class="hljs-tag">&lt;/<span class="hljs-name">Descriptions.Item</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Descriptions.Item</span> <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;&#x624B;&#x673A;&#x53F7;&quot;</span>&gt;</span>15718856132<span class="hljs-tag">&lt;/<span class="hljs-name">Descriptions.Item</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Descriptions.Item</span> <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;&#x90AE;&#x7BB1;&quot;</span>&gt;</span>zhangsan@qq.com<span class="hljs-tag">&lt;/<span class="hljs-name">Descriptions.Item</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Descriptions</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;primary&quot;</span>&gt;</span>&#x9000;&#x51FA;&#x767B;&#x5F55;<span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
    );
  } <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">//&#x5982;&#x679C;&#x6CA1;&#x6709;&#x767B;&#x5F55;,&#x5219;&#x663E;&#x793A;&#x6CE8;&#x518C;&#x548C;&#x767B;&#x5F55;&#x6309;&#x94AE;</span>
    content = (
      <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Alert</span>
          <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;warning&quot;</span>
          <span class="hljs-attr">message</span>=<span class="hljs-string">&quot;&#x5F53;&#x524D;&#x672A;&#x767B;&#x5F55;&quot;</span>
          <span class="hljs-attr">description</span>=<span class="hljs-string">&quot;&#x4EB2;&#x7231;&#x7684;&#x7528;&#x6237;&#x4F60;&#x597D;&#xFF0C;&#x4F60;&#x5F53;&#x524D;&#x5C1A;&#x672A;&#x767B;&#x5F55;&#xFF0C;&#x8BF7;&#x4F60;&#x9009;&#x62E9;&#x6CE8;&#x518C;&#x6216;&#x8005;&#x767B;&#x5F55;&quot;</span>
        /&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">textAlign:</span> &quot;<span class="hljs-attr">center</span>&quot;, <span class="hljs-attr">padding:</span> &quot;<span class="hljs-attr">50px</span>&quot; }}&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;dashed&quot;</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> props.history.push(&quot;/login&quot;)}&gt;
            &#x767B;&#x5F55;
          <span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;dashed&quot;</span>
            <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">marginLeft:</span> &quot;<span class="hljs-attr">50px</span>&quot; }}
            <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> props.history.push(&quot;/register&quot;)}
          &gt;
            &#x6CE8;&#x518C;
          <span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      <span class="hljs-tag">&lt;/&gt;</span></span>
    );
  }
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">section</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">NavHeader</span> <span class="hljs-attr">history</span>=<span class="hljs-string">{props.history}</span>&gt;</span>&#x4E2A;&#x4EBA;&#x4E2D;&#x5FC3;<span class="hljs-tag">&lt;/<span class="hljs-name">NavHeader</span>&gt;</span>
      {content}
    <span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">let</span> mapStateToProps = (state: CombinedState): <span class="hljs-function"><span class="hljs-params">ProfileState</span> =&gt;</span> state.profile;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> connect(mapStateToProps, actions)(Profile);
</code></pre>
<h3 id="t656.3 routes\Profile\index.less">6.3 routes\Profile\index.less <a href="#t656.3 routes\Profile\index.less"> # </a></h3>
<p>src\routes\Profile\index.less</p>
<pre><code class="lang-less"><span class="hljs-selector-class">.user-info</span> {
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
}
</code></pre>
<h3 id="t666.4 action-types.tsx">6.4 action-types.tsx <a href="#t666.4 action-types.tsx"> # </a></h3>
<p>src\store\action-types.tsx</p>
<pre><code class="lang-diff">export const ADD = &apos;ADD&apos;;
//&#x8BBE;&#x7F6E;&#x5F53;&#x524D;&#x5206;&#x7C7B;&#x7684;&#x540D;&#x79F0;
export const SET_CURRENT_CATEGORY = &apos;SET_CURRENT_CATEGORY&apos;;
//&#x53D1;&#x8D77;&#x9A8C;&#x8BC1;&#x7528;&#x6237;&#x662F;&#x5426;&#x767B;&#x5F55;&#x7684;&#x8BF7;&#x6C42;
<span class="hljs-addition">+export const VALIDATE = &apos;VALIDATE&apos;;</span>
</code></pre>
<h3 id="t676.5 typings\login-types.tsx">6.5 typings\login-types.tsx <a href="#t676.5 typings\login-types.tsx"> # </a></h3>
<p>src\typings\login-types.tsx</p>
<pre><code class="lang-js">enum LOGIN_TYPES {
    UN_VALIDATE, <span class="hljs-comment">//&#x672A;&#x9A8C;&#x8BC1;&#x8FC7;</span>
    LOGINED,     <span class="hljs-comment">//&#x767B;&#x5F55;</span>
    UNLOGIN      <span class="hljs-comment">//&#x672A;&#x767B;&#x5F55;</span>
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> LOGIN_TYPES;
</code></pre>
<h3 id="t686.6 reducers\profile.tsx">6.6 reducers\profile.tsx <a href="#t686.6 reducers\profile.tsx"> # </a></h3>
<p>src\store\reducers\profile.tsx</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> { AnyAction } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;redux&quot;</span>;
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> TYPES <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../action-types&quot;</span>;
<span class="hljs-keyword">import</span> LOGIN_TYPES <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../../typings/login-types&quot;</span>;
<span class="hljs-keyword">export</span> interface ProfileState {
  <span class="hljs-attr">loginState</span>: LOGIN_TYPES; <span class="hljs-comment">//&#x5F53;&#x524D;&#x7528;&#x6237;&#x7684;&#x767B;&#x5F55;&#x72B6;&#x6001;</span>
  user: any; <span class="hljs-comment">//&#x5F53;&#x524D;&#x5DF2;&#x7ECF;&#x767B;&#x5F55;&#x7684;&#x7528;&#x6237;&#x4FE1;&#x606F;</span>
  error: string | <span class="hljs-literal">null</span>; <span class="hljs-comment">//&#x9519;&#x8BEF;&#x4FE1;&#x606F;</span>
}
<span class="hljs-keyword">let</span> initialState: ProfileState = {
  <span class="hljs-comment">//&#x521D;&#x59CB;&#x72B6;&#x6001;</span>
  <span class="hljs-attr">loginState</span>: LOGIN_TYPES.UN_VALIDATE, <span class="hljs-comment">//&#x5F53;&#x524D;&#x7528;&#x6237;&#x7684;&#x767B;&#x5F55;&#x72B6;&#x6001;</span>
  <span class="hljs-attr">user</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">//&#x5F53;&#x524D;&#x5DF2;&#x7ECF;&#x767B;&#x5F55;&#x7684;&#x7528;&#x6237;&#x4FE1;&#x606F;</span>
  <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">//&#x9519;&#x8BEF;&#x4FE1;&#x606F;</span>
};
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">
  state: ProfileState = initialState,
  action: AnyAction
</span>): <span class="hljs-title">ProfileState</span> </span>{
  <span class="hljs-keyword">switch</span> (action.type) {
    <span class="hljs-keyword">case</span> TYPES.VALIDATE:
      <span class="hljs-keyword">if</span> (action.payload.success) {
        <span class="hljs-comment">//&#x5982;&#x679C;&#x6B64;&#x7528;&#x6237;&#x5DF2;&#x7ECF;&#x767B;&#x5F55;&#x4E86;</span>
        <span class="hljs-keyword">return</span> {
          ...state,
          <span class="hljs-attr">loginState</span>: LOGIN_TYPES.LOGINED,
          <span class="hljs-attr">user</span>: action.payload.data, <span class="hljs-comment">//&#x8BBE;&#x7F6E;&#x7528;&#x6237;&#x540D;</span>
          <span class="hljs-attr">error</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">//&#x6CA1;&#x6709;&#x9519;&#x8BEF;</span>
        };
      } <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">return</span> {
          ...state,
          <span class="hljs-attr">loginState</span>: LOGIN_TYPES.UNLOGIN,
          <span class="hljs-attr">user</span>: <span class="hljs-literal">null</span>, <span class="hljs-comment">//&#x7528;&#x6237;&#x540D;&#x4E3A;&#x7A7A;</span>
          <span class="hljs-attr">error</span>: action.payload, <span class="hljs-comment">//&#x9519;&#x8BEF;&#x5BF9;&#x8C61;&#x8D4B;&#x503C;</span>
        };
      }
    <span class="hljs-attr">default</span>:
      <span class="hljs-keyword">return</span> state;
  }
}
</code></pre>
<h3 id="t696.7 actions\profile.tsx">6.7 actions\profile.tsx <a href="#t696.7 actions\profile.tsx"> # </a></h3>
<p>src\store\actions\profile.tsx</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> { AnyAction } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;redux&quot;</span>;
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> TYPES <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../action-types&quot;</span>;
<span class="hljs-keyword">import</span> { validate } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../../api/profile&quot;</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  <span class="hljs-comment">//https://github.com/redux-utilities/redux-promise/blob/master/src/index.js</span>
  validate(): AnyAction {
    <span class="hljs-comment">//&#x53D1;&#x8D77;&#x5224;&#x65AD;&#x5F53;&#x524D;&#x7528;&#x6237;&#x662F;&#x5426;&#x767B;&#x5F55;&#x7684;&#x8BF7;&#x6C42;</span>
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">type</span>: TYPES.VALIDATE,
      <span class="hljs-attr">payload</span>: validate(),
    };
  },
};
</code></pre>
<h3 id="t706.8 api\index.tsx">6.8 api\index.tsx <a href="#t706.8 api\index.tsx"> # </a></h3>
<p>src\api\index.tsx</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;axios&quot;</span>;
<span class="hljs-comment">//&#x8BBE;&#x7F6E;AJAX&#x8BF7;&#x6C42;&#x7684;&#x57FA;&#x51C6;&#x8DEF;&#x5F84;,&#x5982;&#x679C;&#x662F;&#x5F00;&#x53D1;&#x73AF;&#x5883;&#x5C31;&#x6307;&#x5411; http://localhost:8000</span>
axios.defaults.baseURL =
  process.env.NODE_ENV === <span class="hljs-string">&quot;production&quot;</span> ? <span class="hljs-string">&quot;/&quot;</span> : <span class="hljs-string">&quot;http://localhost:8000&quot;</span>;
<span class="hljs-comment">//&#x8BBE;&#x7F6E;&#x8BF7;&#x6C42;&#x4F53;&#x7C7B;&#x578B;&#x4E3A; application/json</span>
axios.defaults.headers.post[<span class="hljs-string">&quot;Content-Type&quot;</span>] = <span class="hljs-string">&quot;application/json;charset=UTF-8&quot;</span>;
axios.interceptors.request.use(
  <span class="hljs-function">(<span class="hljs-params">config</span>) =&gt;</span> {
    <span class="hljs-comment">//&#x5728;&#x53D1;&#x9001;&#x8BF7;&#x6C42;&#x524D;&#x628A;sessionStorage&#x4E2D;&#x7684;token&#x5199;&#x5230;&#x8BF7;&#x6C42;&#x5934;&#x91CC;</span>
    <span class="hljs-keyword">let</span> access_token = sessionStorage.getItem(<span class="hljs-string">&quot;access_token&quot;</span>);
    config.headers = {
      <span class="hljs-attr">Authorization</span>: <span class="hljs-string">`Bearer <span class="hljs-subst">${access_token}</span>`</span>,
    };
    <span class="hljs-keyword">return</span> config;
  },
  (error) =&gt; {
    <span class="hljs-keyword">return</span> <span class="hljs-built_in">Promise</span>.reject(error);
  }
);
axios.interceptors.response.use(
  <span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> response.data,
  (error) =&gt; <span class="hljs-built_in">Promise</span>.reject(error)
);
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> axios;
</code></pre>
<h3 id="t716.10 src\api\profile.tsx">6.10 src\api\profile.tsx <a href="#t716.10 src\api\profile.tsx"> # </a></h3>
<p>src\api\profile.tsx</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./index&quot;</span>;
<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">validate</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> axios.get(<span class="hljs-string">&quot;/user/validate&quot;</span>);
}
</code></pre>
<h3 id="t726.11 NavHeader\index.tsx">6.11 NavHeader\index.tsx <a href="#t726.11 NavHeader\index.tsx"> # </a></h3>
<p>src\components\NavHeader\index.tsx</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./index.less&quot;</span>;
<span class="hljs-keyword">import</span> { LeftOutlined } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@ant-design/icons&quot;</span>;
interface Props {
  <span class="hljs-attr">history</span>: any;
  children: any;
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">NavHeader</span>(<span class="hljs-params">props: Props</span>) </span>{
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;nav-header&quot;</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">LeftOutlined</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> props.history.goBack()} /&gt;
      {props.children}
    <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  );
}
</code></pre>
<h3 id="t736.12 NavHeader\index.less">6.12 NavHeader\index.less <a href="#t736.12 NavHeader\index.less"> # </a></h3>
<p>src\components\NavHeader\index.less</p>
<pre><code class="lang-less"><span class="hljs-selector-class">.nav-header</span> {
  <span class="hljs-attribute">position</span>: fixed;
  <span class="hljs-attribute">left</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">top</span>: <span class="hljs-number">0</span>;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">100px</span>;
  <span class="hljs-attribute">z-index</span>: <span class="hljs-number">1000</span>;
  <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
  <span class="hljs-attribute">box-sizing</span>: border-box;
  <span class="hljs-attribute">text-align</span>: center;
  <span class="hljs-attribute">line-height</span>: <span class="hljs-number">100px</span>;
  <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#2a2a2a</span>;
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#fff</span>;
  <span class="hljs-selector-tag">span</span> {
    <span class="hljs-attribute">position</span>: absolute;
    <span class="hljs-attribute">left</span>: <span class="hljs-number">20px</span>;
    <span class="hljs-attribute">line-height</span>: <span class="hljs-number">100px</span>;
  }
}
</code></pre>
<h2 id="t74&#x7B2C;7&#x7AE0; &#x6CE8;&#x518C;&#x767B;&#x9646;">&#x7B2C;7&#x7AE0; &#x6CE8;&#x518C;&#x767B;&#x9646; <a href="#t74&#x7B2C;7&#x7AE0; &#x6CE8;&#x518C;&#x767B;&#x9646;"> # </a></h2>
<ul>
<li>&#x672C;&#x7AE0;&#x6211;&#x4EEC;&#x4E3B;&#x8981;&#x662F;&#x5B9E;&#x73B0;&#x6CE8;&#x518C;&#x767B;&#x5F55;&#x7684;&#x529F;&#x80FD;</li>
<li>&#x672C;&#x7AE0;&#x4E3B;&#x8981;&#x8981;&#x5B9E;&#x8DF5;&#x7684;&#x5185;&#x5BB9;<ul>
<li>&#x5982;&#x4F55;&#x4F7F;&#x7528;<code>antd4</code>&#x4E2D;&#x7684;&#x8868;&#x5355;&#x529F;&#x80FD;</li>
</ul>
</li>
</ul>
<h3 id="t757.1 &#x53C2;&#x8003;">7.1 &#x53C2;&#x8003; <a href="#t757.1 &#x53C2;&#x8003;"> # </a></h3>
<h4 id="t767.1.1 &#x76EE;&#x5F55;&#x7ED3;&#x6784;">7.1.1 &#x76EE;&#x5F55;&#x7ED3;&#x6784; <a href="#t767.1.1 &#x76EE;&#x5F55;&#x7ED3;&#x6784;"> # </a></h4>
<pre><code class="lang-js">.
&#x251C;&#x2500;&#x2500; package.json
&#x251C;&#x2500;&#x2500; public
&#x2502;   &#x2514;&#x2500;&#x2500; index.html
&#x251C;&#x2500;&#x2500; src
&#x2502;   &#x251C;&#x2500;&#x2500; api
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; profile.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; assets
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; css
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; common.less
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; images
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; logo.png
&#x2502;   &#x251C;&#x2500;&#x2500; components
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; NavHeader
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; Tabs
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; routes
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Home
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; components
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; HomeHeader
&#x2502;   &#x2502;   &#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Login
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Mine
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Profile
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; Register
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; store
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; actions
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; home.tsx
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; profile.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; action-types.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; history.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; reducers
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; home.tsx
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; mine.tsx
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; profile.tsx
&#x2502;   &#x2514;&#x2500;&#x2500; typings
&#x2502;       &#x251C;&#x2500;&#x2500; images.d.ts
&#x2502;       &#x251C;&#x2500;&#x2500; login-types.tsx
&#x2502;       &#x2514;&#x2500;&#x2500; user.tsx
&#x251C;&#x2500;&#x2500; tsconfig.json
&#x251C;&#x2500;&#x2500; webpack.config.js
</code></pre>
<h4 id="t777.1.2 &#x672C;&#x7AE0;&#x6548;&#x679C;">7.1.2 &#x672C;&#x7AE0;&#x6548;&#x679C; <a href="#t777.1.2 &#x672C;&#x7AE0;&#x6548;&#x679C;"> # </a></h4>
<p><img src="http://img.zhufengpeixun.cn/registerlogin.gif" alt="registerlogin"></p>
<h3 id="t787.2 src\index.tsx">7.2 src\index.tsx <a href="#t787.2 src\index.tsx"> # </a></h3>
<p>src\index.tsx</p>
<pre><code class="lang-diff">import React from &quot;react&quot;;
import ReactDOM from &quot;react-dom&quot;;
import { Switch, Route, Redirect } from &quot;react-router-dom&quot;;//&#x4E09;&#x4E2A;&#x8DEF;&#x7531;&#x7EC4;&#x4EF6;
import { Provider } from &quot;react-redux&quot;;//&#x8D1F;&#x8D23;&#x628A;&#x5C5E;&#x6027;&#x4E2D;&#x7684;store&#x4F20;&#x9012;&#x7ED9;&#x5B50;&#x7EC4;&#x4EF6;
import store from &quot;./store&quot;;//&#x5F15;&#x5165;&#x4ED3;&#x5E93;
import { ConfigProvider } from &quot;antd&quot;;//&#x914D;&#x7F6E;
import zh_CN from &quot;antd/lib/locale-provider/zh_CN&quot;;//&#x56FD;&#x9645;&#x5316;&#x4E2D;&#x6587;
import &quot;./assets/css/common.less&quot;;//&#x901A;&#x7528;&#x7684;&#x6837;&#x5F0F;
import Tabs from &quot;./components/Tabs&quot;;//&#x5F15;&#x5165;&#x5E95;&#x90E8;&#x7684;&#x9875;&#x7B7E;&#x5BFC;&#x822A;
import Home from &quot;./routes/Home&quot;;//&#x9996;&#x9875;
import Mine from &quot;./routes/Mine&quot;;//&#x6211;&#x7684;&#x8BFE;&#x7A0B;
import Profile from &quot;./routes/Profile&quot;;//&#x4E2A;&#x4EBA;&#x4E2D;&#x5FC3;
<span class="hljs-addition">+import Register from &quot;./routes/Register&quot;;</span>
<span class="hljs-addition">+import Login from &quot;./routes/Login&quot;;</span>
import { ConnectedRouter } from &apos;connected-react-router&apos;;//redux&#x7ED1;&#x5B9A;&#x8DEF;&#x7531;
import history from &apos;./store/history&apos;;
ReactDOM.render(
    &lt;Provider store={store}&gt;
        &lt;ConnectedRouter history={history}&gt;
            &lt;ConfigProvider locale={zh_CN}&gt;
                &lt;main className=&quot;main-container&quot;&gt;
                    &lt;Switch&gt;
                        &lt;Route path=&quot;/&quot; exact component={Home} /&gt;
                        &lt;Route path=&quot;/mine&quot; component={Mine} /&gt;
                        &lt;Route path=&quot;/profile&quot; component={Profile} /&gt;
<span class="hljs-addition">+                        &lt;Route path=&quot;/register&quot; component={Register} /&gt;</span>
<span class="hljs-addition">+                        &lt;Route path=&quot;/login&quot; component={Login} /&gt;</span>
                        &lt;Redirect to=&quot;/&quot; /&gt;
                    &lt;/Switch&gt;
                &lt;/main&gt;
                &lt;Tabs /&gt;
            &lt;/ConfigProvider&gt;
        &lt;/ConnectedRouter&gt;
    &lt;/Provider&gt;,
    document.getElementById(&quot;root&quot;)
);
</code></pre>
<h3 id="t797.3 api\profile.tsx">7.3 api\profile.tsx <a href="#t797.3 api\profile.tsx"> # </a></h3>
<p>src\api\profile.tsx</p>
<pre><code class="lang-diff">import axios from &apos;./index&apos;;
<span class="hljs-addition">+import { RegisterPayload, LoginPayload } from &apos;../typings/user&apos;;</span>
export function validate() {
    return axios.get(&apos;/user/validate&apos;);
}
<span class="hljs-addition">+export function register&lt;T&gt;(values: RegisterPayload) {</span>
<span class="hljs-addition">+        return axios.post&lt;T, T&gt;(&apos;/user/register&apos;, values);</span>
<span class="hljs-addition">+}</span>
<span class="hljs-addition">+export function login&lt;T&gt;(values: LoginPayload) {</span>
<span class="hljs-addition">+    return axios.post&lt;T, T&gt;(&apos;/user/login&apos;, values);</span>
<span class="hljs-addition">+}</span>
</code></pre>
<h3 id="t807.4 routes\Profile\index.tsx">7.4 routes\Profile\index.tsx <a href="#t807.4 routes\Profile\index.tsx"> # </a></h3>
<p>src\routes\Profile\index.tsx</p>
<pre><code class="lang-diff">import React, { PropsWithChildren, useEffect } from &apos;react&apos;;
import { connect } from &apos;react-redux&apos;;
import { CombinedState } from &apos;../../store/reducers&apos;;
import { ProfileState } from &apos;../../store/reducers/profile&apos;;
import actions from &apos;../../store/actions/profile&apos;;
import LOGIN_TYPES from &apos;../../typings/login-types&apos;;
import { RouteComponentProps } from &apos;react-router&apos;;
import { Descriptions, Button, Alert, message } from &apos;antd&apos;;
import NavHeader from &apos;../../components/NavHeader&apos;;
import { AxiosError } from &apos;axios&apos;;
import &apos;./index.less&apos;;
//&#x5F53;&#x524D;&#x7684;&#x7EC4;&#x4EF6;&#x6709;&#x4E09;&#x4E2A;&#x5C5E;&#x6027;&#x6765;&#x6E90;
//1.mapStateToProps&#x7684;&#x8FD4;&#x56DE;&#x503C; 2.actions&#x5BF9;&#x8C61;&#x7C7B;&#x578B; 3. &#x6765;&#x81EA;&#x8DEF;&#x7531; 4.&#x7528;&#x6237;&#x4F20;&#x5165;&#x8FDB;&#x6765;&#x7684;&#x5176;&#x5B83;&#x5C5E;&#x6027;
type StateProps = ReturnType&lt;typeof mapStateToProps&gt;;
type DispatchProps = typeof actions;
interface Params { }
type RouteProps = RouteComponentProps&lt;Params&gt;;
type Props = PropsWithChildren&lt;StateProps &amp; DispatchProps &amp; RouteProps&gt;
function Profile(props: Props) {
    //&#x7EC4;&#x4EF6;&#x52A0;&#x8F7D;&#x540E;&#x76F4;&#x63A5; &#x53D1;&#x8D77;&#x9A8C;&#x8BC1;&#x8BF7;&#x6C42;,&#x67E5;&#x770B;&#x6B64;&#x7528;&#x6237;&#x662F;&#x5426;&#x5DF2;&#x7ECF;&#x767B;&#x5F55;&#x8FC7;&#x4E86;,&#x5982;&#x679C;&#x6CA1;&#x6709;&#x767B;&#x5F55;&#x5219;&#x63D0;&#x793A;&#x9519;&#x8BEF;
    useEffect(() =&gt; {
        props.validate().catch((error: AxiosError) =&gt; message.error(error.message));
    }, []);
    let content;//&#x91CC;&#x5B58;&#x653E;&#x7740;&#x8981;&#x6E32;&#x67D3;&#x7684;&#x5185;&#x5BB9;
    if (props.loginState == LOGIN_TYPES.UN_VALIDATE) {//&#x5982;&#x679C;&#x672A;&#x9A8C;&#x8BC1;&#x5219;&#x5185;&#x5BB9;&#x4E3A;null
        content = null;
    } else if (props.loginState == LOGIN_TYPES.LOGINED) {//&#x5982;&#x679C;&#x5DF2;&#x7ECF;&#x767B;&#x5F55;&#x663E;&#x793A;&#x7528;&#x6237;&#x4FE1;&#x606F;
        content = (
            &lt;div className=&quot;user-info&quot;&gt;
                &lt;Descriptions title=&quot;&#x5F53;&#x524D;&#x767B;&#x5F55;&#x7528;&#x6237;&quot;&gt;
<span class="hljs-addition">+                &lt;Descriptions.Item label=&quot;&#x7528;&#x6237;&#x540D;&quot;&gt;{props.user.username}&lt;/Descriptions.Item&gt;</span>
<span class="hljs-addition">+                &lt;Descriptions.Item label=&quot;&#x90AE;&#x7BB1;&quot;&gt;{props.user.email}&lt;/Descriptions.Item&gt;</span>
                &lt;/Descriptions&gt;
<span class="hljs-addition">+                &lt;Button type={&quot;primary&quot;} onClick={async () =&gt; {</span>
<span class="hljs-addition">+                    await props.logout();</span>
<span class="hljs-addition">+                    props.history.push(&apos;/login&apos;);</span>
<span class="hljs-addition">+                }}&gt;&#x9000;&#x51FA;&#x767B;&#x5F55;&lt;/Button&gt;</span>
            &lt;/div&gt;
        )
    } else {//&#x5982;&#x679C;&#x6CA1;&#x6709;&#x767B;&#x5F55;,&#x5219;&#x663E;&#x793A;&#x6CE8;&#x518C;&#x548C;&#x767B;&#x5F55;&#x6309;&#x94AE;
        content = (
            &lt;&gt;
                &lt;Alert type=&quot;warning&quot; message=&quot;&#x5F53;&#x524D;&#x672A;&#x767B;&#x5F55;&quot; description=&quot;&#x4EB2;&#x7231;&#x7684;&#x7528;&#x6237;&#x4F60;&#x597D;&#xFF0C;&#x4F60;&#x5F53;&#x524D;&#x5C1A;&#x672A;&#x767B;&#x5F55;&#xFF0C;&#x8BF7;&#x4F60;&#x9009;&#x62E9;&#x6CE8;&#x518C;&#x6216;&#x8005;&#x767B;&#x5F55;&quot; /&gt;
                &lt;div style={{ textAlign: &apos;center&apos;, padding: &apos;50px&apos; }}&gt;
                    &lt;Button type=&quot;dashed&quot; onClick={() =&gt; props.history.push(&apos;/login&apos;)}&gt;&#x767B;&#x5F55;&lt;/Button&gt;
                    &lt;Button type=&quot;dashed&quot; style={{ marginLeft: &apos;50px&apos; }} onClick={() =&gt; props.history.push(&apos;/register&apos;)}&gt;&#x6CE8;&#x518C;&lt;/Button&gt;
                &lt;/div&gt;
            &lt;/&gt;
        )
    }
    return (
        (
            &lt;section&gt;
                &lt;NavHeader history={props.history}&gt;&#x4E2A;&#x4EBA;&#x4E2D;&#x5FC3;&lt;/NavHeader&gt;
                {content}
            &lt;/section&gt;
        )
    )
}

let mapStateToProps = (state: CombinedState): ProfileState =&gt; state.profile
export default connect(
    mapStateToProps,
    actions
)(Profile);
</code></pre>
<h3 id="t817.5 action-types.tsx">7.5 action-types.tsx <a href="#t817.5 action-types.tsx"> # </a></h3>
<p>src\store\action-types.tsx</p>
<pre><code class="lang-diff">export const ADD = &apos;ADD&apos;;
//&#x8BBE;&#x7F6E;&#x5F53;&#x524D;&#x5206;&#x7C7B;&#x7684;&#x540D;&#x79F0;
export const SET_CURRENT_CATEGORY = &apos;SET_CURRENT_CATEGORY&apos;;
//&#x53D1;&#x8D77;&#x9A8C;&#x8BC1;&#x7528;&#x6237;&#x662F;&#x5426;&#x767B;&#x5F55;&#x7684;&#x8BF7;&#x6C42;
export const VALIDATE = &apos;VALIDATE&apos;;

<span class="hljs-addition">+export const LOGOUT = &apos;LOGOUT&apos;;</span>
</code></pre>
<h3 id="t827.6 actions\profile.tsx">7.6 actions\profile.tsx <a href="#t827.6 actions\profile.tsx"> # </a></h3>
<p>src\store\actions\profile.tsx</p>
<pre><code class="lang-diff">import { AnyAction } from &apos;redux&apos;;
import * as TYPES from &apos;../action-types&apos;;
<span class="hljs-addition">+import { validate, register, login } from &apos;@/api/profile&apos;;</span>
<span class="hljs-addition">+import { push } from &apos;connected-react-router&apos;;</span>
<span class="hljs-addition">+import { RegisterPayload, LoginPayload, RegisterResult, LoginResult } from &apos;@/typings/user&apos;;</span>
<span class="hljs-addition">+import { message } from &quot;antd&quot;;</span>
export default {
    //https://github.com/redux-utilities/redux-promise/blob/master/src/index.js
    validate(): AnyAction {//&#x53D1;&#x8D77;&#x5224;&#x65AD;&#x5F53;&#x524D;&#x7528;&#x6237;&#x662F;&#x5426;&#x767B;&#x5F55;&#x7684;&#x8BF7;&#x6C42;
        return {
            type: TYPES.VALIDATE,
            payload: validate()
        }
    },
<span class="hljs-addition">+    register(values: RegisterPayload) {</span>
<span class="hljs-addition">+        return function (dispatch: any) {</span>
<span class="hljs-addition">+            (async function () {</span>
<span class="hljs-addition">+                try {</span>
<span class="hljs-addition">+                    let result: RegisterResult = await register&lt;RegisterResult&gt;(values);</span>
<span class="hljs-addition">+                    if (result.success) {</span>
<span class="hljs-addition">+                        dispatch(push(&apos;/login&apos;));</span>
<span class="hljs-addition">+                    } else {</span>
<span class="hljs-addition">+                        message.error(result.message);</span>
<span class="hljs-addition">+                    }</span>
<span class="hljs-addition">+                } catch (error) {</span>
<span class="hljs-addition">+                    message.error(&apos;&#x6CE8;&#x518C;&#x5931;&#x8D25;&apos;);</span>
<span class="hljs-addition">+                }</span>
<span class="hljs-addition">+            })();</span>
<span class="hljs-addition">+        }</span>
<span class="hljs-addition">+    },</span>
<span class="hljs-addition">+    login(values: LoginPayload) {</span>
<span class="hljs-addition">+        return function (dispatch: any) {</span>
<span class="hljs-addition">+            (async function () {</span>
<span class="hljs-addition">+                try {</span>
<span class="hljs-addition">+                    let result: LoginResult = await login&lt;LoginResult&gt;(values);</span>
<span class="hljs-addition">+                    if (result.success) {</span>
<span class="hljs-addition">+                        sessionStorage.setItem(&apos;access_token&apos;, result.data.token);</span>
<span class="hljs-addition">+                        dispatch(push(&apos;/profile&apos;));</span>
<span class="hljs-addition">+                    } else {</span>
<span class="hljs-addition">+                        message.error(result.message);</span>
<span class="hljs-addition">+                    }</span>
<span class="hljs-addition">+                } catch (error) {</span>
<span class="hljs-addition">+                    message.error(&apos;&#x767B;&#x5F55;&#x5931;&#x8D25;&apos;);</span>
<span class="hljs-addition">+                }</span>
<span class="hljs-addition">+            })();</span>
<span class="hljs-addition">+        }</span>
<span class="hljs-addition">+    },</span>
<span class="hljs-addition">+    logout() {</span>
<span class="hljs-addition">+            return function (dispatch: any) {</span>
<span class="hljs-addition">+                sessionStorage.removeItem(&apos;access_token&apos;);</span>
<span class="hljs-addition">+                dispatch({ type: TYPES.LOGOUT });</span>
<span class="hljs-addition">+                dispatch(push(&apos;/login&apos;));</span>
<span class="hljs-addition">+            }</span>
<span class="hljs-addition">+    }</span>
<span class="hljs-addition">+}</span>
</code></pre>
<h3 id="t837.7 src\typings\user.tsx">7.7 src\typings\user.tsx <a href="#t837.7 src\typings\user.tsx"> # </a></h3>
<p>src\typings\user.tsx</p>
<pre><code class="lang-js"><span class="hljs-keyword">export</span> interface RegisterPayload {
    <span class="hljs-attr">username</span>: string,
    <span class="hljs-attr">password</span>: string,
    <span class="hljs-attr">email</span>: string;
    confirmPassword: string;
}
<span class="hljs-keyword">export</span> interface LoginPayload {
    <span class="hljs-attr">username</span>: string,
    <span class="hljs-attr">password</span>: string,
}
<span class="hljs-keyword">export</span> interface RegisterResult {
    <span class="hljs-attr">data</span>: { <span class="hljs-attr">token</span>: string }
    <span class="hljs-attr">success</span>: boolean,
    message?: any
}
<span class="hljs-keyword">export</span> interface LoginResult {
    <span class="hljs-attr">data</span>: { <span class="hljs-attr">token</span>: string }
    <span class="hljs-attr">success</span>: boolean,
    message?: any
}
</code></pre>
<h3 id="t847.8 Register\index.tsx">7.8 Register\index.tsx <a href="#t847.8 Register\index.tsx"> # </a></h3>
<p>src\routes\Register\index.tsx</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;
<span class="hljs-keyword">import</span> { connect } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-redux&quot;</span>;
<span class="hljs-keyword">import</span> actions <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../../store/actions/profile&quot;</span>;
<span class="hljs-keyword">import</span> { RouteComponentProps, Link } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-router-dom&quot;</span>;
<span class="hljs-keyword">import</span> NavHeader <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../../components/NavHeader&quot;</span>;
<span class="hljs-keyword">import</span> { Form, Input, Button, message } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;antd&quot;</span>;
<span class="hljs-keyword">import</span> { CombinedState } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../../store/reducers&quot;</span>;
<span class="hljs-keyword">import</span> { ProfileState } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../../store/reducers/profile&quot;</span>;
<span class="hljs-keyword">import</span> { UserAddOutlined, LockOutlined, MailOutlined } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@ant-design/icons&quot;</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./index.less&quot;</span>;
type StateProps = ReturnType&lt;<span class="hljs-keyword">typeof</span> mapStateToProps&gt;;
type DispatchProps = <span class="hljs-keyword">typeof</span> actions;
interface Params {}
type Props = RouteComponentProps&lt;Params&gt; &amp; StateProps &amp; DispatchProps;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Register</span>(<span class="hljs-params">props: Props</span>) </span>{
  <span class="hljs-keyword">const</span> onFinish = <span class="hljs-function">(<span class="hljs-params">values: any</span>) =&gt;</span> {
    props.register(values);
  };
  <span class="hljs-keyword">const</span> onFinishFailed = <span class="hljs-function">(<span class="hljs-params">errorInfo: any</span>) =&gt;</span> {
    message.error(<span class="hljs-string">&quot;&#x8868;&#x5355;&#x9A8C;&#x8BC1;&#x5931;&#x8D25;! &quot;</span> + errorInfo);
  };
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">NavHeader</span> <span class="hljs-attr">history</span>=<span class="hljs-string">{props.history}</span>&gt;</span>&#x7528;&#x6237;&#x6CE8;&#x518C;<span class="hljs-tag">&lt;/<span class="hljs-name">NavHeader</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Form</span>
        <span class="hljs-attr">onFinish</span>=<span class="hljs-string">{onFinish}</span>
        <span class="hljs-attr">onFinishFailed</span>=<span class="hljs-string">{onFinishFailed}</span>
        <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;login-form&quot;</span>
      &gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Form.Item</span>
          <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;&#x7528;&#x6237;&#x540D;&quot;</span>
          <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span>
          <span class="hljs-attr">rules</span>=<span class="hljs-string">{[{</span> <span class="hljs-attr">required:</span> <span class="hljs-attr">true</span>, <span class="hljs-attr">message:</span> &quot;&#x8BF7;&#x8F93;&#x5165;&#x4F60;&#x7684;&#x7528;&#x6237;&#x540D;!&quot; }]}
        &gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Input</span> <span class="hljs-attr">prefix</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">UserAddOutlined</span> /&gt;</span>} placeholder=&quot;&#x7528;&#x6237;&#x540D;&quot; /&gt;
        <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Item</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Form.Item</span>
          <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;&#x5BC6;&#x7801;&quot;</span>
          <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span>
          <span class="hljs-attr">rules</span>=<span class="hljs-string">{[{</span> <span class="hljs-attr">required:</span> <span class="hljs-attr">true</span>, <span class="hljs-attr">message:</span> &quot;&#x8BF7;&#x8F93;&#x5165;&#x4F60;&#x7684;&#x5BC6;&#x7801;!&quot; }]}
        &gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Input</span> <span class="hljs-attr">prefix</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">LockOutlined</span> /&gt;</span>} type=&quot;password&quot; placeholder=&quot;&#x5BC6;&#x7801;&quot; /&gt;
        <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Item</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Form.Item</span>
          <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;&#x786E;&#x8BA4;&#x5BC6;&#x7801;&quot;</span>
          <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;confirmPassword&quot;</span>
          <span class="hljs-attr">rules</span>=<span class="hljs-string">{[{</span> <span class="hljs-attr">required:</span> <span class="hljs-attr">true</span>, <span class="hljs-attr">message:</span> &quot;&#x8BF7;&#x8F93;&#x5165;&#x4F60;&#x7684;&#x786E;&#x8BA4;&#x5BC6;&#x7801;!&quot; }]}
        &gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Input</span>
            <span class="hljs-attr">prefix</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">LockOutlined</span> /&gt;</span>}
            type=&quot;password&quot;
            placeholder=&quot;&#x786E;&#x8BA4;&#x5BC6;&#x7801;&quot;
          /&gt;
        <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Item</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Form.Item</span>
          <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;&#x90AE;&#x7BB1;&quot;</span>
          <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;email&quot;</span>
          <span class="hljs-attr">rules</span>=<span class="hljs-string">{[{</span> <span class="hljs-attr">required:</span> <span class="hljs-attr">true</span>, <span class="hljs-attr">message:</span> &quot;&#x8BF7;&#x8F93;&#x5165;&#x4F60;&#x7684;&#x90AE;&#x7BB1;!&quot; }]}
        &gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Input</span> <span class="hljs-attr">prefix</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">MailOutlined</span> /&gt;</span>} type=&quot;email&quot; placeholder=&quot;&#x90AE;&#x7BB1;&quot; /&gt;
        <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Item</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Form.Item</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;primary&quot;</span>
            <span class="hljs-attr">htmlType</span>=<span class="hljs-string">&quot;submit&quot;</span>
            <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;login-form-button&quot;</span>
          &gt;</span>
            &#x6CE8;&#x518C;
          <span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
          &#x6216;&#x8005; <span class="hljs-tag">&lt;<span class="hljs-name">Link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">&quot;/login&quot;</span>&gt;</span>&#x7ACB;&#x523B;&#x767B;&#x5F55;!<span class="hljs-tag">&lt;/<span class="hljs-name">Link</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Item</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Form</span>&gt;</span>
    <span class="hljs-tag">&lt;/&gt;</span></span>
  );
}

<span class="hljs-keyword">let</span> mapStateToProps = (state: CombinedState): <span class="hljs-function"><span class="hljs-params">ProfileState</span> =&gt;</span> state.profile;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> connect(mapStateToProps, actions)(Register);
</code></pre>
<p>routes\Register\index.less</p>
<pre><code class="lang-less"><span class="hljs-selector-class">.login-form</span> {
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
}
</code></pre>
<h3 id="t857.9 Login\index.tsx">7.9 Login\index.tsx <a href="#t857.9 Login\index.tsx"> # </a></h3>
<p>src\routes\Login\index.tsx</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> React <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;
<span class="hljs-keyword">import</span> { connect } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-redux&quot;</span>;
<span class="hljs-keyword">import</span> actions <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/store/actions/profile&quot;</span>;
<span class="hljs-keyword">import</span> { Link, RouteComponentProps } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-router-dom&quot;</span>;
<span class="hljs-keyword">import</span> NavHeader <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/components/NavHeader&quot;</span>;
<span class="hljs-keyword">import</span> { Form, Input, Button, message } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;antd&quot;</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./index.less&quot;</span>;
<span class="hljs-keyword">import</span> { CombinedState } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/store/reducers&quot;</span>;
<span class="hljs-keyword">import</span> { ProfileState } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/store/reducers/profile&quot;</span>;
<span class="hljs-keyword">import</span> { UserAddOutlined, LockOutlined, MailOutlined } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@ant-design/icons&quot;</span>;
type StateProps = ReturnType&lt;<span class="hljs-keyword">typeof</span> mapStateToProps&gt;;
type DispatchProps = <span class="hljs-keyword">typeof</span> actions;
interface Params {}
type Props = RouteComponentProps&lt;Params&gt; &amp; StateProps &amp; DispatchProps;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Register</span>(<span class="hljs-params">props: Props</span>) </span>{
  <span class="hljs-keyword">const</span> onFinish = <span class="hljs-function">(<span class="hljs-params">values: any</span>) =&gt;</span> {
    props.login(values);
  };
  <span class="hljs-keyword">const</span> onFinishFailed = <span class="hljs-function">(<span class="hljs-params">errorInfo: any</span>) =&gt;</span> {
    message.error(<span class="hljs-string">&quot;&#x8868;&#x5355;&#x9A8C;&#x8BC1;&#x5931;&#x8D25;! &quot;</span> + errorInfo);
  };
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">NavHeader</span> <span class="hljs-attr">history</span>=<span class="hljs-string">{props.history}</span>&gt;</span>&#x7528;&#x6237;&#x767B;&#x5F55;<span class="hljs-tag">&lt;/<span class="hljs-name">NavHeader</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Form</span>
        <span class="hljs-attr">onFinish</span>=<span class="hljs-string">{onFinish}</span>
        <span class="hljs-attr">onFinishFailed</span>=<span class="hljs-string">{onFinishFailed}</span>
        <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;login-form&quot;</span>
      &gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Form.Item</span>
          <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;&#x7528;&#x6237;&#x540D;&quot;</span>
          <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;username&quot;</span>
          <span class="hljs-attr">rules</span>=<span class="hljs-string">{[{</span> <span class="hljs-attr">required:</span> <span class="hljs-attr">true</span>, <span class="hljs-attr">message:</span> &quot;&#x8BF7;&#x8F93;&#x5165;&#x4F60;&#x7684;&#x7528;&#x6237;&#x540D;!&quot; }]}
        &gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Input</span> <span class="hljs-attr">prefix</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">UserAddOutlined</span> /&gt;</span>} placeholder=&quot;&#x7528;&#x6237;&#x540D;&quot; /&gt;
        <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Item</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Form.Item</span>
          <span class="hljs-attr">label</span>=<span class="hljs-string">&quot;&#x5BC6;&#x7801;&quot;</span>
          <span class="hljs-attr">name</span>=<span class="hljs-string">&quot;password&quot;</span>
          <span class="hljs-attr">rules</span>=<span class="hljs-string">{[{</span> <span class="hljs-attr">required:</span> <span class="hljs-attr">true</span>, <span class="hljs-attr">message:</span> &quot;&#x8BF7;&#x8F93;&#x5165;&#x4F60;&#x7684;&#x5BC6;&#x7801;!&quot; }]}
        &gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Input</span> <span class="hljs-attr">prefix</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">LockOutlined</span> /&gt;</span>} type=&quot;password&quot; placeholder=&quot;&#x5BC6;&#x7801;&quot; /&gt;
        <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Item</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Form.Item</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;primary&quot;</span>
            <span class="hljs-attr">htmlType</span>=<span class="hljs-string">&quot;submit&quot;</span>
            <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;login-form-button&quot;</span>
          &gt;</span>
            &#x767B;&#x5F55;
          <span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
          &#x6216;&#x8005; <span class="hljs-tag">&lt;<span class="hljs-name">Link</span> <span class="hljs-attr">to</span>=<span class="hljs-string">&quot;/register&quot;</span>&gt;</span>&#x7ACB;&#x523B;&#x6CE8;&#x518C;!<span class="hljs-tag">&lt;/<span class="hljs-name">Link</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Form.Item</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Form</span>&gt;</span>
    <span class="hljs-tag">&lt;/&gt;</span></span>
  );
}

<span class="hljs-keyword">const</span> mapStateToProps = (state: CombinedState): <span class="hljs-function"><span class="hljs-params">ProfileState</span> =&gt;</span> state.profile;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> connect(mapStateToProps, actions)(Register);
</code></pre>
<h3 id="t867.10 Login\index.less">7.10 Login\index.less <a href="#t867.10 Login\index.less"> # </a></h3>
<p>src\routes\Login\index.less</p>
<pre><code class="lang-less"><span class="hljs-selector-class">.login-form</span> {
  <span class="hljs-attribute">padding</span>: <span class="hljs-number">0.2rem</span>;
}
</code></pre>
<h2 id="t87&#x7B2C;8&#x7AE0; &#x4E0A;&#x4F20;&#x5934;&#x50CF;">&#x7B2C;8&#x7AE0; &#x4E0A;&#x4F20;&#x5934;&#x50CF; <a href="#t87&#x7B2C;8&#x7AE0; &#x4E0A;&#x4F20;&#x5934;&#x50CF;"> # </a></h2>
<ul>
<li>&#x672C;&#x7AE0;&#x8282;&#x6211;&#x4EEC;&#x5B66;&#x4E60;&#x5982;&#x4F55;&#x5411;&#x670D;&#x52A1;&#x5668;&#x7AEF;&#x4E0A;&#x4F20;&#x5934;&#x50CF;</li>
<li>&#x672C;&#x7AE0;&#x5B66;&#x4E60;&#x5982;&#x4E0B;&#x5185;&#x5BB9;<ul>
<li>&#x5982;&#x4F55;&#x4F7F;&#x7528; antdesign &#x7684;&#x56FE;&#x7247;&#x4E0A;&#x4F20;&#x7EC4;&#x4EF6;<h3 id="t888.1 &#x53C2;&#x8003;">8.1 &#x53C2;&#x8003; <a href="#t888.1 &#x53C2;&#x8003;"> # </a></h3>
<h4 id="t898.1.1 &#x672C;&#x7AE0;&#x76EE;&#x5F55;">8.1.1 &#x672C;&#x7AE0;&#x76EE;&#x5F55; <a href="#t898.1.1 &#x672C;&#x7AE0;&#x76EE;&#x5F55;"> # </a></h4>
<pre><code class="lang-js">.
&#x251C;&#x2500;&#x2500; package.json
&#x251C;&#x2500;&#x2500; public
&#x2502;   &#x2514;&#x2500;&#x2500; index.html
&#x251C;&#x2500;&#x2500; src
&#x2502;   &#x251C;&#x2500;&#x2500; api
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; profile.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; assets
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; css
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; common.less
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; images
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; logo.png
&#x2502;   &#x251C;&#x2500;&#x2500; components
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; NavHeader
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; Tabs
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; routes
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Home
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; components
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; HomeHeader
&#x2502;   &#x2502;   &#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Login
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Mine
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Profile
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; Register
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; store
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; actions
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; home.tsx
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; profile.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; action-types.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; history.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; reducers
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; home.tsx
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; mine.tsx
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; profile.tsx
&#x2502;   &#x2514;&#x2500;&#x2500; typings
&#x2502;       &#x251C;&#x2500;&#x2500; images.d.ts
&#x2502;       &#x251C;&#x2500;&#x2500; login-types.tsx
&#x2502;       &#x2514;&#x2500;&#x2500; user.tsx
&#x251C;&#x2500;&#x2500; tsconfig.json
&#x251C;&#x2500;&#x2500; webpack.config.js
</code></pre>
</li>
</ul>
</li>
</ul>
<h4 id="t908.1.2 &#x672C;&#x7AE0;&#x6548;&#x679C;">8.1.2 &#x672C;&#x7AE0;&#x6548;&#x679C; <a href="#t908.1.2 &#x672C;&#x7AE0;&#x6548;&#x679C;"> # </a></h4>
<p><img src="http://img.zhufengpeixun.cn/uploadavatar.gif" alt="uploadavatar.gif"></p>
<h3 id="t918.2 Profile\index.tsx">8.2 Profile\index.tsx <a href="#t918.2 Profile\index.tsx"> # </a></h3>
<p>src\routes\Profile\index.tsx</p>
<pre><code class="lang-diff"><span class="hljs-addition">+import React, { PropsWithChildren, useEffect, useState } from &quot;react&quot;;</span>
import { connect } from &quot;react-redux&quot;;
import { CombinedState } from &quot;../../store/reducers&quot;;
import { ProfileState } from &quot;../../store/reducers/profile&quot;;
import actions from &quot;../../store/actions/profile&quot;;
import LOGIN_TYPES from &quot;../../typings/login-types&quot;;
import { RouteComponentProps } from &quot;react-router&quot;;
<span class="hljs-addition">+import { Descriptions, Button, Alert, message, Upload } from &quot;antd&quot;;</span>
import NavHeader from &quot;../../components/NavHeader&quot;;
import { AxiosError } from &quot;axios&quot;;
import &quot;./index.less&quot;;
<span class="hljs-addition">+import { LoadingOutlined, UploadOutlined } from &quot;@ant-design/icons&quot;;</span>
//&#x5F53;&#x524D;&#x7684;&#x7EC4;&#x4EF6;&#x6709;&#x4E09;&#x4E2A;&#x5C5E;&#x6027;&#x6765;&#x6E90;
//1.mapStateToProps&#x7684;&#x8FD4;&#x56DE;&#x503C; 2.actions&#x5BF9;&#x8C61;&#x7C7B;&#x578B; 3. &#x6765;&#x81EA;&#x8DEF;&#x7531; 4.&#x7528;&#x6237;&#x4F20;&#x5165;&#x8FDB;&#x6765;&#x7684;&#x5176;&#x5B83;&#x5C5E;&#x6027;
type StateProps = ReturnType&lt;typeof mapStateToProps&gt;;
type DispatchProps = typeof actions;
interface Params {}
type RouteProps = RouteComponentProps&lt;Params&gt;;
type Props = PropsWithChildren&lt;StateProps &amp; DispatchProps &amp; RouteProps&gt;;
<span class="hljs-addition">+const mapStateToProps = (initialState: CombinedState): ProfileState =&gt;initialState.profile;</span>
function Profile(props: Props) {
<span class="hljs-addition">+  let [loading, setLoading] = useState(false);</span>
  //&#x7EC4;&#x4EF6;&#x52A0;&#x8F7D;&#x540E;&#x76F4;&#x63A5; &#x53D1;&#x8D77;&#x9A8C;&#x8BC1;&#x8BF7;&#x6C42;,&#x67E5;&#x770B;&#x6B64;&#x7528;&#x6237;&#x662F;&#x5426;&#x5DF2;&#x7ECF;&#x767B;&#x5F55;&#x8FC7;&#x4E86;,&#x5982;&#x679C;&#x6CA1;&#x6709;&#x767B;&#x5F55;&#x5219;&#x63D0;&#x793A;&#x9519;&#x8BEF;
  useEffect(() =&gt; {
    props.validate().catch((error: AxiosError) =&gt; message.error(error.message));
  }, []);
<span class="hljs-addition">+  const handleChange = (info: any) =&gt; {</span>
<span class="hljs-addition">+    if (info.file.status === &quot;uploading&quot;) {</span>
<span class="hljs-addition">+      setLoading(true);</span>
<span class="hljs-addition">+    } else if (info.file.status === &quot;done&quot;) {</span>
<span class="hljs-addition">+      let { success, data, message } = info.file.response;</span>
<span class="hljs-addition">+      if (success) {</span>
<span class="hljs-addition">+        setLoading(false);</span>
<span class="hljs-addition">+        props.changeAvatar(data);</span>
<span class="hljs-addition">+      } else {</span>
<span class="hljs-addition">+        message.error(message);</span>
<span class="hljs-addition">+      }</span>
<span class="hljs-addition">+    }</span>
<span class="hljs-addition">+  };</span>
  let content; //&#x91CC;&#x5B58;&#x653E;&#x7740;&#x8981;&#x6E32;&#x67D3;&#x7684;&#x5185;&#x5BB9;
  if (props.loginState == LOGIN_TYPES.UN_VALIDATE) {
    //&#x5982;&#x679C;&#x672A;&#x9A8C;&#x8BC1;&#x5219;&#x5185;&#x5BB9;&#x4E3A;null
    content = null;
  } else if (props.loginState == LOGIN_TYPES.LOGINED) {
<span class="hljs-addition">+    const uploadButton = (</span>
<span class="hljs-addition">+      &lt;div&gt;</span>
<span class="hljs-addition">+        {loading ? &lt;LoadingOutlined /&gt; : &lt;UploadOutlined /&gt;}</span>
<span class="hljs-addition">+        &lt;div className=&quot;ant-upload-text&quot;&gt;&#x4E0A;&#x4F20;&lt;/div&gt;</span>
<span class="hljs-addition">+      &lt;/div&gt;</span>
<span class="hljs-addition">+    );</span>
    //&#x5982;&#x679C;&#x5DF2;&#x7ECF;&#x767B;&#x5F55;&#x663E;&#x793A;&#x7528;&#x6237;&#x4FE1;&#x606F;
    content = (
      &lt;div className=&quot;user-info&quot;&gt;
        &lt;Descriptions title=&quot;&#x5F53;&#x524D;&#x767B;&#x5F55;&#x7528;&#x6237;&quot;&gt;
          &lt;Descriptions.Item label=&quot;&#x7528;&#x6237;&#x540D;&quot;&gt;
            {props.user.username}
          &lt;/Descriptions.Item&gt;
          &lt;Descriptions.Item label=&quot;&#x90AE;&#x7BB1;&quot;&gt;{props.user.email}&lt;/Descriptions.Item&gt;
<span class="hljs-addition">+          &lt;Descriptions.Item label=&quot;&#x5934;&#x50CF;&quot;&gt;</span>
<span class="hljs-addition">+            &lt;Upload</span>
<span class="hljs-addition">+              name=&quot;avatar&quot;</span>
<span class="hljs-addition">+              listType=&quot;picture-card&quot;</span>
<span class="hljs-addition">+              className=&quot;avatar-uploader&quot;</span>
<span class="hljs-addition">+              showUploadList={false}</span>
<span class="hljs-addition">+              action=&quot;http://localhost:8000/user/uploadAvatar&quot;</span>
<span class="hljs-addition">+              beforeUpload={beforeUpload}</span>
<span class="hljs-addition">+              data={{ userId: props.user.id }}</span>
<span class="hljs-addition">+              onChange={handleChange}</span>
<span class="hljs-addition">+            &gt;</span>
<span class="hljs-addition">+              {props.user.avatar ? (</span>
<span class="hljs-addition">+                &lt;img</span>
<span class="hljs-addition">+                  src={props.user.avatar}</span>
<span class="hljs-addition">+                  alt=&quot;avatar&quot;</span>
<span class="hljs-addition">+                  style={{ width: &quot;100%&quot; }}</span>
<span class="hljs-addition">+                /&gt;</span>
<span class="hljs-addition">+              ) : (</span>
<span class="hljs-addition">+                uploadButton</span>
<span class="hljs-addition">+              )}</span>
<span class="hljs-addition">+            &lt;/Upload&gt;</span>
<span class="hljs-addition">+          &lt;/Descriptions.Item&gt;</span>
        &lt;/Descriptions&gt;
        &lt;Button
          type={&quot;primary&quot;}
          onClick={async () =&gt; {
            await props.logout();
            props.history.push(&quot;/login&quot;);
          }}
        &gt;
          &#x9000;&#x51FA;&#x767B;&#x5F55;
        &lt;/Button&gt;
      &lt;/div&gt;
    );
  } else {
    //&#x5982;&#x679C;&#x6CA1;&#x6709;&#x767B;&#x5F55;,&#x5219;&#x663E;&#x793A;&#x6CE8;&#x518C;&#x548C;&#x767B;&#x5F55;&#x6309;&#x94AE;
    content = (
      &lt;&gt;
        &lt;Alert
          type=&quot;warning&quot;
          message=&quot;&#x5F53;&#x524D;&#x672A;&#x767B;&#x5F55;&quot;
          description=&quot;&#x4EB2;&#x7231;&#x7684;&#x7528;&#x6237;&#x4F60;&#x597D;&#xFF0C;&#x4F60;&#x5F53;&#x524D;&#x5C1A;&#x672A;&#x767B;&#x5F55;&#xFF0C;&#x8BF7;&#x4F60;&#x9009;&#x62E9;&#x6CE8;&#x518C;&#x6216;&#x8005;&#x767B;&#x5F55;&quot;
        /&gt;
        &lt;div style={{ textAlign: &quot;center&quot;, padding: &quot;50px&quot; }}&gt;
          &lt;Button type=&quot;dashed&quot; onClick={() =&gt; props.history.push(&quot;/login&quot;)}&gt;
            &#x767B;&#x5F55;
          &lt;/Button&gt;
          &lt;Button
            type=&quot;dashed&quot;
            style={{ marginLeft: &quot;50px&quot; }}
            onClick={() =&gt; props.history.push(&quot;/register&quot;)}
          &gt;
            &#x6CE8;&#x518C;
          &lt;/Button&gt;
        &lt;/div&gt;
      &lt;/&gt;
    );
  }
  return (
    &lt;section&gt;
      &lt;NavHeader history={props.history}&gt;&#x4E2A;&#x4EBA;&#x4E2D;&#x5FC3;&lt;/NavHeader&gt;
      {content}
    &lt;/section&gt;
  );
}

<span class="hljs-addition">+export default connect(mapStateToProps, actions)(Profile);</span>
<span class="hljs-addition">+function beforeUpload(file: any) {</span>
<span class="hljs-addition">+  const isJpgOrPng = file.type === &quot;image/jpeg&quot; || file.type === &quot;image/png&quot;;</span>
<span class="hljs-addition">+  if (!isJpgOrPng) {</span>
<span class="hljs-addition">+    message.error(&quot;&#x4F60;&#x53EA;&#x80FD;&#x4E0A;&#x4F20;JPG/PNG &#x6587;&#x4EF6;!&quot;);</span>
<span class="hljs-addition">+  }</span>
<span class="hljs-addition">+  const isLessThan2M = file.size / 1024 / 1024 &lt; 2;</span>
<span class="hljs-addition">+  if (!isLessThan2M) {</span>
<span class="hljs-addition">+    message.error(&quot;&#x56FE;&#x7247;&#x5FC5;&#x987B;&#x5C0F;&#x4E8E;2MB!&quot;);</span>
<span class="hljs-addition">+  }</span>
<span class="hljs-addition">+  return isJpgOrPng &amp;&amp; isLessThan2M;</span>
<span class="hljs-addition">+}</span>
</code></pre>
<h3 id="t928.3 action-types.tsx">8.3 action-types.tsx <a href="#t928.3 action-types.tsx"> # </a></h3>
<p>src\store\action-types.tsx</p>
<pre><code class="lang-diff">export const ADD = &quot;ADD&quot;;
//&#x8BBE;&#x7F6E;&#x5F53;&#x524D;&#x5206;&#x7C7B;&#x7684;&#x540D;&#x79F0;
export const SET_CURRENT_CATEGORY = &quot;SET_CURRENT_CATEGORY&quot;;
//&#x53D1;&#x8D77;&#x9A8C;&#x8BC1;&#x7528;&#x6237;&#x662F;&#x5426;&#x767B;&#x5F55;&#x7684;&#x8BF7;&#x6C42;
export const VALIDATE = &quot;VALIDATE&quot;;

export const LOGOUT = &quot;LOGOUT&quot;;
<span class="hljs-addition">+//&#x4E0A;&#x4F20;&#x5934;&#x50CF;</span>
<span class="hljs-addition">+export const CHANGE_AVATAR = &quot;CHANGE_AVATAR&quot;;</span>

</code></pre>
<h3 id="t938.4 reducers\profile.tsx">8.4 reducers\profile.tsx <a href="#t938.4 reducers\profile.tsx"> # </a></h3>
<p>src\store\reducers\profile.tsx</p>
<pre><code class="lang-diff">import { AnyAction } from &quot;redux&quot;;
import * as TYPES from &quot;../action-types&quot;;
import LOGIN_TYPES from &quot;../../typings/login-types&quot;;
export interface ProfileState {
  loginState: LOGIN_TYPES; //&#x5F53;&#x524D;&#x7528;&#x6237;&#x7684;&#x767B;&#x5F55;&#x72B6;&#x6001;
  user: any; //&#x5F53;&#x524D;&#x5DF2;&#x7ECF;&#x767B;&#x5F55;&#x7684;&#x7528;&#x6237;&#x4FE1;&#x606F;
  error: string | null; //&#x9519;&#x8BEF;&#x4FE1;&#x606F;
}
let initialState: ProfileState = {
  //&#x521D;&#x59CB;&#x72B6;&#x6001;
  loginState: LOGIN_TYPES.UN_VALIDATE, //&#x5F53;&#x524D;&#x7528;&#x6237;&#x7684;&#x767B;&#x5F55;&#x72B6;&#x6001;
  user: null, //&#x5F53;&#x524D;&#x5DF2;&#x7ECF;&#x767B;&#x5F55;&#x7684;&#x7528;&#x6237;&#x4FE1;&#x606F;
  error: null, //&#x9519;&#x8BEF;&#x4FE1;&#x606F;
};
export default function (
  state: ProfileState = initialState,
  action: AnyAction
): ProfileState {
  switch (action.type) {
    case TYPES.VALIDATE:
      if (action.payload.success) {
        //&#x5982;&#x679C;&#x6B64;&#x7528;&#x6237;&#x5DF2;&#x7ECF;&#x767B;&#x5F55;&#x4E86;
        return {
          ...state,
          loginState: LOGIN_TYPES.LOGINED,
          user: action.payload.data, //&#x8BBE;&#x7F6E;&#x7528;&#x6237;&#x540D;
          error: null, //&#x6CA1;&#x6709;&#x9519;&#x8BEF;
        };
      } else {
        return {
          ...state,
          loginState: LOGIN_TYPES.UNLOGIN,
          user: null, //&#x7528;&#x6237;&#x540D;&#x4E3A;&#x7A7A;
          error: action.payload, //&#x9519;&#x8BEF;&#x5BF9;&#x8C61;&#x8D4B;&#x503C;
        };
      }
<span class="hljs-addition">+    case TYPES.LOGOUT:</span>
<span class="hljs-addition">+      return {</span>
<span class="hljs-addition">+        ...state,</span>
<span class="hljs-addition">+        loginState: LOGIN_TYPES.UN_VALIDATE,</span>
<span class="hljs-addition">+        user: null,</span>
<span class="hljs-addition">+        error: null,</span>
<span class="hljs-addition">+      };</span>
<span class="hljs-addition">+    case TYPES.CHANGE_AVATAR:</span>
<span class="hljs-addition">+      return { ...state, user: { ...state.user, avatar: action.payload } };</span>
    default:
      return state;
  }
}

</code></pre>
<h3 id="t948.5 actions\profile.tsx">8.5 actions\profile.tsx <a href="#t948.5 actions\profile.tsx"> # </a></h3>
<p>src\store\actions\profile.tsx</p>
<pre><code class="lang-diff">import { AnyAction } from &quot;redux&quot;;
import * as TYPES from &quot;../action-types&quot;;
import { validate, register, login } from &quot;@/api/profile&quot;;
import { push } from &quot;connected-react-router&quot;;
import {
  RegisterPayload,
  LoginPayload,
  RegisterResult,
  LoginResult,
} from &quot;@/typings/user&quot;;
import { message } from &quot;antd&quot;;
export default {
  //https://github.com/redux-utilities/redux-promise/blob/master/src/index.js
  validate(): AnyAction {
    //&#x53D1;&#x8D77;&#x5224;&#x65AD;&#x5F53;&#x524D;&#x7528;&#x6237;&#x662F;&#x5426;&#x767B;&#x5F55;&#x7684;&#x8BF7;&#x6C42;
    return {
      type: TYPES.VALIDATE,
      payload: validate(),
    };
  },
  register(values: RegisterPayload) {
    return function (dispatch: any) {
      (async function () {
        try {
          let result: RegisterResult = await register&lt;RegisterResult&gt;(values);
          if (result.success) {
            dispatch(push(&quot;/login&quot;));
          } else {
            message.error(result.message);
          }
        } catch (error) {
          message.error(&quot;&#x6CE8;&#x518C;&#x5931;&#x8D25;&quot;);
        }
      })();
    };
  },
  login(values: LoginPayload) {
    return function (dispatch: any) {
      (async function () {
        try {
          let result: LoginResult = await login&lt;LoginResult&gt;(values);
          if (result.success) {
            sessionStorage.setItem(&quot;access_token&quot;, result.data.token);
            dispatch(push(&quot;/profile&quot;));
          } else {
            message.error(result.message);
          }
        } catch (error) {
          message.error(&quot;&#x767B;&#x5F55;&#x5931;&#x8D25;&quot;);
        }
      })();
    };
  },
  logout() {
    return function (dispatch: any) {
      sessionStorage.removeItem(&quot;access_token&quot;);
      dispatch({ type: TYPES.LOGOUT });
      dispatch(push(&quot;/login&quot;));
    };
  },
<span class="hljs-addition">+  changeAvatar(avatar: string) {</span>
<span class="hljs-addition">+    return {</span>
<span class="hljs-addition">+      type: TYPES.CHANGE_AVATAR,</span>
<span class="hljs-addition">+      payload: avatar,</span>
<span class="hljs-addition">+    };</span>
<span class="hljs-addition">+  },</span>
};
</code></pre>
<h2 id="t95&#x7B2C;9&#x7AE0; &#x540E;&#x53F0;&#x8F6E;&#x64AD;&#x56FE;&#x8F6E;&#x64AD;&#x56FE;&#x63A5;&#x53E3;">&#x7B2C;9&#x7AE0; &#x540E;&#x53F0;&#x8F6E;&#x64AD;&#x56FE;&#x8F6E;&#x64AD;&#x56FE;&#x63A5;&#x53E3; <a href="#t95&#x7B2C;9&#x7AE0; &#x540E;&#x53F0;&#x8F6E;&#x64AD;&#x56FE;&#x8F6E;&#x64AD;&#x56FE;&#x63A5;&#x53E3;"> # </a></h2>
<ul>
<li>&#x672C;&#x7AE0;&#x662F;&#x7F16;&#x5199;&#x8F6E;&#x64AD;&#x56FE;&#x63A5;&#x53E3;</li>
</ul>
<h3 id="t969.1 &#x53C2;&#x8003;">9.1 &#x53C2;&#x8003; <a href="#t969.1 &#x53C2;&#x8003;"> # </a></h3>
<h4 id="t979.1.1 &#x672C;&#x7AE0;&#x76EE;&#x5F55;">9.1.1 &#x672C;&#x7AE0;&#x76EE;&#x5F55; <a href="#t979.1.1 &#x672C;&#x7AE0;&#x76EE;&#x5F55;"> # </a></h4>
<pre><code class="lang-js">.
&#x251C;&#x2500;&#x2500; package.json
&#x251C;&#x2500;&#x2500; src
&#x2502;   &#x251C;&#x2500;&#x2500; controller
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; slider.ts
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; user.ts
&#x2502;   &#x251C;&#x2500;&#x2500; exceptions
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; HttpException.ts
&#x2502;   &#x251C;&#x2500;&#x2500; index.ts
&#x2502;   &#x251C;&#x2500;&#x2500; middlewares
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; errorMiddleware.ts
&#x2502;   &#x251C;&#x2500;&#x2500; models
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.ts
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; slider.ts
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; user.ts
&#x2502;   &#x251C;&#x2500;&#x2500; public
&#x2502;   &#x251C;&#x2500;&#x2500; typings
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; express.d.ts
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; jwt.ts
&#x2502;   &#x2514;&#x2500;&#x2500; utils
&#x2502;       &#x2514;&#x2500;&#x2500; validator.ts
&#x2514;&#x2500;&#x2500; tsconfig.json
</code></pre>
<p>&#x672C;&#x7AE0;&#x6548;&#x679C;
<img src="http://img.zhufengpeixun.cn/getslidersapi.png" alt="getslidersapi"></p>
<h3 id="t989.2 src\index.ts">9.2 src\index.ts <a href="#t989.2 src\index.ts"> # </a></h3>
<p>src\index.ts</p>
<pre><code class="lang-diff">import express, { Express, Request, Response, NextFunction } from &apos;express&apos;;
import mongoose from &apos;mongoose&apos;;
import HttpException from &apos;./exceptions/HttpException&apos;;
import cors from &apos;cors&apos;;
import morgan from &apos;morgan&apos;;
import helmet from &apos;helmet&apos;;
import errorMiddleware from &apos;./middlewares/errorMiddleware&apos;;
import *  as userController from &apos;./controller/user&apos;;
<span class="hljs-addition">+import *  as sliderController from &apos;./controller/slider&apos;;</span>
import &quot;dotenv/config&quot;;
import multer from &apos;multer&apos;;
import path from &apos;path&apos;;
<span class="hljs-addition">+import { Slider } from &apos;./models&apos;;</span>
const storage = multer.diskStorage({
    destination: path.join(__dirname, &apos;public&apos;, &apos;uploads&apos;),
    filename(_req: Request, file: Express.Multer.File, cb) {
        cb(null, Date.now() + path.extname(file.originalname));
    }
});
const upload = multer({ storage });
const app: Express = express();
app.use(morgan(&quot;dev&quot;));
app.use(cors());
app.use(helmet());
app.use(express.static(path.resolve(__dirname, &apos;public&apos;)));
app.use(express.json());
app.use(express.urlencoded({ extended: false }));
app.get(&apos;/&apos;, (_req: Request, res: Response) =&gt; {
    res.json({ success: true, message: &apos;hello world&apos; });
});
app.get(&apos;/user/validate&apos;, userController.validate);
app.post(&apos;/user/register&apos;, userController.register);
app.post(&apos;/user/login&apos;, userController.login);
app.post(&apos;/user/uploadAvatar&apos;, upload.single(&apos;avatar&apos;), userController.uploadAvatar);
<span class="hljs-addition">+app.get(&apos;/slider/list&apos;, sliderController.list);</span>
app.use((_req: Request, _res: Response, next: NextFunction) =&gt; {
    const error: HttpException = new HttpException(404, &apos;Route not found&apos;);
    next(error);
});
app.use(errorMiddleware);
const PORT: number = (process.env.PORT &amp;&amp; parseInt(process.env.PORT)) || 8000;
(async function () {
    mongoose.set(&apos;useNewUrlParser&apos;, true);
    mongoose.set(&apos;useUnifiedTopology&apos;, true);
    await mongoose.connect(process.env.MONGODB_URL!);
<span class="hljs-addition">+    await createSliders();</span>
    app.listen(PORT, () =&gt; {
        console.log(`Running on http://localhost:${PORT}`);
    });
})();

<span class="hljs-addition">+async function createSliders() {</span>
<span class="hljs-addition">+    const sliders = await Slider.find();</span>
<span class="hljs-addition">+    if (sliders.length == 0) {</span>
<span class="hljs-addition">+        const sliders:any = [</span>
<span class="hljs-addition">+            { url: &apos;http://img.zhufengpeixun.cn/post_reactnative.png&apos; },</span>
<span class="hljs-addition">+            { url: &apos;http://img.zhufengpeixun.cn/post_react.png&apos; },</span>
<span class="hljs-addition">+            { url: &apos;http://img.zhufengpeixun.cn/post_vue.png&apos; },</span>
<span class="hljs-addition">+            { url: &apos;http://img.zhufengpeixun.cn/post_wechat.png&apos; },</span>
<span class="hljs-addition">+            { url: &apos;http://img.zhufengpeixun.cn/post_architect.jpg&apos; }</span>
<span class="hljs-addition">+        ];</span>
<span class="hljs-addition">+        Slider.create(sliders);</span>
<span class="hljs-addition">+    }</span>
<span class="hljs-addition">+}</span>
</code></pre>
<h3 id="t999.3 controller\slider.ts">9.3 controller\slider.ts <a href="#t999.3 controller\slider.ts"> # </a></h3>
<p>src\controller\slider.ts</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> { Request, Response } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;express&quot;</span>;
<span class="hljs-keyword">import</span> { ISliderDocument, Slider } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../models&quot;</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> list = <span class="hljs-keyword">async</span> (_req: Request, <span class="hljs-attr">res</span>: Response) =&gt; {
  <span class="hljs-keyword">let</span> sliders: ISliderDocument[] = <span class="hljs-keyword">await</span> Slider.find();
  res.json({ <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">data</span>: sliders });
};
</code></pre>
<h3 id="t1009.4 models\slider.ts">9.4 models\slider.ts <a href="#t1009.4 models\slider.ts"> # </a></h3>
<p>src\models\slider.ts</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> mongoose, { Schema, Document } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mongoose&quot;</span>;
<span class="hljs-keyword">export</span> interface ISliderDocument extends Document {
  <span class="hljs-attr">url</span>: string;
}
<span class="hljs-keyword">const</span> SliderSchema: Schema&lt;ISliderDocument&gt; = <span class="hljs-keyword">new</span> Schema(
  {
    <span class="hljs-attr">url</span>: <span class="hljs-built_in">String</span>,
  },
  { <span class="hljs-attr">timestamps</span>: <span class="hljs-literal">true</span> }
);

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> Slider =
  mongoose.model &lt; ISliderDocument &gt; (<span class="hljs-string">&quot;Slider&quot;</span>, SliderSchema);
</code></pre>
<h3 id="t1019.5 src\models\index.ts">9.5 src\models\index.ts <a href="#t1019.5 src\models\index.ts"> # </a></h3>
<p>src\models\index.ts</p>
<pre><code class="lang-diff">export * from &apos;./user&apos;;
<span class="hljs-addition">+export * from &apos;./slider&apos;;</span>
</code></pre>
<h2 id="t102&#x7B2C;10&#x7AE0; &#x524D;&#x53F0;&#x8F6E;&#x64AD;&#x56FE;">&#x7B2C;10&#x7AE0; &#x524D;&#x53F0;&#x8F6E;&#x64AD;&#x56FE; <a href="#t102&#x7B2C;10&#x7AE0; &#x524D;&#x53F0;&#x8F6E;&#x64AD;&#x56FE;"> # </a></h2>
<ul>
<li>&#x672C;&#x7AE0;&#x5B9E;&#x8DF5;&#x524D;&#x53F0;&#x8F6E;&#x64AD;&#x56FE;</li>
<li>&#x672C;&#x7AE0;&#x9700;&#x8981;&#x5B9E;&#x8DF5;&#x7684;&#x5185;&#x5BB9;<ul>
<li>&#x4F7F;&#x7528;<code>useRef</code>&#x53D6;&#x5F97; DOM &#x5143;&#x7D20;</li>
<li>&#x4F7F;&#x7528; <code>antdesign</code> &#x7684;&#x8F6E;&#x64AD;&#x56FE;&#x7EC4;&#x4EF6;</li>
</ul>
</li>
</ul>
<h3 id="t10310.1 &#x53C2;&#x8003;">10.1 &#x53C2;&#x8003; <a href="#t10310.1 &#x53C2;&#x8003;"> # </a></h3>
<h4 id="t10410.1.1 &#x672C;&#x7AE0;&#x76EE;&#x5F55;">10.1.1 &#x672C;&#x7AE0;&#x76EE;&#x5F55; <a href="#t10410.1.1 &#x672C;&#x7AE0;&#x76EE;&#x5F55;"> # </a></h4>
<pre><code class="lang-js">.
&#x251C;&#x2500;&#x2500; package.json
&#x251C;&#x2500;&#x2500; public
&#x2502;   &#x2514;&#x2500;&#x2500; index.html
&#x251C;&#x2500;&#x2500; README.md
&#x251C;&#x2500;&#x2500; src
&#x2502;   &#x251C;&#x2500;&#x2500; api
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; home.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; profile.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; assets
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; css
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; common.less
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; images
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; logo.png
&#x2502;   &#x251C;&#x2500;&#x2500; components
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; NavHeader
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; Tabs
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; routes
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Home
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; components
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; HomeHeader
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; HomeSliders
&#x2502;   &#x2502;   &#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Login
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Mine
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Profile
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; Register
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; store
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; actions
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; home.tsx
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; profile.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; action-types.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; history.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; reducers
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; home.tsx
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; mine.tsx
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; profile.tsx
&#x2502;   &#x2514;&#x2500;&#x2500; typings
&#x2502;       &#x251C;&#x2500;&#x2500; images.d.ts
&#x2502;       &#x251C;&#x2500;&#x2500; login-types.tsx
&#x2502;       &#x251C;&#x2500;&#x2500; slider.tsx
&#x2502;       &#x2514;&#x2500;&#x2500; user.tsx
&#x251C;&#x2500;&#x2500; tsconfig.json
&#x251C;&#x2500;&#x2500; webpack.config.js
</code></pre>
<h4 id="t10510.1.2 &#x672C;&#x7AE0;&#x6548;&#x679C;">10.1.2 &#x672C;&#x7AE0;&#x6548;&#x679C; <a href="#t10510.1.2 &#x672C;&#x7AE0;&#x6548;&#x679C;"> # </a></h4>
<p><img src="http://img.zhufengpeixun.cn/homesliders.gif" alt="homesliders"></p>
<h3 id="t10610.2 action-types.tsx">10.2 action-types.tsx <a href="#t10610.2 action-types.tsx"> # </a></h3>
<p>src\store\action-types.tsx</p>
<pre><code class="lang-diff">export const ADD = &quot;ADD&quot;;
//&#x8BBE;&#x7F6E;&#x5F53;&#x524D;&#x5206;&#x7C7B;&#x7684;&#x540D;&#x79F0;
export const SET_CURRENT_CATEGORY = &quot;SET_CURRENT_CATEGORY&quot;;
//&#x53D1;&#x8D77;&#x9A8C;&#x8BC1;&#x7528;&#x6237;&#x662F;&#x5426;&#x767B;&#x5F55;&#x7684;&#x8BF7;&#x6C42;
export const VALIDATE = &quot;VALIDATE&quot;;

export const LOGOUT = &quot;LOGOUT&quot;;
//&#x4E0A;&#x4F20;&#x5934;&#x50CF;
export const CHANGE_AVATAR = &quot;CHANGE_AVATAR&quot;;
<span class="hljs-addition">+export const GET_SLIDERS = &quot;GET_SLIDERS&quot;;</span>
</code></pre>
<h3 id="t10710.3 actions\home.tsx">10.3 actions\home.tsx <a href="#t10710.3 actions\home.tsx"> # </a></h3>
<p>src\store\actions\home.tsx</p>
<pre><code class="lang-diff">import * as TYPES from &quot;../action-types&quot;;
<span class="hljs-addition">+import { getSliders } from &quot;@/api/home&quot;;</span>
export default {
  setCurrentCategory(currentCategory: string) {
    return { type: TYPES.SET_CURRENT_CATEGORY, payload: currentCategory };
  },
<span class="hljs-addition">+  getSliders() {</span>
<span class="hljs-addition">+    return {</span>
<span class="hljs-addition">+      type: TYPES.GET_SLIDERS,</span>
<span class="hljs-addition">+      payload: getSliders(),</span>
<span class="hljs-addition">+    };</span>
<span class="hljs-addition">+  }</span>
};

</code></pre>
<h3 id="t10810.4 typings\slider.tsx">10.4 typings\slider.tsx <a href="#t10810.4 typings\slider.tsx"> # </a></h3>
<p>src\typings\slider.tsx</p>
<pre><code class="lang-js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> interface Slider {
  <span class="hljs-attr">url</span>: string;
}
</code></pre>
<h3 id="t10910.5 reducers\home.tsx">10.5 reducers\home.tsx <a href="#t10910.5 reducers\home.tsx"> # </a></h3>
<p>src\store\reducers\home.tsx</p>
<pre><code class="lang-diff">import { AnyAction } from &quot;redux&quot;;
import * as TYPES from &quot;../action-types&quot;;
<span class="hljs-addition">+import Slider from &quot;@/typings/slider&quot;;</span>
export interface HomeState {
  currentCategory: string;
<span class="hljs-addition">+  sliders: Slider[];</span>
}
let initialState: HomeState = {
  currentCategory: &quot;all&quot;, //&#x9ED8;&#x8BA4;&#x5F53;&#x524D;&#x7684;&#x5206;&#x7C7B;&#x662F;&#x663E;&#x793A;&#x5168;&#x90E8;&#x7C7B;&#x578B;&#x7684;&#x8BFE;&#x7A0B;
<span class="hljs-addition">+  sliders: [],</span>
};
export default function (
  state: HomeState = initialState,
  action: AnyAction
): HomeState {
  switch (action.type) {
    case TYPES.SET_CURRENT_CATEGORY: //&#x4FEE;&#x6539;&#x5F53;&#x524D;&#x5206;&#x7C7B;
      return { ...state, currentCategory: action.payload };
<span class="hljs-addition">+    case TYPES.GET_SLIDERS:</span>
<span class="hljs-addition">+      return { ...state, sliders: action.payload.data };</span>
    default:
      return state;
  }
}
</code></pre>
<h3 id="t11010.6 api\home.tsx">10.6 api\home.tsx <a href="#t11010.6 api\home.tsx"> # </a></h3>
<p>src\api\home.tsx</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> axios <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./index&quot;</span>;
<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getSliders</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> axios.get(<span class="hljs-string">&quot;/slider/list&quot;</span>);
}
</code></pre>
<h3 id="t11110.7 HomeSliders\index.tsx">10.7 HomeSliders\index.tsx <a href="#t11110.7 HomeSliders\index.tsx"> # </a></h3>
<p>src\routes\Home\components\HomeSliders\index.tsx</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> React, { PropsWithChildren, useRef, useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;
<span class="hljs-keyword">import</span> { Carousel } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;antd&quot;</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./index.less&quot;</span>;
<span class="hljs-keyword">import</span> Slider <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/typings/slider&quot;</span>;
type Props = PropsWithChildren&lt;{
  children?: any,
  sliders?: Slider[],
  getSliders?: any,
}&gt;;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">HomeSliders</span>(<span class="hljs-params">props: Props</span>) </span>{
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (props.sliders.length == <span class="hljs-number">0</span>) {
      props.getSliders();
    }
  }, []);
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Carousel</span> <span class="hljs-attr">effect</span>=<span class="hljs-string">&quot;scrollx&quot;</span> <span class="hljs-attr">autoplay</span>&gt;</span>
      {props.sliders.map((item: Slider, index: number) =&gt; (
        <span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">key</span>=<span class="hljs-string">{index}</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{item.url}</span> /&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
      ))}
    <span class="hljs-tag">&lt;/<span class="hljs-name">Carousel</span>&gt;</span></span>
  );
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> HomeSliders;
</code></pre>
<h3 id="t11210.8 HomeSliders\index.less">10.8 HomeSliders\index.less <a href="#t11210.8 HomeSliders\index.less"> # </a></h3>
<p>src\routes\Home\components\HomeSliders\index.less</p>
<pre><code class="lang-less"><span class="hljs-selector-class">.ant-carousel</span> <span class="hljs-selector-class">.slick-slide</span> {
  <span class="hljs-attribute">text-align</span>: center;
  <span class="hljs-attribute">height</span>: <span class="hljs-number">320px</span>;
  <span class="hljs-attribute">line-height</span>: <span class="hljs-number">320px</span>;
  <span class="hljs-attribute">background</span>: <span class="hljs-number">#364d79</span>;
  <span class="hljs-attribute">overflow</span>: hidden;
}

<span class="hljs-selector-class">.ant-carousel</span> <span class="hljs-selector-class">.slick-slide</span> {
  <span class="hljs-attribute">color</span>: <span class="hljs-number">#fff</span>;
  <span class="hljs-selector-tag">img</span> {
    <span class="hljs-attribute">width</span>: <span class="hljs-number">100%</span>;
    <span class="hljs-attribute">height</span>: <span class="hljs-number">320px</span>;
  }
}
</code></pre>
<h3 id="t11310.9 routes\Home\index.tsx">10.9 routes\Home\index.tsx <a href="#t11310.9 routes\Home\index.tsx"> # </a></h3>
<p>src\routes\Home\index.tsx</p>
<pre><code class="lang-diff">import React, { PropsWithChildren, useRef } from &quot;react&quot;;
import { connect } from &quot;react-redux&quot;;
import { RouteComponentProps } from &quot;react-router-dom&quot;;
import actions from &quot;@/store/actions/home&quot;;
import HomeHeader from &quot;./components/HomeHeader&quot;;
import { CombinedState } from &quot;@/store/reducers&quot;;
import { HomeState } from &quot;@/store/reducers/home&quot;;
<span class="hljs-addition">+import HomeSliders from &quot;./components/HomeSliders&quot;;</span>
import &quot;./index.less&quot;;
type StateProps = ReturnType&lt;typeof mapStateToProps&gt;;
type DispatchProps = typeof actions;
interface Params {}
type Props = PropsWithChildren&lt;
  RouteComponentProps&lt;Params&gt; &amp; StateProps &amp; DispatchProps
&gt;;
function Home(props: Props) {
<span class="hljs-addition">+  const homeContainerRef = useRef(null);</span>
  return (
    &lt;&gt;
      &lt;HomeHeader
        currentCategory={props.currentCategory}
        setCurrentCategory={props.setCurrentCategory}
      /&gt;
<span class="hljs-addition">+      &lt;div className=&quot;home-container&quot; ref={homeContainerRef}&gt;</span>
<span class="hljs-addition">+        &lt;HomeSliders sliders={props.sliders} getSliders={props.getSliders} /&gt;</span>
<span class="hljs-addition">+      &lt;/div&gt;</span>
    &lt;/&gt;
  );
}
let mapStateToProps = (state: CombinedState): HomeState =&gt; state.home;
export default connect(mapStateToProps, actions)(Home);
</code></pre>
<h2 id="t114&#x7B2C;11&#x7AE0; &#x8BFE;&#x7A0B;&#x7BA1;&#x7406;&#x540E;&#x7AEF;&#x63A5;&#x53E3;">&#x7B2C;11&#x7AE0; &#x8BFE;&#x7A0B;&#x7BA1;&#x7406;&#x540E;&#x7AEF;&#x63A5;&#x53E3; <a href="#t114&#x7B2C;11&#x7AE0; &#x8BFE;&#x7A0B;&#x7BA1;&#x7406;&#x540E;&#x7AEF;&#x63A5;&#x53E3;"> # </a></h2>
<ul>
<li>&#x672C;&#x7AE0;&#x4E3B;&#x8981;&#x7F16;&#x5199;&#x8BFE;&#x7A0B;&#x7BA1;&#x7406;&#x7684;&#x540E;&#x53F0;&#x63A5;&#x53E3;</li>
</ul>
<h3 id="t11511.1 &#x53C2;&#x8003;">11.1 &#x53C2;&#x8003; <a href="#t11511.1 &#x53C2;&#x8003;"> # </a></h3>
<h4 id="t11611.1.1 &#x672C;&#x7AE0;&#x76EE;&#x5F55;">11.1.1 &#x672C;&#x7AE0;&#x76EE;&#x5F55; <a href="#t11611.1.1 &#x672C;&#x7AE0;&#x76EE;&#x5F55;"> # </a></h4>
<pre><code class="lang-js">.
&#x251C;&#x2500;&#x2500; package.json
&#x251C;&#x2500;&#x2500; src
&#x2502; &#x251C;&#x2500;&#x2500; controller
&#x2502; &#x2502; &#x251C;&#x2500;&#x2500; lesson.ts
&#x2502; &#x2502; &#x251C;&#x2500;&#x2500; slider.ts
&#x2502; &#x2502; &#x2514;&#x2500;&#x2500; user.ts
&#x2502; &#x251C;&#x2500;&#x2500; exceptions
&#x2502; &#x2502; &#x2514;&#x2500;&#x2500; HttpException.ts
&#x2502; &#x251C;&#x2500;&#x2500; index.ts
&#x2502; &#x251C;&#x2500;&#x2500; middlewares
&#x2502; &#x2502; &#x2514;&#x2500;&#x2500; errorMiddleware.ts
&#x2502; &#x251C;&#x2500;&#x2500; models
&#x2502; &#x2502; &#x251C;&#x2500;&#x2500; index.ts
&#x2502; &#x2502; &#x251C;&#x2500;&#x2500; lesson.ts
&#x2502; &#x2502; &#x251C;&#x2500;&#x2500; slider.ts
&#x2502; &#x2502; &#x2514;&#x2500;&#x2500; user.ts
&#x2502; &#x251C;&#x2500;&#x2500; public
&#x2502; &#x251C;&#x2500;&#x2500; typings
&#x2502; &#x2502; &#x251C;&#x2500;&#x2500; express.d.ts
&#x2502; &#x2502; &#x2514;&#x2500;&#x2500; jwt.ts
&#x2502; &#x2514;&#x2500;&#x2500; utils
&#x2502;     &#x2514;&#x2500;&#x2500; validator.ts
&#x2514;&#x2500;&#x2500; tsconfig.json
</code></pre>
<h4 id="t11711.1.2 &#x672C;&#x7AE0;&#x6548;&#x679C;">11.1.2 &#x672C;&#x7AE0;&#x6548;&#x679C; <a href="#t11711.1.2 &#x672C;&#x7AE0;&#x6548;&#x679C;"> # </a></h4>
<p><img src="http://img.zhufengpeixun.cn/lessonlistinterface.gif" alt="lessonlistinterface"></p>
<h3 id="t11811.2 src\index.ts">11.2 src\index.ts <a href="#t11811.2 src\index.ts"> # </a></h3>
<p>src\index.ts</p>
<pre><code class="lang-diff">import express, { Express, Request, Response, NextFunction } from &quot;express&quot;;
import mongoose from &quot;mongoose&quot;;
import HttpException from &quot;./exceptions/HttpException&quot;;
import cors from &quot;cors&quot;;
import morgan from &quot;morgan&quot;;
import helmet from &quot;helmet&quot;;
import errorMiddleware from &quot;./middlewares/errorMiddleware&quot;;
import * as userController from &quot;./controller/user&quot;;
import * as sliderController from &quot;./controller/slider&quot;;
<span class="hljs-addition">+import * as lessonController from &quot;./controller/lesson&quot;;</span>
import &quot;dotenv/config&quot;;
import multer from &quot;multer&quot;;
import path from &quot;path&quot;;
<span class="hljs-addition">+import { Slider, Lesson } from &quot;./models&quot;;</span>
const storage = multer.diskStorage({
  destination: path.join(__dirname, &quot;public&quot;, &quot;uploads&quot;),
  filename(_req: Request, file: Express.Multer.File, cb) {
    cb(null, Date.now() + path.extname(file.originalname));
  },
});
const upload = multer({ storage });
const app: Express = express();
app.use(morgan(&quot;dev&quot;));
app.use(cors());
app.use(helmet());
app.use(express.static(path.resolve(__dirname, &quot;public&quot;)));
app.use(express.json());
app.use(express.urlencoded({ extended: false }));
app.get(&quot;/&quot;, (_req: Request, res: Response) =&gt; {
  res.json({ success: true, message: &quot;hello world&quot; });
});
app.get(&quot;/user/validate&quot;, userController.validate);
app.post(&quot;/user/register&quot;, userController.register);
app.post(&quot;/user/login&quot;, userController.login);
app.post(
  &quot;/user/uploadAvatar&quot;,
  upload.single(&quot;avatar&quot;),
  userController.uploadAvatar
);
app.get(&quot;/slider/list&quot;, sliderController.list);
<span class="hljs-addition">+app.get(&quot;/lesson/list&quot;, lessonController.list);</span>
<span class="hljs-addition">+app.get(&quot;/lesson/:id&quot;, lessonController.get);</span>
app.use((_req: Request, _res: Response, next: NextFunction) =&gt; {
  const error: HttpException = new HttpException(404, &quot;Route not found&quot;);
  next(error);
});
app.use(errorMiddleware);
const PORT: number = (process.env.PORT &amp;&amp; parseInt(process.env.PORT)) || 8000;
(async function () {
  mongoose.set(&quot;useNewUrlParser&quot;, true);
  mongoose.set(&quot;useUnifiedTopology&quot;, true);
  await mongoose.connect(&quot;mongodb://localhost/zhufengketang&quot;);
  await createSliders();
<span class="hljs-addition">+  await createLessons();</span>
  app.listen(PORT, () =&gt; {
    console.log(`Running on http://localhost:${PORT}`);
  });
})();

async function createSliders() {
  const sliders = await Slider.find();
  if (sliders.length == 0) {
    const initSliders: any = [
      { url: &quot;http://img.zhufengpeixun.cn/post_reactnative.png&quot; },
      { url: &quot;http://img.zhufengpeixun.cn/post_react.png&quot; },
      { url: &quot;http://img.zhufengpeixun.cn/post_vue.png&quot; },
      { url: &quot;http://img.zhufengpeixun.cn/post_wechat.png&quot; },
      { url: &quot;http://img.zhufengpeixun.cn/post_architect.jpg&quot; },
    ];
    Slider.create(initSliders);
  }
}

<span class="hljs-addition">+async function createLessons() {</span>
<span class="hljs-addition">+  const lessons = await Lesson.find();</span>
<span class="hljs-addition">+  if (lessons.length == 0) {</span>
<span class="hljs-addition">+    const lessons: any = [</span>
<span class="hljs-addition">+      {</span>
<span class="hljs-addition">+        order: 1,</span>
<span class="hljs-addition">+        title: &quot;1.React&#x5168;&#x6808;&#x67B6;&#x6784;&quot;,</span>
<span class="hljs-addition">+        video: &quot;http://img.zhufengpeixun.cn/gee2.mp4&quot;,</span>
<span class="hljs-addition">+        poster: &quot;http://img.zhufengpeixun.cn/react_poster.jpg&quot;,</span>
<span class="hljs-addition">+        url: &quot;http://img.zhufengpeixun.cn/react_url.png&quot;,</span>
<span class="hljs-addition">+        price: &quot;&#xA5;100.00&#x5143;&quot;,</span>
<span class="hljs-addition">+        category: &quot;react&quot;,</span>
<span class="hljs-addition">+      },</span>
<span class="hljs-addition">+      {</span>
<span class="hljs-addition">+        order: 2,</span>
<span class="hljs-addition">+        title: &quot;2.React&#x5168;&#x6808;&#x67B6;&#x6784;&quot;,</span>
<span class="hljs-addition">+        video: &quot;http://img.zhufengpeixun.cn/gee2.mp4&quot;,</span>
<span class="hljs-addition">+        poster: &quot;http://img.zhufengpeixun.cn/react_poster.jpg&quot;,</span>
<span class="hljs-addition">+        url: &quot;http://img.zhufengpeixun.cn/react_url.png&quot;,</span>
<span class="hljs-addition">+        price: &quot;&#xA5;200.00&#x5143;&quot;,</span>
<span class="hljs-addition">+        category: &quot;react&quot;,</span>
<span class="hljs-addition">+      },</span>
<span class="hljs-addition">+      {</span>
<span class="hljs-addition">+        order: 3,</span>
<span class="hljs-addition">+        title: &quot;3.React&#x5168;&#x6808;&#x67B6;&#x6784;&quot;,</span>
<span class="hljs-addition">+        video: &quot;http://img.zhufengpeixun.cn/gee2.mp4&quot;,</span>
<span class="hljs-addition">+        poster: &quot;http://img.zhufengpeixun.cn/react_poster.jpg&quot;,</span>
<span class="hljs-addition">+        url: &quot;http://img.zhufengpeixun.cn/react_url.png&quot;,</span>
<span class="hljs-addition">+        price: &quot;&#xA5;300.00&#x5143;&quot;,</span>
<span class="hljs-addition">+        category: &quot;react&quot;,</span>
<span class="hljs-addition">+      },</span>
<span class="hljs-addition">+      {</span>
<span class="hljs-addition">+        order: 4,</span>
<span class="hljs-addition">+        title: &quot;4.React&#x5168;&#x6808;&#x67B6;&#x6784;&quot;,</span>
<span class="hljs-addition">+        video: &quot;http://img.zhufengpeixun.cn/gee2.mp4&quot;,</span>
<span class="hljs-addition">+        poster: &quot;http://img.zhufengpeixun.cn/react_poster.jpg&quot;,</span>
<span class="hljs-addition">+        url: &quot;http://img.zhufengpeixun.cn/react_url.png&quot;,</span>
<span class="hljs-addition">+        price: &quot;&#xA5;400.00&#x5143;&quot;,</span>
<span class="hljs-addition">+        category: &quot;react&quot;,</span>
<span class="hljs-addition">+      },</span>
<span class="hljs-addition">+      {</span>
<span class="hljs-addition">+        order: 5,</span>
<span class="hljs-addition">+        title: &quot;5.React&#x5168;&#x6808;&#x67B6;&#x6784;&quot;,</span>
<span class="hljs-addition">+        video: &quot;http://img.zhufengpeixun.cn/gee2.mp4&quot;,</span>
<span class="hljs-addition">+        poster: &quot;http://img.zhufengpeixun.cn/react_poster.jpg&quot;,</span>
<span class="hljs-addition">+        url: &quot;http://img.zhufengpeixun.cn/react_url.png&quot;,</span>
<span class="hljs-addition">+        price: &quot;&#xA5;500.00&#x5143;&quot;,</span>
<span class="hljs-addition">+        category: &quot;react&quot;,</span>
<span class="hljs-addition">+      },</span>
<span class="hljs-addition">+      {</span>
<span class="hljs-addition">+        order: 6,</span>
<span class="hljs-addition">+        title: &quot;6.Vue&#x4ECE;&#x5165;&#x95E8;&#x5230;&#x9879;&#x76EE;&#x5B9E;&#x6218;&quot;,</span>
<span class="hljs-addition">+        video: &quot;http://img.zhufengpeixun.cn/gee2.mp4&quot;,</span>
<span class="hljs-addition">+        poster: &quot;http://img.zhufengpeixun.cn/vue_poster.png&quot;,</span>
<span class="hljs-addition">+        url: &quot;http://img.zhufengpeixun.cn/vue_url.png&quot;,</span>
<span class="hljs-addition">+        price: &quot;&#xA5;100.00&#x5143;&quot;,</span>
<span class="hljs-addition">+        category: &quot;vue&quot;,</span>
<span class="hljs-addition">+      },</span>
<span class="hljs-addition">+      {</span>
<span class="hljs-addition">+        order: 7,</span>
<span class="hljs-addition">+        title: &quot;7.Vue&#x4ECE;&#x5165;&#x95E8;&#x5230;&#x9879;&#x76EE;&#x5B9E;&#x6218;&quot;,</span>
<span class="hljs-addition">+        video: &quot;http://img.zhufengpeixun.cn/gee2.mp4&quot;,</span>
<span class="hljs-addition">+        poster: &quot;http://img.zhufengpeixun.cn/vue_poster.png&quot;,</span>
<span class="hljs-addition">+        url: &quot;http://img.zhufengpeixun.cn/vue_url.png&quot;,</span>
<span class="hljs-addition">+        price: &quot;&#xA5;200.00&#x5143;&quot;,</span>
<span class="hljs-addition">+        category: &quot;vue&quot;,</span>
<span class="hljs-addition">+      },</span>
<span class="hljs-addition">+      {</span>
<span class="hljs-addition">+        order: 8,</span>
<span class="hljs-addition">+        title: &quot;8.Vue&#x4ECE;&#x5165;&#x95E8;&#x5230;&#x9879;&#x76EE;&#x5B9E;&#x6218;&quot;,</span>
<span class="hljs-addition">+        video: &quot;http://img.zhufengpeixun.cn/gee2.mp4&quot;,</span>
<span class="hljs-addition">+        poster: &quot;http://img.zhufengpeixun.cn/vue_poster.png&quot;,</span>
<span class="hljs-addition">+        url: &quot;http://img.zhufengpeixun.cn/vue_url.png&quot;,</span>
<span class="hljs-addition">+        price: &quot;&#xA5;300.00&#x5143;&quot;,</span>
<span class="hljs-addition">+        category: &quot;vue&quot;,</span>
<span class="hljs-addition">+      },</span>
<span class="hljs-addition">+      {</span>
<span class="hljs-addition">+        order: 9,</span>
<span class="hljs-addition">+        title: &quot;9.Vue&#x4ECE;&#x5165;&#x95E8;&#x5230;&#x9879;&#x76EE;&#x5B9E;&#x6218;&quot;,</span>
<span class="hljs-addition">+        video: &quot;http://img.zhufengpeixun.cn/gee2.mp4&quot;,</span>
<span class="hljs-addition">+        poster: &quot;http://img.zhufengpeixun.cn/vue_poster.png&quot;,</span>
<span class="hljs-addition">+        url: &quot;http://img.zhufengpeixun.cn/vue_url.png&quot;,</span>
<span class="hljs-addition">+        price: &quot;&#xA5;400.00&#x5143;&quot;,</span>
<span class="hljs-addition">+        category: &quot;vue&quot;,</span>
<span class="hljs-addition">+      },</span>
<span class="hljs-addition">+      {</span>
<span class="hljs-addition">+        order: 10,</span>
<span class="hljs-addition">+        title: &quot;10.Vue&#x4ECE;&#x5165;&#x95E8;&#x5230;&#x9879;&#x76EE;&#x5B9E;&#x6218;&quot;,</span>
<span class="hljs-addition">+        video: &quot;http://img.zhufengpeixun.cn/gee2.mp4&quot;,</span>
<span class="hljs-addition">+        poster: &quot;http://img.zhufengpeixun.cn/vue_poster.png&quot;,</span>
<span class="hljs-addition">+        url: &quot;http://img.zhufengpeixun.cn/vue_url.png&quot;,</span>
<span class="hljs-addition">+        price: &quot;&#xA5;500.00&#x5143;&quot;,</span>
<span class="hljs-addition">+        category: &quot;vue&quot;,</span>
<span class="hljs-addition">+      },</span>
<span class="hljs-addition">+      {</span>
<span class="hljs-addition">+        order: 11,</span>
<span class="hljs-addition">+        title: &quot;11.React&#x5168;&#x6808;&#x67B6;&#x6784;&quot;,</span>
<span class="hljs-addition">+        video: &quot;http://img.zhufengpeixun.cn/gee2.mp4&quot;,</span>
<span class="hljs-addition">+        poster: &quot;http://img.zhufengpeixun.cn/react_poster.jpg&quot;,</span>
<span class="hljs-addition">+        url: &quot;http://img.zhufengpeixun.cn/react_url.png&quot;,</span>
<span class="hljs-addition">+        price: &quot;&#xA5;600.00&#x5143;&quot;,</span>
<span class="hljs-addition">+        category: &quot;react&quot;,</span>
<span class="hljs-addition">+      },</span>
<span class="hljs-addition">+      {</span>
<span class="hljs-addition">+        order: 12,</span>
<span class="hljs-addition">+        title: &quot;12.React&#x5168;&#x6808;&#x67B6;&#x6784;&quot;,</span>
<span class="hljs-addition">+        video: &quot;http://img.zhufengpeixun.cn/gee2.mp4&quot;,</span>
<span class="hljs-addition">+        poster: &quot;http://img.zhufengpeixun.cn/react_poster.jpg&quot;,</span>
<span class="hljs-addition">+        url: &quot;http://img.zhufengpeixun.cn/react_url.png&quot;,</span>
<span class="hljs-addition">+        price: &quot;&#xA5;700.00&#x5143;&quot;,</span>
<span class="hljs-addition">+        category: &quot;react&quot;,</span>
<span class="hljs-addition">+      },</span>
<span class="hljs-addition">+      {</span>
<span class="hljs-addition">+        order: 13,</span>
<span class="hljs-addition">+        title: &quot;13.React&#x5168;&#x6808;&#x67B6;&#x6784;&quot;,</span>
<span class="hljs-addition">+        video: &quot;http://img.zhufengpeixun.cn/gee2.mp4&quot;,</span>
<span class="hljs-addition">+        poster: &quot;http://img.zhufengpeixun.cn/react_poster.jpg&quot;,</span>
<span class="hljs-addition">+        url: &quot;http://img.zhufengpeixun.cn/react_url.png&quot;,</span>
<span class="hljs-addition">+        price: &quot;&#xA5;800.00&#x5143;&quot;,</span>
<span class="hljs-addition">+        category: &quot;react&quot;,</span>
<span class="hljs-addition">+      },</span>
<span class="hljs-addition">+      {</span>
<span class="hljs-addition">+        order: 14,</span>
<span class="hljs-addition">+        title: &quot;14.React&#x5168;&#x6808;&#x67B6;&#x6784;&quot;,</span>
<span class="hljs-addition">+        video: &quot;http://img.zhufengpeixun.cn/gee2.mp4&quot;,</span>
<span class="hljs-addition">+        poster: &quot;http://img.zhufengpeixun.cn/react_poster.jpg&quot;,</span>
<span class="hljs-addition">+        url: &quot;http://img.zhufengpeixun.cn/react_url.png&quot;,</span>
<span class="hljs-addition">+        price: &quot;&#xA5;900.00&#x5143;&quot;,</span>
<span class="hljs-addition">+        category: &quot;react&quot;,</span>
<span class="hljs-addition">+      },</span>
<span class="hljs-addition">+      {</span>
<span class="hljs-addition">+        order: 15,</span>
<span class="hljs-addition">+        title: &quot;15.React&#x5168;&#x6808;&#x67B6;&#x6784;&quot;,</span>
<span class="hljs-addition">+        video: &quot;http://img.zhufengpeixun.cn/gee2.mp4&quot;,</span>
<span class="hljs-addition">+        poster: &quot;http://img.zhufengpeixun.cn/react_poster.jpg&quot;,</span>
<span class="hljs-addition">+        url: &quot;http://img.zhufengpeixun.cn/react_url.png&quot;,</span>
<span class="hljs-addition">+        price: &quot;&#xA5;1000.00&#x5143;&quot;,</span>
<span class="hljs-addition">+        category: &quot;react&quot;,</span>
<span class="hljs-addition">+      },</span>
<span class="hljs-addition">+      {</span>
<span class="hljs-addition">+        order: 16,</span>
<span class="hljs-addition">+        title: &quot;16.Vue&#x4ECE;&#x5165;&#x95E8;&#x5230;&#x9879;&#x76EE;&#x5B9E;&#x6218;&quot;,</span>
<span class="hljs-addition">+        video: &quot;http://img.zhufengpeixun.cn/gee2.mp4&quot;,</span>
<span class="hljs-addition">+        poster: &quot;http://img.zhufengpeixun.cn/vue_poster.png&quot;,</span>
<span class="hljs-addition">+        url: &quot;http://img.zhufengpeixun.cn/vue_url.png&quot;,</span>
<span class="hljs-addition">+        price: &quot;&#xA5;600.00&#x5143;&quot;,</span>
<span class="hljs-addition">+        category: &quot;vue&quot;,</span>
<span class="hljs-addition">+      },</span>
<span class="hljs-addition">+      {</span>
<span class="hljs-addition">+        order: 17,</span>
<span class="hljs-addition">+        title: &quot;17.Vue&#x4ECE;&#x5165;&#x95E8;&#x5230;&#x9879;&#x76EE;&#x5B9E;&#x6218;&quot;,</span>
<span class="hljs-addition">+        video: &quot;http://img.zhufengpeixun.cn/gee2.mp4&quot;,</span>
<span class="hljs-addition">+        poster: &quot;http://img.zhufengpeixun.cn/vue_poster.png&quot;,</span>
<span class="hljs-addition">+        url: &quot;http://img.zhufengpeixun.cn/vue_url.png&quot;,</span>
<span class="hljs-addition">+        price: &quot;&#xA5;700.00&#x5143;&quot;,</span>
<span class="hljs-addition">+        category: &quot;vue&quot;,</span>
<span class="hljs-addition">+      },</span>
<span class="hljs-addition">+      {</span>
<span class="hljs-addition">+        order: 18,</span>
<span class="hljs-addition">+        title: &quot;18.Vue&#x4ECE;&#x5165;&#x95E8;&#x5230;&#x9879;&#x76EE;&#x5B9E;&#x6218;&quot;,</span>
<span class="hljs-addition">+        video: &quot;http://img.zhufengpeixun.cn/gee2.mp4&quot;,</span>
<span class="hljs-addition">+        poster: &quot;http://img.zhufengpeixun.cn/vue_poster.png&quot;,</span>
<span class="hljs-addition">+        url: &quot;http://img.zhufengpeixun.cn/vue_url.png&quot;,</span>
<span class="hljs-addition">+        price: &quot;&#xA5;800.00&#x5143;&quot;,</span>
<span class="hljs-addition">+        category: &quot;vue&quot;,</span>
<span class="hljs-addition">+      },</span>
<span class="hljs-addition">+      {</span>
<span class="hljs-addition">+        order: 19,</span>
<span class="hljs-addition">+        title: &quot;19.Vue&#x4ECE;&#x5165;&#x95E8;&#x5230;&#x9879;&#x76EE;&#x5B9E;&#x6218;&quot;,</span>
<span class="hljs-addition">+        video: &quot;http://img.zhufengpeixun.cn/gee2.mp4&quot;,</span>
<span class="hljs-addition">+        poster: &quot;http://img.zhufengpeixun.cn/vue_poster.png&quot;,</span>
<span class="hljs-addition">+        url: &quot;http://img.zhufengpeixun.cn/vue_url.png&quot;,</span>
<span class="hljs-addition">+        price: &quot;&#xA5;900.00&#x5143;&quot;,</span>
<span class="hljs-addition">+        category: &quot;vue&quot;,</span>
<span class="hljs-addition">+      },</span>
<span class="hljs-addition">+      {</span>
<span class="hljs-addition">+        order: 20,</span>
<span class="hljs-addition">+        title: &quot;20.Vue&#x4ECE;&#x5165;&#x95E8;&#x5230;&#x9879;&#x76EE;&#x5B9E;&#x6218;&quot;,</span>
<span class="hljs-addition">+        video: &quot;http://img.zhufengpeixun.cn/gee2.mp4&quot;,</span>
<span class="hljs-addition">+        poster: &quot;http://img.zhufengpeixun.cn/vue_poster.png&quot;,</span>
<span class="hljs-addition">+        url: &quot;http://img.zhufengpeixun.cn/vue_url.png&quot;,</span>
<span class="hljs-addition">+        price: &quot;&#xA5;1000.00&#x5143;&quot;,</span>
<span class="hljs-addition">+        category: &quot;vue&quot;,</span>
<span class="hljs-addition">+      },</span>
<span class="hljs-addition">+    ];</span>
<span class="hljs-addition">+    Lesson.create(lessons);</span>
<span class="hljs-addition">+  }</span>
<span class="hljs-addition">+}</span>
</code></pre>
<h3 id="t11911.3 src\models\index.ts">11.3 src\models\index.ts <a href="#t11911.3 src\models\index.ts"> # </a></h3>
<p>src\models\index.ts</p>
<pre><code class="lang-diff">export * from &apos;./user&apos;;
export * from &apos;./slider&apos;;
<span class="hljs-addition">+export * from &apos;./lesson&apos;;</span>
</code></pre>
<h3 id="t12011.4 controller\lesson.ts">11.4 controller\lesson.ts <a href="#t12011.4 controller\lesson.ts"> # </a></h3>
<p>src\controller\lesson.ts</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> { Request, Response } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;express&quot;</span>;
<span class="hljs-keyword">import</span> { ILessonDocument, Lesson } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../models&quot;</span>;
<span class="hljs-keyword">import</span> {FilterQuery} <span class="hljs-keyword">from</span> <span class="hljs-string">&apos;mongoose&apos;</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> list = <span class="hljs-keyword">async</span> (req: Request, <span class="hljs-attr">res</span>: Response) =&gt; {
  <span class="hljs-keyword">let</span> { category } = req.query;
  <span class="hljs-keyword">let</span> offset: any = req.query.offset;
  <span class="hljs-keyword">let</span> limit: any = req.query.limit;
  offset = <span class="hljs-built_in">isNaN</span>(offset) ? <span class="hljs-number">0</span> : <span class="hljs-built_in">parseInt</span>(offset); <span class="hljs-comment">//&#x504F;&#x79FB;&#x91CF;</span>
  limit = <span class="hljs-built_in">isNaN</span>(limit) ? <span class="hljs-number">5</span> : <span class="hljs-built_in">parseInt</span>(limit); <span class="hljs-comment">//&#x6BCF;&#x9875;&#x6761;&#x6570;</span>
  <span class="hljs-keyword">let</span> query: FilterQuery&lt;ILessonDocument&gt; = {};
  <span class="hljs-keyword">if</span> (category &amp;&amp; category != <span class="hljs-string">&quot;all&quot;</span>) query.category = category <span class="hljs-keyword">as</span> string;
  <span class="hljs-keyword">let</span> total = <span class="hljs-keyword">await</span> Lesson.count(query);
  <span class="hljs-keyword">let</span> list = <span class="hljs-keyword">await</span> Lesson.find(query)
    .sort({ <span class="hljs-attr">order</span>: <span class="hljs-number">1</span> })
    .skip(offset)
    .limit(limit);
  list = list.map(<span class="hljs-function">(<span class="hljs-params">item:ILessonDocument</span>)=&gt;</span>item.toJSON());  
  setTimeout(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    res.json({ <span class="hljs-attr">code</span>: <span class="hljs-number">0</span>, <span class="hljs-attr">data</span>: { list, <span class="hljs-attr">hasMore</span>: total &gt; offset + limit } });
  }, <span class="hljs-number">1000</span>);
};
<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-keyword">get</span> = async (req: Request, res: Response) =&gt; {
  <span class="hljs-keyword">let</span> id = req.params.id;
  <span class="hljs-keyword">let</span> lesson = <span class="hljs-keyword">await</span> Lesson.findById(id);
  res.json({ <span class="hljs-attr">success</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">data</span>: lesson });
};
</code></pre>
<h3 id="t12111.5 models\lesson.ts">11.5 models\lesson.ts <a href="#t12111.5 models\lesson.ts"> # </a></h3>
<p>src\models\lesson.ts</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> mongoose, { Schema, Document } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;mongoose&quot;</span>;
<span class="hljs-keyword">export</span> interface ILessonDocument extends Document {
  <span class="hljs-attr">order</span>: number; <span class="hljs-comment">//&#x987A;&#x5E8F;</span>
  title: string; <span class="hljs-comment">//&#x6807;&#x9898;</span>
  video: string; <span class="hljs-comment">//&#x89C6;&#x9891;</span>
  poster: string; <span class="hljs-comment">//&#x6D77;&#x62A5;</span>
  url: string; <span class="hljs-comment">//url&#x5730;&#x5740;</span>
  price: string; <span class="hljs-comment">//&#x4EF7;&#x683C;</span>
  category: string; <span class="hljs-comment">//&#x5206;&#x7C7B;</span>
}
<span class="hljs-keyword">const</span> LessonSchema: Schema&lt;ILessonDocument&gt; = <span class="hljs-keyword">new</span> Schema(
  {
    <span class="hljs-attr">order</span>: <span class="hljs-built_in">Number</span>, <span class="hljs-comment">//&#x987A;&#x5E8F;</span>
    <span class="hljs-attr">title</span>: <span class="hljs-built_in">String</span>, <span class="hljs-comment">//&#x6807;&#x9898;</span>
    <span class="hljs-attr">video</span>: <span class="hljs-built_in">String</span>, <span class="hljs-comment">//&#x89C6;&#x9891;</span>
    <span class="hljs-attr">poster</span>: <span class="hljs-built_in">String</span>, <span class="hljs-comment">//&#x6D77;&#x62A5;</span>
    <span class="hljs-attr">url</span>: <span class="hljs-built_in">String</span>, <span class="hljs-comment">//url&#x5730;&#x5740;</span>
    <span class="hljs-attr">price</span>: <span class="hljs-built_in">String</span>, <span class="hljs-comment">//&#x4EF7;&#x683C;</span>
    <span class="hljs-attr">category</span>: <span class="hljs-built_in">String</span>, <span class="hljs-comment">//&#x5206;&#x7C7B;</span>
  },
  { <span class="hljs-attr">timestamps</span>: <span class="hljs-literal">true</span>,<span class="hljs-attr">toJSON</span>:{
    transform(_doc,ret){
        ret.id=ret._id;
        <span class="hljs-keyword">delete</span> ret._id;
        <span class="hljs-keyword">delete</span> ret.__v;
        <span class="hljs-keyword">delete</span> ret.password;
        <span class="hljs-keyword">return</span> ret;
    }
} }
);

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> Lesson = mongoose.model &lt; ILessonDocument &gt; (<span class="hljs-string">&quot;Lesson&quot;</span>, LessonSchema);
</code></pre>
<h2 id="t122&#x7B2C;12&#x7AE0; &#x8BFE;&#x7A0B;&#x5217;&#x8868;">&#x7B2C;12&#x7AE0; &#x8BFE;&#x7A0B;&#x5217;&#x8868; <a href="#t122&#x7B2C;12&#x7AE0; &#x8BFE;&#x7A0B;&#x5217;&#x8868;"> # </a></h2>
<ul>
<li>&#x672C;&#x7AE0;&#x5B9E;&#x8DF5;&#x7684;&#x5185;&#x5BB9;<ul>
<li>&#x52A0;&#x8F7D;&#x8BFE;&#x7A0B;&#x5217;&#x8868;</li>
<li>&#x4E0A;&#x62C9;&#x52A0;&#x8F7D;</li>
</ul>
</li>
</ul>
<h3 id="t12312.1 &#x53C2;&#x8003;">12.1 &#x53C2;&#x8003; <a href="#t12312.1 &#x53C2;&#x8003;"> # </a></h3>
<h4 id="t12412.1.1 &#x76EE;&#x5F55;&#x7ED3;&#x6784;">12.1.1 &#x76EE;&#x5F55;&#x7ED3;&#x6784; <a href="#t12412.1.1 &#x76EE;&#x5F55;&#x7ED3;&#x6784;"> # </a></h4>
<pre><code class="lang-js">.
&#x251C;&#x2500;&#x2500; package.json
&#x251C;&#x2500;&#x2500; public
&#x2502;   &#x2514;&#x2500;&#x2500; index.html
&#x251C;&#x2500;&#x2500; src
&#x2502;   &#x251C;&#x2500;&#x2500; api
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; home.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; profile.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; assets
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; css
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; common.less
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; images
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; logo.png
&#x2502;   &#x251C;&#x2500;&#x2500; components
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; NavHeader
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; Tabs
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; routes
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Home
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; components
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; HomeHeader
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; HomeSliders
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; LessonList
&#x2502;   &#x2502;   &#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Login
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Mine
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Profile
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; Register
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; store
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; actions
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; home.tsx
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; profile.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; action-types.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; history.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; reducers
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; home.tsx
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; mine.tsx
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; profile.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; typings
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; images.d.ts
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; lesson.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; login-types.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; slider.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; user.tsx
&#x2502;   &#x2514;&#x2500;&#x2500; utils.tsx
&#x251C;&#x2500;&#x2500; tsconfig.json
&#x251C;&#x2500;&#x2500; webpack.config.js
</code></pre>
<h4 id="t12512.1.2 &#x9875;&#x9762;&#x6548;&#x679C;">12.1.2 &#x9875;&#x9762;&#x6548;&#x679C; <a href="#t12512.1.2 &#x9875;&#x9762;&#x6548;&#x679C;"> # </a></h4>
<p><img src="http://img.zhufengpeixun.cn/lessonlist2.gif" alt="lessonlist2"></p>
<h3 id="t12612.2 src\api\home.tsx">12.2 src\api\home.tsx <a href="#t12612.2 src\api\home.tsx"> # </a></h3>
<p>src\api\home.tsx</p>
<pre><code class="lang-diff">import axios from &quot;./index&quot;;
export function getSliders() {
  return axios.get(&quot;/slider/list&quot;);
}
<span class="hljs-addition">+export function getLessons(</span>
<span class="hljs-addition">+  currentCategory: string = &quot;all&quot;,</span>
<span class="hljs-addition">+  offset: number,</span>
<span class="hljs-addition">+  limit: number</span>
<span class="hljs-addition">+) {</span>
<span class="hljs-addition">+  return axios.get(</span>
<span class="hljs-addition">+    `/lesson/list?category=${currentCategory}&amp;offset=${offset}&amp;limit=${limit}`</span>
<span class="hljs-addition">+  );</span>
<span class="hljs-addition">+}</span>

</code></pre>
<h3 id="t12712.3 action-types.tsx">12.3 action-types.tsx <a href="#t12712.3 action-types.tsx"> # </a></h3>
<p>src\store\action-types.tsx</p>
<pre><code class="lang-diff">export const ADD = &quot;ADD&quot;;
//&#x8BBE;&#x7F6E;&#x5F53;&#x524D;&#x5206;&#x7C7B;&#x7684;&#x540D;&#x79F0;
export const SET_CURRENT_CATEGORY = &quot;SET_CURRENT_CATEGORY&quot;;
//&#x53D1;&#x8D77;&#x9A8C;&#x8BC1;&#x7528;&#x6237;&#x662F;&#x5426;&#x767B;&#x5F55;&#x7684;&#x8BF7;&#x6C42;
export const VALIDATE = &quot;VALIDATE&quot;;

export const LOGOUT = &quot;LOGOUT&quot;;
//&#x4E0A;&#x4F20;&#x5934;&#x50CF;
export const CHANGE_AVATAR = &quot;CHANGE_AVATAR&quot;;
export const GET_SLIDERS = &quot;GET_SLIDERS&quot;;

<span class="hljs-addition">+export const GET_LESSONS = &quot;GET_LESSONS&quot;;</span>
<span class="hljs-addition">+export const SET_LESSONS_LOADING = &quot;SET_LESSONS_LOADING&quot;;</span>
<span class="hljs-addition">+export const SET_LESSONS = &quot;SET_LESSONS&quot;;</span>
<span class="hljs-addition">+export const REFRESH_LESSONS = &quot;REFRESH_LESSONS&quot;;</span>
</code></pre>
<h3 id="t12812.4 typings\lesson.tsx">12.4 typings\lesson.tsx <a href="#t12812.4 typings\lesson.tsx"> # </a></h3>
<p>src\typings\lesson.tsx</p>
<pre><code class="lang-js"><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> interface Lesson {
  <span class="hljs-attr">id</span>: string;
  title: string;
  video: string;
  poster: string;
  url: string;
  price: string;
  category: string;
}

interface LessonResult {
  <span class="hljs-attr">data</span>: Lesson;
  success: boolean;
}
<span class="hljs-keyword">export</span> {
  Lesson,
  LessonResult
}
</code></pre>
<h3 id="t12912.5 reducers\home.tsx">12.5 reducers\home.tsx <a href="#t12912.5 reducers\home.tsx"> # </a></h3>
<p>src\store\reducers\home.tsx</p>
<pre><code class="lang-diff">import { AnyAction } from &quot;redux&quot;;
import * as TYPES from &quot;../action-types&quot;;
import Slider from &quot;@/typings/slider&quot;;
<span class="hljs-addition">+import Lesson from &quot;@/typings/Lesson&quot;;</span>

<span class="hljs-addition">+export interface Lessons {</span>
<span class="hljs-addition">+  loading: boolean;</span>
<span class="hljs-addition">+  list: Lesson[];</span>
<span class="hljs-addition">+  hasMore: boolean;</span>
<span class="hljs-addition">+  offset: number;</span>
<span class="hljs-addition">+  limit: number;</span>
<span class="hljs-addition">+}</span>
export interface HomeState {
  currentCategory: string;
  sliders: Slider[];
<span class="hljs-addition">+  lessons: Lessons;</span>
}
let initialState: HomeState = {
  currentCategory: &quot;all&quot;, //&#x9ED8;&#x8BA4;&#x5F53;&#x524D;&#x7684;&#x5206;&#x7C7B;&#x662F;&#x663E;&#x793A;&#x5168;&#x90E8;&#x7C7B;&#x578B;&#x7684;&#x8BFE;&#x7A0B;
  sliders: [],
<span class="hljs-addition">+  lessons: {</span>
<span class="hljs-addition">+    loading: false,</span>
<span class="hljs-addition">+    list: [],</span>
<span class="hljs-addition">+    hasMore: true,</span>
<span class="hljs-addition">+    offset: 0,</span>
<span class="hljs-addition">+    limit: 5,</span>
<span class="hljs-addition">+  },</span>
};
export default function (
  state: HomeState = initialState,
  action: AnyAction
): HomeState {
  switch (action.type) {
    case TYPES.SET_CURRENT_CATEGORY: //&#x4FEE;&#x6539;&#x5F53;&#x524D;&#x5206;&#x7C7B;
      return { ...state, currentCategory: action.payload };
    case TYPES.GET_SLIDERS:
      return { ...state, sliders: action.payload.data };
<span class="hljs-addition">+    case TYPES.SET_LESSONS_LOADING:</span>
<span class="hljs-addition">+      return {</span>
<span class="hljs-addition">+        ...state,</span>
<span class="hljs-addition">+        lessons: { ...state.lessons, loading: action.payload },</span>
<span class="hljs-addition">+      };</span>
<span class="hljs-addition">+    case TYPES.SET_LESSONS:</span>
<span class="hljs-addition">+      return {</span>
<span class="hljs-addition">+        ...state,</span>
<span class="hljs-addition">+        lessons: {</span>
<span class="hljs-addition">+          ...state.lessons,</span>
<span class="hljs-addition">+          loading: false,</span>
<span class="hljs-addition">+          hasMore: action.payload.hasMore,</span>
<span class="hljs-addition">+          list: [...state.lessons.list, ...action.payload.list],</span>
<span class="hljs-addition">+          offset: state.lessons.offset + action.payload.list.length,</span>
<span class="hljs-addition">+        },</span>
<span class="hljs-addition">+      };</span>
<span class="hljs-addition">+     case TYPES.REFRESH_LESSONS:</span>
<span class="hljs-addition">+        return {</span>
<span class="hljs-addition">+          ...state,</span>
<span class="hljs-addition">+          lessons: {</span>
<span class="hljs-addition">+            ...state.lessons,</span>
<span class="hljs-addition">+            loading: false,</span>
<span class="hljs-addition">+            hasMore: action.payload.hasMore,</span>
<span class="hljs-addition">+            list: action.payload.list,</span>
<span class="hljs-addition">+            offset: action.payload.list.length,</span>
<span class="hljs-addition">+          },</span>
<span class="hljs-addition">+       };</span>
    default:
      return state;
  }
}
</code></pre>
<h3 id="t13012.6 actions\home.tsx">12.6 actions\home.tsx <a href="#t13012.6 actions\home.tsx"> # </a></h3>
<p>src\store\actions\home.tsx</p>
<pre><code class="lang-diff">import * as TYPES from &quot;../action-types&quot;;
<span class="hljs-addition">+import { getSliders, getLessons } from &quot;@/api/home&quot;;</span>
export default {
  setCurrentCategory(currentCategory: string) {
    return { type: TYPES.SET_CURRENT_CATEGORY, payload: currentCategory };
  },
  getSliders() {
    return {
      type: TYPES.GET_SLIDERS,
      payload: getSliders(),
    };
  },
<span class="hljs-addition">+  getLessons() {</span>
<span class="hljs-addition">+    return (dispatch: any, getState: any) =&gt; {</span>
<span class="hljs-addition">+      (async function () {</span>
<span class="hljs-addition">+        let {</span>
<span class="hljs-addition">+          currentCategory,</span>
<span class="hljs-addition">+          lessons: { hasMore, offset, limit, loading },</span>
<span class="hljs-addition">+        } = getState().home;</span>
<span class="hljs-addition">+        if (hasMore &amp;&amp; !loading) {</span>
<span class="hljs-addition">+          dispatch({ type: TYPES.SET_LESSONS_LOADING, payload: true });</span>
<span class="hljs-addition">+          let result = await getLessons(currentCategory, offset, limit);</span>
<span class="hljs-addition">+          dispatch({ type: TYPES.SET_LESSONS, payload: result.data });</span>
<span class="hljs-addition">+        }</span>
<span class="hljs-addition">+      })();</span>
<span class="hljs-addition">+    };</span>
<span class="hljs-addition">+  },</span>
<span class="hljs-addition">+  refreshLessons() {</span>
<span class="hljs-addition">+    return (dispatch: Function, getState: Function) =&gt; {</span>
<span class="hljs-addition">+      (async function () {</span>
<span class="hljs-addition">+        let {</span>
<span class="hljs-addition">+          currentCategory,</span>
<span class="hljs-addition">+          lessons: { limit, loading },</span>
<span class="hljs-addition">+        } = getState().home;</span>
<span class="hljs-addition">+        if (!loading) {</span>
<span class="hljs-addition">+          dispatch({ type: types.SET_LESSONS_LOADING, payload: true });</span>
<span class="hljs-addition">+          let result = await getLessons(currentCategory, 0, limit);</span>
<span class="hljs-addition">+          dispatch({ type: types.REFRESH_LESSONS, payload: result.data });</span>
<span class="hljs-addition">+        }</span>
<span class="hljs-addition">+      })();</span>
<span class="hljs-addition">+ };</span>
};

</code></pre>
<h3 id="t13112.7 src\utils.tsx">12.7 src\utils.tsx <a href="#t13112.7 src\utils.tsx"> # </a></h3>
<p>src\utils.tsx</p>
<pre><code class="lang-js"><span class="hljs-comment">//element &#x8981;&#x5B9E;&#x73B0;&#x6B64;&#x529F;&#x80FD;DOM&#x5BF9;&#x8C61; callback&#x52A0;&#x8F7D;&#x66F4;&#x591A;&#x7684;&#x65B9;&#x6CD5;</span>
<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">loadMore</span>(<span class="hljs-params">element: HTMLElement, callback: Function</span>) </span>{
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">_loadMore</span>(<span class="hljs-params"></span>) </span>{
      <span class="hljs-keyword">let</span> clientHeight = element.clientHeight;
      <span class="hljs-keyword">let</span> scrollTop = element.scrollTop;
      <span class="hljs-keyword">let</span> scrollHeight = element.scrollHeight;
      <span class="hljs-keyword">if</span> (clientHeight + scrollTop + <span class="hljs-number">10</span> &gt;= scrollHeight) {
        callback();
      }
    }
    element.addEventListener(<span class="hljs-string">&quot;scroll&quot;</span>, debounce(_loadMore, <span class="hljs-number">300</span>));
}
<span class="hljs-keyword">export</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">debounce</span>(<span class="hljs-params">fn: any, wait: number</span>) </span>{
  <span class="hljs-keyword">var</span> timeout: any = <span class="hljs-literal">null</span>;
  <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">if</span> (timeout !== <span class="hljs-literal">null</span>) clearTimeout(timeout);
    timeout = setTimeout(fn, wait);
  };
}
</code></pre>
<h3 id="t13212.8 LessonList\index.tsx">12.8 LessonList\index.tsx <a href="#t13212.8 LessonList\index.tsx"> # </a></h3>
<p>src\routes\Home\components\LessonList\index.tsx</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> React, { useEffect, forwardRef, useState } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">&quot;./index.less&quot;</span>;
<span class="hljs-keyword">import</span> { Card, Skeleton, Button, Alert, Menu } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;antd&quot;</span>;
<span class="hljs-keyword">import</span> { Link } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-router-dom&quot;</span>;
<span class="hljs-keyword">import</span> Lesson <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/typings/lesson&quot;</span>;
<span class="hljs-keyword">import</span> { MenuOutlined } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@ant-design/icons&quot;</span>;
interface Props {
  children?: any;
  lessons?: any;
  getLessons?: any;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">LessonList</span>(<span class="hljs-params">props: Props</span>) </span>{
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    <span class="hljs-keyword">if</span> (props.lessons.list.length == <span class="hljs-number">0</span>) {
      props.getLessons();
    }
  }, []);
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">section</span> <span class="hljs-attr">className</span>=<span class="hljs-string">&quot;lesson-list&quot;</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">MenuOutlined</span> /&gt;</span> &#x5168;&#x90E8;&#x8BFE;&#x7A0B;
      <span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Skeleton</span>
        <span class="hljs-attr">loading</span>=<span class="hljs-string">{props.lessons.list.length</span> == <span class="hljs-string">0</span> &amp;&amp; <span class="hljs-attr">props.lessons.loading</span>}
        <span class="hljs-attr">active</span>
        <span class="hljs-attr">paragraph</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">rows:</span> <span class="hljs-attr">8</span> }}
      &gt;</span>
        {props.lessons.list.map((lesson: Lesson, index: number) =&gt;(
            <span class="hljs-tag">&lt;<span class="hljs-name">Link</span>
            <span class="hljs-attr">key</span>=<span class="hljs-string">{lesson.id}</span>
            <span class="hljs-attr">to</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">pathname:</span> `/<span class="hljs-attr">detail</span>/${<span class="hljs-attr">lesson.id</span>}`, <span class="hljs-attr">state:</span> <span class="hljs-attr">lesson</span> }}
            &gt;</span>
            <span class="hljs-tag">&lt;<span class="hljs-name">Card</span>
                <span class="hljs-attr">hoverable</span>=<span class="hljs-string">{true}</span>
                <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">width:</span> &quot;<span class="hljs-attr">100</span>%&quot; }}
                <span class="hljs-attr">cover</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">img</span> <span class="hljs-attr">alt</span>=<span class="hljs-string">{lesson.title}</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{lesson.poster}</span> /&gt;</span>}
            &gt;
                <span class="hljs-tag">&lt;<span class="hljs-name">Card.Meta</span>
                <span class="hljs-attr">title</span>=<span class="hljs-string">{lesson.title}</span>
                <span class="hljs-attr">description</span>=<span class="hljs-string">{</span>`&#x4EF7;&#x683C;<span class="hljs-attr">:</span> &#xA5;${<span class="hljs-attr">lesson.price</span>}&#x5143;`}
                /&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">Card</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">Link</span>&gt;</span>
        ))}
        {props.lessons.hasMore ? (
          <span class="hljs-tag">&lt;<span class="hljs-name">Button</span>
            <span class="hljs-attr">onClick</span>=<span class="hljs-string">{props.getLessons}</span>
            <span class="hljs-attr">loading</span>=<span class="hljs-string">{props.lessons.loading}</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;primary&quot;</span>
            <span class="hljs-attr">block</span>
          &gt;</span>
            {props.lessons.loading ? &quot;&quot; : &quot;&#x52A0;&#x8F7D;&#x66F4;&#x591A;&quot;}
          <span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
        ) : (
          <span class="hljs-tag">&lt;<span class="hljs-name">Alert</span>
            <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">textAlign:</span> &quot;<span class="hljs-attr">center</span>&quot; }}
            <span class="hljs-attr">message</span>=<span class="hljs-string">&quot;&#x5230;&#x5E95;&#x4E86;&quot;</span>
            <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;warning&quot;</span>
          /&gt;</span>
        )}
      <span class="hljs-tag">&lt;/<span class="hljs-name">Skeleton</span>&gt;</span>
    <span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span></span>
  );
}
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> LessonList;
</code></pre>
<h3 id="t13312.9 LessonList\index.less">12.9 LessonList\index.less <a href="#t13312.9 LessonList\index.less"> # </a></h3>
<p>src\routes\Home\components\LessonList\index.less</p>
<pre><code class="lang-less"><span class="hljs-selector-class">.lesson-list</span> {
  <span class="hljs-selector-tag">h2</span> {
    <span class="hljs-attribute">line-height</span>: <span class="hljs-number">100px</span>;
    <span class="hljs-selector-tag">i</span> {
      <span class="hljs-attribute">margin</span>: <span class="hljs-number">0</span> <span class="hljs-number">10px</span>;
    }
  }
  <span class="hljs-selector-class">.ant-card</span><span class="hljs-selector-class">.ant-card-bordered</span><span class="hljs-selector-class">.ant-card-hoverable</span> {
    <span class="hljs-attribute">height</span>: <span class="hljs-number">650px</span>;
    <span class="hljs-attribute">overflow</span>: hidden;
  }
}
</code></pre>
<h3 id="t13412.10 routes\Home\index.tsx">12.10 routes\Home\index.tsx <a href="#t13412.10 routes\Home\index.tsx"> # </a></h3>
<p>src\routes\Home\index.tsx</p>
<pre><code class="lang-diff"><span class="hljs-addition">+import React, { PropsWithChildren, useRef, useEffect } from &quot;react&quot;;</span>
import { connect } from &quot;react-redux&quot;;
import { RouteComponentProps } from &quot;react-router-dom&quot;;
import actions from &quot;@/store/actions/home&quot;;
import HomeHeader from &quot;./components/HomeHeader&quot;;
import { CombinedState } from &quot;@/store/reducers&quot;;
import { HomeState } from &quot;@/store/reducers/home&quot;;
import HomeSliders from &quot;./components/HomeSliders&quot;;
import &quot;./index.less&quot;;
<span class="hljs-addition">+import LessonList from &quot;./components/LessonList&quot;;</span>
<span class="hljs-addition">+import { loadMore} from &quot;@/utils&quot;;</span>
type StateProps = ReturnType&lt;typeof mapStateToProps&gt;;
type DispatchProps = typeof actions;
interface Params {}
type Props = PropsWithChildren&lt;
  RouteComponentProps&lt;Params&gt; &amp; StateProps &amp; DispatchProps
&gt;;
function Home(props: Props) {
  const homeContainerRef = useRef(null);
  useEffect(() =&gt; {
        loadMore(homeContainerRef.current, props.getLessons);
  }, []);
  return (
    &lt;&gt;
      &lt;HomeHeader
        currentCategory={props.currentCategory}
        setCurrentCategory={props.setCurrentCategory}
        refreshLessons={props.refreshLessons}
      /&gt;
      &lt;div className=&quot;home-container&quot; ref={homeContainerRef}&gt;
        &lt;HomeSliders sliders={props.sliders} getSliders={props.getSliders} /&gt;
<span class="hljs-addition">+       &lt;LessonList</span>
<span class="hljs-addition">+          ref={lessonListRef}</span>
<span class="hljs-addition">+          container={homeContainerRef}</span>
<span class="hljs-addition">+          lessons={props.lessons}</span>
<span class="hljs-addition">+          getLessons={props.getLessons}</span>
<span class="hljs-addition">+       /&gt;</span>
      &lt;/div&gt;
    &lt;/&gt;
  );
}
let mapStateToProps = (state: CombinedState): HomeState =&gt; state.home;
export default connect(mapStateToProps, actions)(Home);

</code></pre>
<h3 id="t13512.11 routes\Home\index.less">12.11 routes\Home\index.less <a href="#t13512.11 routes\Home\index.less"> # </a></h3>
<p>src\routes\Home\index.less</p>
<pre><code class="lang-diff"><span class="hljs-addition">+.home-container {</span>
<span class="hljs-addition">+  position: fixed;</span>
<span class="hljs-addition">+  top: 100px;</span>
<span class="hljs-addition">+  left: 0;</span>
<span class="hljs-addition">+  width: 100%;</span>
<span class="hljs-addition">+  overflow-y: auto;</span>
<span class="hljs-addition">+  height: calc(100vh - 222px);</span>
<span class="hljs-addition">+  background-color: #FFF;</span>
<span class="hljs-addition">+}</span>
</code></pre>
<h2 id="t136&#x7B2C;13&#x7AE0; &#x8BFE;&#x7A0B;&#x8BE6;&#x60C5;">&#x7B2C;13&#x7AE0; &#x8BFE;&#x7A0B;&#x8BE6;&#x60C5; <a href="#t136&#x7B2C;13&#x7AE0; &#x8BFE;&#x7A0B;&#x8BE6;&#x60C5;"> # </a></h2>
<h3 id="t13713.1 &#x53C2;&#x8003;">13.1 &#x53C2;&#x8003; <a href="#t13713.1 &#x53C2;&#x8003;"> # </a></h3>
<h4 id="t13813.1.1 &#x76EE;&#x5F55;&#x7ED3;&#x6784;">13.1.1 &#x76EE;&#x5F55;&#x7ED3;&#x6784; <a href="#t13813.1.1 &#x76EE;&#x5F55;&#x7ED3;&#x6784;"> # </a></h4>
<pre><code class="lang-js">.
&#x251C;&#x2500;&#x2500; package.json
&#x251C;&#x2500;&#x2500; public
&#x2502;   &#x2514;&#x2500;&#x2500; index.html
&#x251C;&#x2500;&#x2500; README.md
&#x251C;&#x2500;&#x2500; src
&#x2502;   &#x251C;&#x2500;&#x2500; api
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; home.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; profile.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; assets
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; css
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; common.less
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; images
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; logo.png
&#x2502;   &#x251C;&#x2500;&#x2500; components
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; NavHeader
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; Tabs
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; routes
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Detail
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Home
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; components
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; HomeHeader
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; HomeSliders
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; LessonList
&#x2502;   &#x2502;   &#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Login
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Mine
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Profile
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; Register
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; store
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; actions
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; home.tsx
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; profile.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; action-types.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; history.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; reducers
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; home.tsx
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; mine.tsx
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; profile.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; typings
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; images.d.ts
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; lesson.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; login-types.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; slider.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; user.tsx
&#x2502;   &#x2514;&#x2500;&#x2500; utils.tsx
&#x251C;&#x2500;&#x2500; tsconfig.json
&#x251C;&#x2500;&#x2500; webpack.config.js
</code></pre>
<h4 id="t13913.1.2 &#x9875;&#x9762;&#x6548;&#x679C;">13.1.2 &#x9875;&#x9762;&#x6548;&#x679C; <a href="#t13913.1.2 &#x9875;&#x9762;&#x6548;&#x679C;"> # </a></h4>
<p><img src="http://img.zhufengpeixun.cn/lessondetail.gif" alt="lessondetail"></p>
<h3 id="t14013.2 src\index.tsx">13.2 src\index.tsx <a href="#t14013.2 src\index.tsx"> # </a></h3>
<p>src\index.tsx</p>
<pre><code class="lang-diff">import React from &quot;react&quot;;
import ReactDOM from &quot;react-dom&quot;;
import { Switch, Route, Redirect } from &quot;react-router-dom&quot;; //&#x4E09;&#x4E2A;&#x8DEF;&#x7531;&#x7EC4;&#x4EF6;
import { Provider } from &quot;react-redux&quot;; //&#x8D1F;&#x8D23;&#x628A;&#x5C5E;&#x6027;&#x4E2D;&#x7684;store&#x4F20;&#x9012;&#x7ED9;&#x5B50;&#x7EC4;&#x4EF6;
import store from &quot;./store&quot;; //&#x5F15;&#x5165;&#x4ED3;&#x5E93;
import { ConfigProvider } from &quot;antd&quot;; //&#x914D;&#x7F6E;
import zh_CN from &quot;antd/lib/locale-provider/zh_CN&quot;; //&#x56FD;&#x9645;&#x5316;&#x4E2D;&#x6587;
import &quot;./assets/css/common.less&quot;; //&#x901A;&#x7528;&#x7684;&#x6837;&#x5F0F;
import Tabs from &quot;./components/Tabs&quot;; //&#x5F15;&#x5165;&#x5E95;&#x90E8;&#x7684;&#x9875;&#x7B7E;&#x5BFC;&#x822A;
import Home from &quot;./routes/Home&quot;; //&#x9996;&#x9875;
import Mine from &quot;./routes/Mine&quot;; //&#x6211;&#x7684;&#x8BFE;&#x7A0B;
import Profile from &quot;./routes/Profile&quot;; //&#x4E2A;&#x4EBA;&#x4E2D;&#x5FC3;
import Register from &quot;./routes/Register&quot;;
import Login from &quot;./routes/Login&quot;;
<span class="hljs-addition">+import Detail from &quot;./routes/Detail&quot;;</span>
import { ConnectedRouter } from &quot;connected-react-router&quot;; //redux&#x7ED1;&#x5B9A;&#x8DEF;&#x7531;
import history from &quot;./store/history&quot;;
ReactDOM.render(
  &lt;Provider store={store}&gt;
    &lt;ConnectedRouter history={history}&gt;
      &lt;ConfigProvider locale={zh_CN}&gt;
        &lt;main className=&quot;main-container&quot;&gt;
          &lt;Switch&gt;
            &lt;Route path=&quot;/&quot; exact component={Home} /&gt;
            &lt;Route path=&quot;/mine&quot; component={Mine} /&gt;
            &lt;Route path=&quot;/profile&quot; component={Profile} /&gt;
            &lt;Route path=&quot;/register&quot; component={Register} /&gt;
            &lt;Route path=&quot;/login&quot; component={Login} /&gt;
<span class="hljs-addition">+           &lt;Route path=&quot;/detail/:id&quot; component={Detail} /&gt;</span>
            &lt;Redirect to=&quot;/&quot; /&gt;
          &lt;/Switch&gt;
        &lt;/main&gt;
        &lt;Tabs /&gt;
      &lt;/ConfigProvider&gt;
    &lt;/ConnectedRouter&gt;
  &lt;/Provider&gt;,
  document.getElementById(&quot;root&quot;)
);
</code></pre>
<h3 id="t14113.3 src\api\home.tsx">13.3 src\api\home.tsx <a href="#t14113.3 src\api\home.tsx"> # </a></h3>
<p>src\api\home.tsx</p>
<pre><code class="lang-diff">import axios from &quot;./index&quot;;
export function getSliders() {
  return axios.get(&quot;/slider/list&quot;);
}
export function getLessons(
  currentCategory: string = &quot;all&quot;,
  offset: number,
  limit: number
) {
  return axios.get(
    `/lesson/list?category=${currentCategory}&amp;offset=${offset}&amp;limit=${limit}`
  );
}
<span class="hljs-addition">+export function getLesson&lt;T&gt;(id: string) {</span>
<span class="hljs-addition">+  return axios.get&lt;T, T&gt;(`/lesson/${id}`);</span>
<span class="hljs-addition">+}</span>

</code></pre>
<h3 id="t14213.4 routes\Detail\index.tsx">13.4 routes\Detail\index.tsx <a href="#t14213.4 routes\Detail\index.tsx"> # </a></h3>
<p>src\routes\Detail\index.tsx</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> React, { useState, useEffect } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;
<span class="hljs-keyword">import</span> { connect } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-redux&quot;</span>;
<span class="hljs-keyword">import</span> { Card, Button } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;antd&quot;</span>;
<span class="hljs-keyword">import</span> NavHeader <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/components/NavHeader&quot;</span>;
<span class="hljs-keyword">import</span> { getLesson } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/api/home&quot;</span>;
<span class="hljs-keyword">import</span> { RouteComponentProps } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-router&quot;</span>;
<span class="hljs-keyword">import</span> Lesson <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/typings/lesson&quot;</span>;
<span class="hljs-keyword">import</span> { StaticContext } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-router&quot;</span>;
<span class="hljs-keyword">import</span> { LessonResult } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/typings/lesson&quot;</span>;
<span class="hljs-keyword">const</span> { Meta } = Card;
interface Params {
  <span class="hljs-attr">id</span>: string;
}
type RouteProps = RouteComponentProps&lt;Params, StaticContext, Lesson&gt;;
type Props = RouteProps &amp; {
  children?: any;
};

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Detail</span>(<span class="hljs-params">props: Props</span>) </span>{
  <span class="hljs-keyword">let</span> [lesson, setLesson] = useState&lt;Lesson&gt;({} <span class="hljs-keyword">as</span> Lesson);
  useEffect(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    (<span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">let</span> lesson: Lesson = props.location.state;
      <span class="hljs-keyword">if</span> (!lesson) {
        <span class="hljs-keyword">let</span> id = props.match.params.id;
        <span class="hljs-keyword">let</span> result: LessonResult = <span class="hljs-keyword">await</span> getLesson&lt;LessonResult&gt;(id);
        <span class="hljs-keyword">if</span> (result.success) lesson = result.data;
      }
      setLesson(lesson);
    })();
  }, []);
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">NavHeader</span> <span class="hljs-attr">history</span>=<span class="hljs-string">{props.history}</span>&gt;</span>&#x8BFE;&#x7A0B;&#x8BE6;&#x60C5;<span class="hljs-tag">&lt;/<span class="hljs-name">NavHeader</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Card</span>
        <span class="hljs-attr">hoverable</span>
        <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">width:</span> &quot;<span class="hljs-attr">100</span>%&quot; }}
        <span class="hljs-attr">cover</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">video</span> <span class="hljs-attr">src</span>=<span class="hljs-string">{lesson.video}</span> <span class="hljs-attr">controls</span> <span class="hljs-attr">autoPlay</span>=<span class="hljs-string">{false}</span> /&gt;</span>}
      &gt;
        <span class="hljs-tag">&lt;<span class="hljs-name">Meta</span> <span class="hljs-attr">title</span>=<span class="hljs-string">{lesson.title}</span> <span class="hljs-attr">description</span>=<span class="hljs-string">{</span>&lt;<span class="hljs-attr">p</span>&gt;</span>&#x4EF7;&#x683C;: {lesson.price}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>} /&gt;
      <span class="hljs-tag">&lt;/<span class="hljs-name">Card</span>&gt;</span>
    <span class="hljs-tag">&lt;/&gt;</span></span>
  );
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> connect()(Detail);
</code></pre>
<h2 id="t143&#x7B2C;14&#x7AE0; &#x4E0B;&#x62C9;&#x5237;&#x65B0;">&#x7B2C;14&#x7AE0; &#x4E0B;&#x62C9;&#x5237;&#x65B0; <a href="#t143&#x7B2C;14&#x7AE0; &#x4E0B;&#x62C9;&#x5237;&#x65B0;"> # </a></h2>
<h3 id="t14414.1 &#x53C2;&#x8003;">14.1 &#x53C2;&#x8003; <a href="#t14414.1 &#x53C2;&#x8003;"> # </a></h3>
<h4 id="t14514.1.1 &#x76EE;&#x5F55;&#x7ED3;&#x6784;">14.1.1 &#x76EE;&#x5F55;&#x7ED3;&#x6784; <a href="#t14514.1.1 &#x76EE;&#x5F55;&#x7ED3;&#x6784;"> # </a></h4>
<pre><code class="lang-js">.
&#x251C;&#x2500;&#x2500; package.json
&#x251C;&#x2500;&#x2500; public
&#x2502;   &#x2514;&#x2500;&#x2500; index.html
&#x251C;&#x2500;&#x2500; README.md
&#x251C;&#x2500;&#x2500; src
&#x2502;   &#x251C;&#x2500;&#x2500; api
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; home.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; profile.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; assets
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; css
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; common.less
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; images
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; logo.png
&#x2502;   &#x251C;&#x2500;&#x2500; components
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; NavHeader
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; Tabs
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; routes
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Detail
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Home
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; components
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; HomeHeader
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; HomeSliders
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; LessonList
&#x2502;   &#x2502;   &#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Login
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Mine
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Profile
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; Register
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; store
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; actions
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; home.tsx
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; profile.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; action-types.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; history.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; reducers
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; home.tsx
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; mine.tsx
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; profile.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; typings
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; images.d.ts
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; lesson.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; login-types.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; slider.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; user.tsx
&#x2502;   &#x2514;&#x2500;&#x2500; utils.tsx
&#x251C;&#x2500;&#x2500; tsconfig.json
&#x251C;&#x2500;&#x2500; webpack.config.js
</code></pre>
<h3 id="t14614.2 src\utils.tsx">14.2 src\utils.tsx <a href="#t14614.2 src\utils.tsx"> # </a></h3>
<p>src\utils.tsx</p>
<pre><code class="lang-diff">//element &#x8981;&#x5B9E;&#x73B0;&#x6B64;&#x529F;&#x80FD;DOM&#x5BF9;&#x8C61; callback&#x52A0;&#x8F7D;&#x66F4;&#x591A;&#x7684;&#x65B9;&#x6CD5;
export function loadMore(element: HTMLElement, callback: Function) {
    function _loadMore() {
      let clientHeight = element.clientHeight;
      let scrollTop = element.scrollTop;
      let scrollHeight = element.scrollHeight;
      if (clientHeight + scrollTop + 10 &gt;= scrollHeight) {
        callback();
      }
    }
    element.addEventListener(&quot;scroll&quot;, debounce(_loadMore, 300));
}
export function debounce(fn: any, wait: number) {
  var timeout: any = null;
  return function () {
    if (timeout !== null) clearTimeout(timeout);
    timeout = setTimeout(fn, wait);
  };
}

<span class="hljs-addition">+export function downRefresh(element: HTMLDivElement, callback: Function) {</span>
<span class="hljs-addition">+  let startY: number; //&#x53D8;&#x91CF;&#xFF0C;&#x5B58;&#x50A8;&#x63A5;&#x4E0B;&#x65F6;&#x5019;&#x7684;&#x7EB5;&#x5750;&#x6807;</span>
<span class="hljs-addition">+  let distance: number; //&#x672C;&#x6B21;&#x4E0B;&#x62C9;&#x7684;&#x8DDD;&#x79BB;</span>
<span class="hljs-addition">+  let originalTop = element.offsetTop; //&#x6700;&#x521D;&#x6B64;&#x5143;&#x7D20;&#x8DDD;&#x79BB;&#x9876;&#x90E8;&#x7684;&#x8DDD;&#x79BB; top=50</span>
<span class="hljs-addition">+  let startTop: number;</span>
<span class="hljs-addition">+  let $timer: any = null;</span>
<span class="hljs-addition">+  element.addEventListener(&quot;touchstart&quot;, function (event: TouchEvent) {</span>
<span class="hljs-addition">+    if ($timer) clearInterval($timer);</span>
<span class="hljs-addition">+    let touchMove = throttle(_touchMove, 30);</span>
<span class="hljs-addition">+    //&#x53EA;&#x6709;&#x5F53;&#x6B64;&#x5143;&#x7D20;&#x5904;&#x4E8E;&#x539F;&#x59CB;&#x4F4D;&#x7F6E;&#x624D;&#x80FD;&#x4E0B;&#x62C9;&#xFF0C;&#x5982;&#x679C;&#x5904;&#x4E8E;&#x56DE;&#x5F39;&#x7684;&#x8FC7;&#x7A0B;&#x5219;&#x4E0D;&#x80FD;&#x62C9;&#x4E86;.&#x5E76;&#x4E14;&#x6B64;&#x5143;&#x7D20;&#x5411;&#x4E0A;&#x5377;&#x53BB;&#x7684;&#x9AD8;&#x5EA6;==0</span>
<span class="hljs-addition">+    if (element.scrollTop === 0) {</span>
<span class="hljs-addition">+      startTop = element.offsetTop;</span>
<span class="hljs-addition">+      startY = event.touches[0].pageY; //&#x8BB0;&#x5F55;&#x5F53;&#x524D;&#x70B9;&#x51FB;&#x7684;&#x7EB5;&#x5750;&#x6807;</span>
<span class="hljs-addition">+      element.addEventListener(&quot;touchmove&quot;, touchMove);</span>
<span class="hljs-addition">+      element.addEventListener(&quot;touchend&quot;, touchEnd);</span>
<span class="hljs-addition">+    }</span>
<span class="hljs-addition">+</span>
<span class="hljs-addition">+    function _touchMove(event: TouchEvent) {</span>
<span class="hljs-addition">+      let pageY = event.touches[0].pageY; //&#x62FF;&#x5230;&#x6700;&#x65B0;&#x7684;&#x7EB5;&#x5750;&#x6807;</span>
<span class="hljs-addition">+      if (pageY &gt; startY) {</span>
<span class="hljs-addition">+        distance = pageY - startY;</span>
<span class="hljs-addition">+        element.style.top = startTop + distance + &quot;px&quot;;</span>
<span class="hljs-addition">+      } else {</span>
<span class="hljs-addition">+        element.removeEventListener(&quot;touchmove&quot;, touchMove);</span>
<span class="hljs-addition">+        element.removeEventListener(&quot;touchend&quot;, touchEnd);</span>
<span class="hljs-addition">+      }</span>
<span class="hljs-addition">+    }</span>
<span class="hljs-addition">+</span>
<span class="hljs-addition">+    function touchEnd(_event: TouchEvent) {</span>
<span class="hljs-addition">+      element.removeEventListener(&quot;touchmove&quot;, touchMove);</span>
<span class="hljs-addition">+      element.removeEventListener(&quot;touchend&quot;, touchEnd);</span>
<span class="hljs-addition">+      if (distance &gt; 30) {</span>
<span class="hljs-addition">+        callback();</span>
<span class="hljs-addition">+      }</span>
<span class="hljs-addition">+      function _back(){;</span>
<span class="hljs-addition">+        let currentTop = element.offsetTop;</span>
<span class="hljs-addition">+        if (currentTop - originalTop &gt;= 1) {</span>
<span class="hljs-addition">+          element.style.top = currentTop - 1 + &quot;px&quot;;</span>
<span class="hljs-addition">+          requestAnimationFrame(_back);</span>
<span class="hljs-addition">+        } else {</span>
<span class="hljs-addition">+          element.style.top = originalTop + &quot;px&quot;;</span>
<span class="hljs-addition">+        }</span>
<span class="hljs-addition">+      }</span>
<span class="hljs-addition">+      requestAnimationFrame(_back);</span>
<span class="hljs-addition">+    }</span>
<span class="hljs-addition">+  });</span>
<span class="hljs-addition">+}</span>
<span class="hljs-addition">+</span>
<span class="hljs-addition">+export function throttle(func: any, delay: number) {</span>
<span class="hljs-addition">+  var prev = Date.now();</span>
<span class="hljs-addition">+  return function () {</span>
<span class="hljs-addition">+    var context = this;</span>
<span class="hljs-addition">+    var args = arguments;</span>
<span class="hljs-addition">+    var now = Date.now();</span>
<span class="hljs-addition">+    if (now - prev &gt;= delay) {</span>
<span class="hljs-addition">+      func.apply(context, args);</span>
<span class="hljs-addition">+      prev = Date.now();</span>
<span class="hljs-addition">+    }</span>
<span class="hljs-addition">+  };</span>
<span class="hljs-addition">+}</span>
</code></pre>
<h3 id="t14714.3 action-types.tsx">14.3 action-types.tsx <a href="#t14714.3 action-types.tsx"> # </a></h3>
<p>src\store\action-types.tsx</p>
<pre><code class="lang-diff">export const ADD = &quot;ADD&quot;;
export const SET_CURRENT_CATEGORY = &apos;SET_CURRENT_CATEGORY&apos;;
export const VALIDATE = &apos;VALIDATE&apos;;
export const LOGOUT = &apos;LOGOUT&apos;;
export const CHANGE_AVATAR = &quot;CHANGE_AVATAR&quot;;
export const GET_SLIDERS = &quot;GET_SLIDERS&quot;;
export const GET_LESSONS = &quot;GET_LESSONS&quot;;
export const SET_LESSONS_LOADING = &quot;SET_LESSONS_LOADING&quot;;
export const SET_LESSONS = &quot;SET_LESSONS&quot;;
<span class="hljs-addition">+export const REFRESH_LESSONS = &quot;REFRESH_LESSONS&quot;;</span>
</code></pre>
<h3 id="t14814.4 reducers\home.tsx">14.4 reducers\home.tsx <a href="#t14814.4 reducers\home.tsx"> # </a></h3>
<p>src\store\reducers\home.tsx</p>
<pre><code class="lang-diff">import { AnyAction } from &quot;redux&quot;;
import * as TYPES from &quot;../action-types&quot;;
import Slider from &quot;@/typings/slider&quot;;
import Lesson from &quot;@/typings/Lesson&quot;;
export interface Lessons {
  loading: boolean;
  list: Lesson[];
  hasMore: boolean;
  offset: number;
  limit: number;
}
export interface HomeState {
  currentCategory: string;
  sliders: Slider[];
  lessons: Lessons;
}
let initialState: HomeState = {
  currentCategory: &apos;all&apos;,
  sliders: [],
  lessons: {
    loading: false,
    list: [],
    hasMore: true,
    offset: 0,
    limit: 5,
  },
};
export default function (state: HomeState = initialState, action: AnyAction): HomeState {
  switch (action.type) {
    case TYPES.SET_CURRENT_CATEGORY:
      return { ...state, currentCategory: action.payload };
    case TYPES.GET_SLIDERS:
      return { ...state, sliders: action.payload.data };
    case TYPES.SET_LESSONS_LOADING:
      return {
        ...state,
        lessons: { ...state.lessons, loading: action.payload },
      };
    case TYPES.SET_LESSONS:
      return {
        ...state,
        lessons: {
          ...state.lessons,
          loading: false,
          hasMore: action.payload.hasMore,
          list: [...state.lessons.list, ...action.payload.list],
          offset: state.lessons.offset + action.payload.list.length,
        },
      };
<span class="hljs-addition">+   case TYPES.REFRESH_LESSONS:</span>
<span class="hljs-addition">+       return {</span>
<span class="hljs-addition">+         ...state,</span>
<span class="hljs-addition">+         lessons: {</span>
<span class="hljs-addition">+           ...state.lessons,</span>
<span class="hljs-addition">+           loading: false,</span>
<span class="hljs-addition">+           hasMore: action.payload.hasMore,</span>
<span class="hljs-addition">+           list: action.payload.list,</span>
<span class="hljs-addition">+           offset: action.payload.list.length,</span>
<span class="hljs-addition">+         },</span>
<span class="hljs-addition">+       };</span>
    default:
      return state;
  }
}
</code></pre>
<h3 id="t14914.5 Home\index.tsx">14.5 Home\index.tsx <a href="#t14914.5 Home\index.tsx"> # </a></h3>
<p>src\routes\Home\index.tsx</p>
<pre><code class="lang-diff">import React, { PropsWithChildren, useRef, useEffect } from &quot;react&quot;;
import { connect } from &apos;react-redux&apos;;
import { RouteComponentProps } from &apos;react-router-dom&apos;;
import actions from &apos;@/store/actions/home&apos;;
import HomeHeader from &apos;./components/HomeHeader&apos;;
import { CombinedState } from &apos;@/store/reducers&apos;;
import { HomeState } from &apos;@/store/reducers/home&apos;;
import &apos;./index.less&apos;;
import HomeSliders from &quot;./components/HomeSliders&quot;;
import LessonList from &quot;./components/LessonList&quot;;
<span class="hljs-addition">+import { loadMore,downRefresh} from &quot;@/utils&quot;;</span>
<span class="hljs-addition">+import {Spin} from &apos;antd&apos;;</span>
type StateProps = ReturnType&lt;typeof mapStateToProps&gt;;
type DispatchProps = typeof actions;
interface Params { }
type Props = PropsWithChildren&lt;RouteComponentProps&lt;Params&gt; &amp; StateProps &amp; DispatchProps&gt;;
function Home(props: Props) {
    const homeContainerRef = useRef(null);
    useEffect(() =&gt; {
        loadMore(homeContainerRef.current, props.getLessons);
<span class="hljs-addition">+       downRefresh(homeContainerRef.current, props.refreshLessons);</span>
    }, []);
    return (
        &lt;&gt;
<span class="hljs-addition">+           &lt;Spin size=&quot;large&quot;/&gt;</span>
            &lt;HomeHeader
                currentCategory={props.currentCategory}
                setCurrentCategory={props.setCurrentCategory}
                refreshLessons={props.refreshLessons}
            /&gt;
            &lt;div className=&quot;home-container&quot; ref={homeContainerRef}&gt;
             &lt;HomeSliders sliders={props.sliders} getSliders={props.getSliders} /&gt;
             &lt;LessonList
                  lessons={props.lessons}
                  getLessons={props.getLessons}
             /&gt;
            &lt;/div&gt;
        &lt;/&gt;
    )
}
let mapStateToProps = (state: CombinedState): HomeState =&gt; state.home;
export default connect(
    mapStateToProps,
    actions
)(Home);
</code></pre>
<h3 id="t15014.6 Home\index.less">14.6 Home\index.less <a href="#t15014.6 Home\index.less"> # </a></h3>
<p>src\routes\Home\index.less</p>
<pre><code class="lang-diff"><span class="hljs-addition">+.ant-spin-spinning{</span>
<span class="hljs-addition">+  margin-top:20px;</span>
<span class="hljs-addition">+  margin-left:359px;</span>
<span class="hljs-addition">+}</span>
.home-container {
  position: fixed;
  top: 100px;
  left: 0;
  width: 100%;
  overflow-y: auto;
  height: calc(100vh - 222px);
}
</code></pre>
<h3 id="t15114.7 HomeHeader\index.tsx">14.7 HomeHeader\index.tsx <a href="#t15114.7 HomeHeader\index.tsx"> # </a></h3>
<p>src\routes\Home\components\HomeHeader\index.tsx</p>
<pre><code class="lang-diff">interface Props {
    currentCategory: string;//&#x5F53;&#x524D;&#x9009;&#x4E2D;&#x7684;&#x5206;&#x7C7B; &#x6B64;&#x6570;&#x636E;&#x4F1A;&#x653E;&#x5728;redux&#x4ED3;&#x5E93;&#x4E2D;
    setCurrentCategory: (currentCategory: string) =&gt; any;// &#x6539;&#x53D8;&#x4ED3;&#x5E93;&#x4E2D;&#x7684;&#x5206;&#x7C7B;
<span class="hljs-addition">+   refreshLessons: Function;</span>
}
function HomeHeader(props: Props) {
    let [isMenuVisible, setIsMenuVisible] = useState(false);//&#x8BBE;&#x5B9A;&#x6807;&#x8BC6;&#x4F4D;&#x8868;&#x793A;&#x83DC;&#x5355;&#x662F;&#x5426;&#x663E;&#x793A;
    //&#x8BBE;&#x7F6E;&#x5F53;&#x524D;&#x5206;&#x7C7B;,&#x628A;&#x5F53;&#x524D;&#x9009;&#x4E2D;&#x7684;&#x5206;&#x7C7B;&#x4F20;&#x9012;&#x7ED9;redux&#x4ED3;&#x5E93;
    const setCurrentCategory = (event: React.MouseEvent&lt;HTMLUListElement&gt;) =&gt; {
        let target: HTMLUListElement = event.target as HTMLUListElement;
        let category = target.dataset.category;//&#x83B7;&#x53D6;&#x7528;&#x6237;&#x9009;&#x62E9;&#x7684;&#x5206;&#x7C7B;&#x540D;&#x79F0;
        props.setCurrentCategory(category);//&#x8BBE;&#x7F6E;&#x5206;&#x7C7B;&#x540D;&#x79F0;
<span class="hljs-addition">+       props.refreshLessons();</span>
        setIsMenuVisible(false);//&#x5173;&#x95ED;&#x5206;&#x7C7B;&#x9009;&#x62E9;&#x5C42;
    }
}
export default HomeHeader;
</code></pre>
<h2 id="t152&#x7B2C;15&#x7AE0; &#x865A;&#x62DF;&#x5217;&#x8868;">&#x7B2C;15&#x7AE0; &#x865A;&#x62DF;&#x5217;&#x8868; <a href="#t152&#x7B2C;15&#x7AE0; &#x865A;&#x62DF;&#x5217;&#x8868;"> # </a></h2>
<h3 id="t15315.1 &#x53C2;&#x8003;">15.1 &#x53C2;&#x8003; <a href="#t15315.1 &#x53C2;&#x8003;"> # </a></h3>
<h4 id="t15415.1.1 &#x76EE;&#x5F55;&#x7ED3;&#x6784;">15.1.1 &#x76EE;&#x5F55;&#x7ED3;&#x6784; <a href="#t15415.1.1 &#x76EE;&#x5F55;&#x7ED3;&#x6784;"> # </a></h4>
<pre><code class="lang-js">.
&#x251C;&#x2500;&#x2500; package.json
&#x251C;&#x2500;&#x2500; public
&#x2502;   &#x2514;&#x2500;&#x2500; index.html
&#x251C;&#x2500;&#x2500; README.md
&#x251C;&#x2500;&#x2500; src
&#x2502;   &#x251C;&#x2500;&#x2500; api
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; home.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; profile.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; assets
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; css
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; common.less
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; images
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; logo.png
&#x2502;   &#x251C;&#x2500;&#x2500; components
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; NavHeader
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; Tabs
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; routes
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Detail
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Home
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; components
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; HomeHeader
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; HomeSliders
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; LessonList
&#x2502;   &#x2502;   &#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Login
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Mine
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; Profile
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; Register
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.less
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; index.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; store
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; actions
&#x2502;   &#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; home.tsx
&#x2502;   &#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; profile.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; action-types.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; history.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; reducers
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; home.tsx
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; index.tsx
&#x2502;   &#x2502;       &#x251C;&#x2500;&#x2500; mine.tsx
&#x2502;   &#x2502;       &#x2514;&#x2500;&#x2500; profile.tsx
&#x2502;   &#x251C;&#x2500;&#x2500; typings
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; images.d.ts
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; lesson.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; login-types.tsx
&#x2502;   &#x2502;   &#x251C;&#x2500;&#x2500; slider.tsx
&#x2502;   &#x2502;   &#x2514;&#x2500;&#x2500; user.tsx
&#x2502;   &#x2514;&#x2500;&#x2500; utils.tsx
&#x251C;&#x2500;&#x2500; tsconfig.json
&#x251C;&#x2500;&#x2500; webpack.config.js
</code></pre>
<h4 id="t15515.1.2 Home\index.tsx">15.1.2 Home\index.tsx <a href="#t15515.1.2 Home\index.tsx"> # </a></h4>
<p>src\routes\Home\index.tsx</p>
<pre><code class="lang-diff">import React, { PropsWithChildren, useRef, useEffect } from &quot;react&quot;;
import { connect } from &apos;react-redux&apos;;
import { RouteComponentProps } from &apos;react-router-dom&apos;;
import actions from &apos;@/store/actions/home&apos;;
import HomeHeader from &apos;./components/HomeHeader&apos;;
import { CombinedState } from &apos;@/store/reducers&apos;;
import { HomeState } from &apos;@/store/reducers/home&apos;;
import &apos;./index.less&apos;;
import HomeSliders from &quot;./components/HomeSliders&quot;;
import LessonList from &quot;./components/LessonList&quot;;
<span class="hljs-addition">+import { loadMore,downRefresh,debounce, throttle} from &quot;@/utils&quot;;</span>
import {Spin} from &apos;antd&apos;;
type StateProps = ReturnType&lt;typeof mapStateToProps&gt;;
type DispatchProps = typeof actions;
interface Params { }
type Props = PropsWithChildren&lt;RouteComponentProps&lt;Params&gt; &amp; StateProps &amp; DispatchProps&gt;;
function Home(props: Props) {
    const homeContainerRef = useRef(null);
<span class="hljs-addition">+   const lessonListRef = useRef(null);</span>
    useEffect(() =&gt; {
        loadMore(homeContainerRef.current, props.getLessons);
        downRefresh(homeContainerRef.current, props.refreshLessons);
<span class="hljs-addition">+       lessonListRef.current();</span>
<span class="hljs-addition">+       homeContainerRef.current.addEventListener(&quot;scroll&quot;, throttle(lessonListRef.current,13));</span>
    }, []);
    return (
        &lt;&gt;
            &lt;Spin size=&quot;large&quot;/&gt;
            &lt;HomeHeader
                currentCategory={props.currentCategory}
                setCurrentCategory={props.setCurrentCategory}
                refreshLessons={props.refreshLessons}
            /&gt;
            &lt;div className=&quot;home-container&quot; ref={homeContainerRef}&gt;
             &lt;HomeSliders sliders={props.sliders} getSliders={props.getSliders} /&gt;
             &lt;LessonList
                  lessons={props.lessons}
                  getLessons={props.getLessons}
<span class="hljs-addition">+                 ref={lessonListRef}</span>
<span class="hljs-addition">+                 homeContainerRef={homeContainerRef}</span>
             /&gt;
            &lt;/div&gt;
        &lt;/&gt;
    )
}
let mapStateToProps = (state: CombinedState): HomeState =&gt; state.home;
export default connect(
    mapStateToProps,
    actions
)(Home);
</code></pre>
<h4 id="t15615.1.3 LessonList\index.tsx">15.1.3 LessonList\index.tsx <a href="#t15615.1.3 LessonList\index.tsx"> # </a></h4>
<p>src\routes\Home\components\LessonList\index.tsx</p>
<pre><code class="lang-diff">import React, { useEffect, forwardRef, useState } from &quot;react&quot;;
import &quot;./index.less&quot;;
import { Card, Skeleton, Button, Alert, Menu } from &quot;antd&quot;;
import { Link } from &quot;react-router-dom&quot;;
import Lesson from &quot;@/typings/lesson&quot;;
import { MenuOutlined } from &quot;@ant-design/icons&quot;;
interface Props {
  children?: any;
  lessons?: any;
  getLessons?: any;
<span class="hljs-addition">+ homeContainerRef: any</span>
}
<span class="hljs-addition">+interface VisibleLesson extends Lesson {</span>
<span class="hljs-addition">+  index: number</span>
<span class="hljs-addition">+}</span>
function LessonList(props: Props, lessonListRef: any) {
<span class="hljs-addition">+  const [, forceUpdate] = React.useReducer(x =&gt; x + 1, 0);</span>
  useEffect(() =&gt; {
    if (props.lessons.list.length == 0) {
      props.getLessons();
    }
<span class="hljs-addition">+   lessonListRef.current = forceUpdate;</span>
  }, []);
<span class="hljs-addition">+  const remSize: number = parseFloat(document.documentElement.style.fontSize);</span>
<span class="hljs-addition">+  const itemSize: number = (650 / 75) * remSize;</span>
<span class="hljs-addition">+  const screenHeight = window.innerHeight - (222 / 75) * remSize;</span>
<span class="hljs-addition">+  const homeContainer = props.homeContainerRef.current;</span>
<span class="hljs-addition">+  let start = 0, end = 0;</span>
<span class="hljs-addition">+  if (homeContainer) {</span>
<span class="hljs-addition">+    const scrollTop = homeContainer.scrollTop;</span>
<span class="hljs-addition">+    start = Math.floor(scrollTop / itemSize);</span>
<span class="hljs-addition">+    end = start + Math.floor(screenHeight / itemSize);</span>
<span class="hljs-addition">+    start-=2,end+=2;</span>
<span class="hljs-addition">+    start = start &lt; 0 ? 0 : start;</span>
<span class="hljs-addition">+    end = end &gt; props.lessons.list.length ? props.lessons.list.length : end;</span>
<span class="hljs-addition">+  }</span>
<span class="hljs-addition">+  const visibleList: Array&lt;VisibleLesson&gt; = props.lessons.list.map((item: Lesson, index: number) =&gt; ({ ...item, index })).slice(start, end);</span>
<span class="hljs-addition">+  const style: React.CSSProperties = { position: &apos;absolute&apos;, top: 0, left: 0, width: &apos;100%&apos;, height: itemSize };</span>
<span class="hljs-addition">+  const bottomTop = (props.lessons.list.length)*itemSize;</span>
<span class="hljs-addition">+  return (</span>
<span class="hljs-addition">+    &lt;section className=&quot;lesson-list&quot;&gt;</span>
      &lt;Skeleton
        loading={props.lessons.list.length == 0 &amp;&amp; props.lessons.loading}
        active
        paragraph={{ rows: 8 }}
      &gt;
<span class="hljs-addition">+      &lt;h2&gt;</span>
<span class="hljs-addition">+        &lt;MenuOutlined /&gt; &#x5168;&#x90E8;&#x8BFE;&#x7A0B;</span>
<span class="hljs-addition">+      &lt;/h2&gt;</span>
<span class="hljs-addition">+      &lt;div style={{position:&apos;relative&apos;, width: &apos;100%&apos;, height: `${props.lessons.list.length * itemSize}px`}}&gt;</span>
<span class="hljs-addition">+       {</span>
<span class="hljs-addition">+         visibleList.map((lesson: VisibleLesson) =&gt; (</span>
<span class="hljs-addition">+           &lt;Link</span>
<span class="hljs-addition">+             key={lesson.id}</span>
<span class="hljs-addition">+             style={{ ...style, top: `${itemSize * lesson.index}px` }}</span>
<span class="hljs-addition">+             to={{ pathname: `/detail/${lesson.id}`, state: lesson }}</span>
<span class="hljs-addition">+           &gt;</span>
<span class="hljs-addition">+             &lt;Card</span>
<span class="hljs-addition">+               hoverable={true}</span>
<span class="hljs-addition">+               cover={&lt;img alt={lesson.title} src={lesson.poster} /&gt;}</span>
<span class="hljs-addition">+             &gt;</span>
<span class="hljs-addition">+               &lt;Card.Meta</span>
<span class="hljs-addition">+                 title={lesson.title}</span>
<span class="hljs-addition">+                 description={`&#x4EF7;&#x683C;: &#xA5;${lesson.price}&#x5143;`}</span>
<span class="hljs-addition">+               /&gt;</span>
<span class="hljs-addition">+             &lt;/Card&gt;</span>
<span class="hljs-addition">+           &lt;/Link&gt;</span>
<span class="hljs-addition">+         ))</span>
<span class="hljs-addition">+       }</span>
       {props.lessons.hasMore ? (
         &lt;Button
<span class="hljs-addition">+          style={{ textAlign: &quot;center&quot; ,top: `${bottomTop}px`}}</span>
            onClick={props.getLessons}
            loading={props.lessons.loading}
            type=&quot;primary&quot;
            block
          &gt;
            {props.lessons.loading ? &quot;&quot; : &quot;&#x52A0;&#x8F7D;&#x66F4;&#x591A;&quot;}
          &lt;/Button&gt;
        ) : (
            &lt;Alert
<span class="hljs-addition">+             style={{ textAlign: &quot;center&quot;,top: `${bottomTop}px` }}</span>
              message=&quot;&#x5230;&#x5E95;&#x4E86;&quot;
              type=&quot;warning&quot;
            /&gt;
          )}
      &lt;/div&gt;
      &lt;/Skeleton&gt;
    &lt;/section&gt;
  );
}
<span class="hljs-addition">+export default React.forwardRef(LessonList);</span>
</code></pre>
<h2 id="t157&#x7B2C;16&#x7AE0; &#x8DEF;&#x7531;&#x61D2;&#x52A0;&#x8F7D;">&#x7B2C;16&#x7AE0; &#x8DEF;&#x7531;&#x61D2;&#x52A0;&#x8F7D; <a href="#t157&#x7B2C;16&#x7AE0; &#x8DEF;&#x7531;&#x61D2;&#x52A0;&#x8F7D;"> # </a></h2>
<h3 id="t15816.1 src\index.tsx">16.1 src\index.tsx <a href="#t15816.1 src\index.tsx"> # </a></h3>
<pre><code class="lang-diff">import React from &quot;react&quot;;
import ReactDOM from &quot;react-dom&quot;;
import { Switch, Route, Redirect } from &quot;react-router-dom&quot;;
import { Provider } from &quot;react-redux&quot;;
import store from &quot;./store&quot;;
import { ConfigProvider } from &quot;antd&quot;;
import zh_CN from &quot;antd/lib/locale-provider/zh_CN&quot;;
import &quot;./assets/css/common.less&quot;;
import Tabs from &quot;./components/Tabs&quot;;
import {Spin} from &apos;antd&apos;;
<span class="hljs-addition">+const Home = React.lazy(() =&gt; import(&quot;./routes/Home&quot;));</span>
<span class="hljs-addition">+const Mine = React.lazy(() =&gt; import(&quot;./routes/Mine&quot;));</span>
<span class="hljs-addition">+const Profile = React.lazy(() =&gt; import(&quot;./routes/Profile&quot;));</span>
<span class="hljs-addition">+const Register = React.lazy(() =&gt; import(&quot;./routes/Register&quot;));</span>
<span class="hljs-addition">+const Login = React.lazy(() =&gt; import(&quot;./routes/Login&quot;));</span>
<span class="hljs-addition">+const Detail = React.lazy(() =&gt; import(&quot;./routes/Detail&quot;));</span>
import { ConnectedRouter } from &quot;connected-react-router&quot;;
import history from &quot;./store/history&quot;;
ReactDOM.render(
  &lt;Provider store={store}&gt;
    &lt;ConnectedRouter history={history}&gt;
      &lt;ConfigProvider locale={zh_CN}&gt;
<span class="hljs-addition">+      &lt;React.Suspense fallback={&lt;Spin /&gt;}&gt;</span>
        &lt;main className=&quot;main-container&quot;&gt;
          &lt;Switch&gt;
            &lt;Route path=&quot;/&quot; exact component={Home} /&gt;
            &lt;Route path=&quot;/Mine&quot; component={Mine} /&gt;
            &lt;Route path=&quot;/profile&quot; component={Profile} /&gt;
            &lt;Route path=&quot;/register&quot; component={Register} /&gt;
            &lt;Route path=&quot;/login&quot; component={Login} /&gt;
            &lt;Route path=&quot;/detail/:id&quot; component={Detail} /&gt;
            &lt;Redirect to=&quot;/&quot; /&gt;
          &lt;/Switch&gt;
        &lt;/main&gt;
        &lt;Tabs /&gt;
<span class="hljs-addition">+       &lt;/React.Suspense&gt;</span>
      &lt;/ConfigProvider&gt;
    &lt;/ConnectedRouter&gt;
  &lt;/Provider&gt;,
  document.getElementById(&quot;root&quot;)
);
</code></pre>
<h2 id="t159&#x7B2C;17&#x7AE0; &#x8D2D;&#x7269;&#x8F66;">&#x7B2C;17&#x7AE0; &#x8D2D;&#x7269;&#x8F66; <a href="#t159&#x7B2C;17&#x7AE0; &#x8D2D;&#x7269;&#x8F66;"> # </a></h2>
<ul>
<li>redux-immer</li>
<li>redux-persist</li>
</ul>
<h3 id="t16017.1   src\index.tsx">17.1   src\index.tsx <a href="#t16017.1   src\index.tsx"> # </a></h3>
<p>src\index.tsx</p>
<pre><code class="lang-diff">import React from &quot;react&quot;;
import ReactDOM from &quot;react-dom&quot;;
import { Switch, Route, Redirect } from &quot;react-router-dom&quot;;
import { Provider } from &quot;react-redux&quot;;
<span class="hljs-addition">+import {store,persistor} from &quot;./store&quot;;</span>
import &quot;./assets/css/common.less&quot;;
import Tabs from &quot;./components/Tabs&quot;;
import {Spin} from &apos;antd&apos;;
const Home = React.lazy(() =&gt; import(&quot;./routes/Home&quot;));
const Profile = React.lazy(() =&gt; import(&quot;./routes/Profile&quot;));
const Register = React.lazy(() =&gt; import(&quot;./routes/Register&quot;));
const Login = React.lazy(() =&gt; import(&quot;./routes/Login&quot;));
const Detail = React.lazy(() =&gt; import(&quot;./routes/Detail&quot;));
<span class="hljs-addition">+const Cart = React.lazy(() =&gt; import(&quot;./routes/Cart&quot;));</span>
<span class="hljs-addition">+import { PersistGate } from &apos;redux-persist/integration/react&apos;</span>
import { ConnectedRouter } from &quot;connected-react-router&quot;;

import history from &quot;./store/history&quot;;
ReactDOM.render(
  &lt;Provider store={store}&gt;
<span class="hljs-addition">+   &lt;PersistGate loading={&lt;Spin /&gt;} persistor={persistor}&gt;</span>
    &lt;ConnectedRouter history={history}&gt;
       &lt;React.Suspense fallback={&lt;Spin /&gt;}&gt;
        &lt;main className=&quot;main-container&quot;&gt;
          &lt;Switch&gt;
            &lt;Route path=&quot;/&quot; exact component={Home} /&gt;
<span class="hljs-addition">+           &lt;Route path=&quot;/cart&quot; component={Cart} /&gt;</span>
            &lt;Route path=&quot;/profile&quot; component={Profile} /&gt;
            &lt;Route path=&quot;/register&quot; component={Register} /&gt;
            &lt;Route path=&quot;/login&quot; component={Login} /&gt;
            &lt;Route path=&quot;/detail/:id&quot; component={Detail} /&gt;
            &lt;Redirect to=&quot;/&quot; /&gt;
          &lt;/Switch&gt;
        &lt;/main&gt;
        &lt;Tabs /&gt;
        &lt;/React.Suspense&gt;
    &lt;/ConnectedRouter&gt;
<span class="hljs-addition">+   &lt;/PersistGate&gt;</span>
  &lt;/Provider&gt;,
  document.getElementById(&quot;root&quot;)
);
</code></pre>
<h3 id="t16117.2 Detail\index.tsx">17.2 Detail\index.tsx <a href="#t16117.2 Detail\index.tsx"> # </a></h3>
<p>src\routes\Detail\index.tsx</p>
<pre><code class="lang-diff"><span class="hljs-addition">+import React, { useState, useEffect,PropsWithChildren } from &quot;react&quot;;</span>
import { connect } from &quot;react-redux&quot;;
import { Card, Button } from &quot;antd&quot;;
import NavHeader from &quot;@/components/NavHeader&quot;;
import { getLesson } from &quot;@/api/home&quot;;
import { RouteComponentProps } from &quot;react-router&quot;;
import Lesson from &quot;@/typings/lesson&quot;;
import { StaticContext } from &quot;react-router&quot;;
import { LessonResult } from &quot;@/typings/lesson&quot;;
<span class="hljs-addition">+import { CombinedState } from &apos;@/store/reducers&apos;;</span>
<span class="hljs-addition">+import actions from &apos;@/store/actions/cart&apos;;</span>
const { Meta } = Card;
interface Params {
  id: string;
}
<span class="hljs-addition">+type RouteProps = RouteComponentProps&lt;Params, StaticContext, Lesson&gt;;</span>
<span class="hljs-addition">+type StateProps = ReturnType&lt;typeof mapStateToProps&gt;;</span>
<span class="hljs-addition">+type DispatchProps = typeof actions;</span>
<span class="hljs-addition">+type Props = PropsWithChildren&lt;RouteProps &amp; StateProps &amp; DispatchProps&gt;;</span>

function Detail(props: Props) {
  let [lesson, setLesson] = useState&lt;Lesson&gt;({} as Lesson);
  useEffect(() =&gt; {
    (async () =&gt; {
      let lesson: Lesson = props.location.state;
      if (!lesson) {
        let id = props.match.params.id;
        let result: LessonResult = await getLesson&lt;LessonResult&gt;(id);
        if (result.success) lesson = result.data;
      }
      setLesson(lesson);
    })();
  }, []);
<span class="hljs-addition">+ const addCartItem = (lesson: Lesson) =&gt; {</span>
<span class="hljs-addition">+  //https://developer.mozilla.org/zh-CN/docs/Web/API/Element/getBoundingClientRect</span>
<span class="hljs-addition">+  let video: HTMLVideoElement = document.querySelector(&apos;#lesson-video&apos;);</span>
<span class="hljs-addition">+  let cart: HTMLSpanElement = document.querySelector(&apos;.anticon.anticon-shopping-cart&apos;);</span>
<span class="hljs-addition">+  let clonedVideo: HTMLVideoElement = video.cloneNode(true) as HTMLVideoElement;</span>
<span class="hljs-addition">+  let videoWith = video.offsetWidth;</span>
<span class="hljs-addition">+  let videoHeight = video.offsetHeight;</span>
<span class="hljs-addition">+  let cartWith = cart.offsetWidth;</span>
<span class="hljs-addition">+  let cartHeight = cart.offsetHeight;</span>
<span class="hljs-addition">+  let videoLeft = video.getBoundingClientRect().left;</span>
<span class="hljs-addition">+  let videoTop = video.getBoundingClientRect().top;</span>
<span class="hljs-addition">+  let cartRight = cart.getBoundingClientRect().right;</span>
<span class="hljs-addition">+  let cartBottom = cart.getBoundingClientRect().bottom;</span>
<span class="hljs-addition">+  clonedVideo.style.cssText = `</span>
<span class="hljs-addition">+    z-index: 1000;</span>
<span class="hljs-addition">+    opacity:0.8;</span>
<span class="hljs-addition">+    position:fixed;</span>
<span class="hljs-addition">+    width:${videoWith}px;</span>
<span class="hljs-addition">+    height:${videoHeight}px;</span>
<span class="hljs-addition">+    top:${videoTop}px;</span>
<span class="hljs-addition">+    left:${videoLeft}px;</span>
<span class="hljs-addition">+    transition: all 2s ease-in-out;</span>
<span class="hljs-addition">+  `;</span>
<span class="hljs-addition">+  document.body.appendChild(clonedVideo);</span>
<span class="hljs-addition">+  setTimeout(function () {</span>
<span class="hljs-addition">+      clonedVideo.style.left = (cartRight - (cartWith / 2)) + &apos;px&apos;;</span>
<span class="hljs-addition">+      clonedVideo.style.top = (cartBottom - (cartHeight / 2)) + &apos;px&apos;;</span>
<span class="hljs-addition">+      clonedVideo.style.width = `0px`;</span>
<span class="hljs-addition">+      clonedVideo.style.height = `0px`;</span>
<span class="hljs-addition">+      clonedVideo.style.opacity = &apos;50&apos;;</span>
<span class="hljs-addition">+  }, 0);</span>
<span class="hljs-addition">+  props.addCartItem(lesson);</span>
<span class="hljs-addition">+ }</span>
  return (
    &lt;&gt;
      &lt;NavHeader history={props.history}&gt;&#x8BFE;&#x7A0B;&#x8BE6;&#x60C5;&lt;/NavHeader&gt;
      &lt;Card
        hoverable
        style={{ width: &quot;100%&quot; }}
<span class="hljs-addition">+       cover={&lt;video src={lesson.video} id=&quot;lesson-video&quot; controls autoPlay={false} /&gt;}</span>
      &gt;
        &lt;Meta title={lesson.title} description={
<span class="hljs-addition">+         &lt;&gt;</span>
<span class="hljs-addition">+           &lt;p&gt;&#x4EF7;&#x683C;: {lesson.price}&lt;/p&gt;</span>
<span class="hljs-addition">+           &lt;p&gt;</span>
<span class="hljs-addition">+             &lt;Button </span>
<span class="hljs-addition">+               className=&quot;add-cart&quot;</span>
<span class="hljs-addition">+               onClick={() =&gt; addCartItem(lesson)}</span>
<span class="hljs-addition">+             &gt;&#x52A0;&#x5165;&#x8D2D;&#x7269;&#x8F66;&lt;/Button&gt;&lt;/p&gt;</span>
<span class="hljs-addition">+         &lt;/&gt;</span>
<span class="hljs-addition">+       } /&gt;</span>
<span class="hljs-addition">+     &lt;/Card&gt;</span>
<span class="hljs-addition">+   &lt;/&gt;</span>
  );
}
<span class="hljs-addition">+let mapStateToProps = (state: CombinedState): CombinedState =&gt; state;</span>
export default connect(
<span class="hljs-addition">+  mapStateToProps,</span>
<span class="hljs-addition">+  actions</span>
)(Detail);
</code></pre>
<h3 id="t16217.3 action-types.tsx">17.3 action-types.tsx <a href="#t16217.3 action-types.tsx"> # </a></h3>
<p>src\store\action-types.tsx</p>
<pre><code class="lang-diff">export const ADD = &quot;ADD&quot;;

export const SET_CURRENT_CATEGORY = &apos;SET_CURRENT_CATEGORY&apos;;

export const VALIDATE = &apos;VALIDATE&apos;;

export const LOGOUT = &apos;LOGOUT&apos;;

export const CHANGE_AVATAR = &quot;CHANGE_AVATAR&quot;;

export const GET_SLIDERS = &quot;GET_SLIDERS&quot;;


export const GET_LESSONS = &quot;GET_LESSONS&quot;;
export const SET_LESSONS_LOADING = &quot;SET_LESSONS_LOADING&quot;;
export const SET_LESSONS = &quot;SET_LESSONS&quot;;
export const REFRESH_LESSONS = &quot;REFRESH_LESSONS&quot;;


<span class="hljs-addition">+export const ADD_CART_ITEM = &apos;ADD_CART_ITEM&apos;;//&#x5411;&#x8D2D;&#x7269;&#x8F66;&#x4E2D;&#x589E;&#x4E00;&#x4E2A;&#x5546;&#x54C1;</span>
<span class="hljs-addition">+export const REMOVE_CART_ITEM = &apos;REMOVE_CART_ITEM&apos;;//&#x4ECE;&#x8D2D;&#x7269;&#x8F66;&#x4E2D;&#x5220;&#x9664;&#x4E00;&#x4E2A;&#x5546;&#x54C1;</span>
<span class="hljs-addition">+export const CLEAR_CART_ITEMS = &apos;CLEAR_CART_ITEMS&apos;;//&#x6E05;&#x7A7A;&#x8D2D;&#x7269;&#x8F66;</span>
<span class="hljs-addition">+export const CHANGE_CART_ITEM_COUNT = &apos;CHANGE_CART_ITEM_COUNT&apos;;//&#x76F4;&#x63A5;&#x4FEE;&#x6539;&#x8D2D;&#x7269;&#x8F66;&#x5546;&#x54C1;&#x7684;&#x6570;&#x91CF;&#x51CF;1</span>
<span class="hljs-addition">+export const CHANGE_CHECKED_CART_ITEMS = &apos;CHANGE_CHECKED_CART_ITEMS&apos;;//&#x9009;&#x4E2D;&#x5546;&#x54C1;</span>
<span class="hljs-addition">+export const SETTLE = &apos;SETTLE&apos;;//&#x7ED3;&#x7B97;</span>
</code></pre>
<h3 id="t16317.4 typings\cart.tsx">17.4 typings\cart.tsx <a href="#t16317.4 typings\cart.tsx"> # </a></h3>
<p>src\typings\cart.tsx</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> { Lesson } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;./lesson&quot;</span>;
<span class="hljs-keyword">export</span> interface CartItem {
  <span class="hljs-attr">lesson</span>: Lesson;
  count: number;
  checked: boolean;
}
<span class="hljs-keyword">export</span> type CartState = CartItem[];
</code></pre>
<h3 id="t16417.5 cart.tsx">17.5 cart.tsx <a href="#t16417.5 cart.tsx"> # </a></h3>
<p>src\store\reducers\cart.tsx</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> { AnyAction } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;redux&quot;</span>;
<span class="hljs-keyword">import</span> { CartState } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/typings/cart&quot;</span>;
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> actionTypes <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/store/action-types&quot;</span>;
<span class="hljs-keyword">let</span> initialState: CartState = [];
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">
  state: CartState = initialState,
  action: AnyAction
</span>): <span class="hljs-title">CartState</span> </span>{
  <span class="hljs-keyword">switch</span> (action.type) {
    <span class="hljs-keyword">case</span> actionTypes.ADD_CART_ITEM:<span class="hljs-comment">//&#x589E;&#x52A0;&#x6761;&#x76EE;</span>
      <span class="hljs-keyword">let</span> oldIndex = state.findIndex(
        <span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.lesson.id === action.payload.id
      );
      <span class="hljs-keyword">if</span> (oldIndex == <span class="hljs-number">-1</span>) {
        state.push({
          <span class="hljs-attr">checked</span>: <span class="hljs-literal">false</span>,
          <span class="hljs-attr">count</span>: <span class="hljs-number">1</span>,
          <span class="hljs-attr">lesson</span>: action.payload,
        });
      } <span class="hljs-keyword">else</span> {
        state[oldIndex].count +=<span class="hljs-number">1</span>;
      }
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> actionTypes.REMOVE_CART_ITEM:
      <span class="hljs-keyword">let</span> removeIndex = state.findIndex(
        <span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.lesson.id === action.payload
      );
      state.splice(removeIndex,<span class="hljs-number">1</span>);
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> actionTypes.CLEAR_CART_ITEMS:
      state.length = <span class="hljs-number">0</span>;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> actionTypes.CHANGE_CART_ITEM_COUNT:
      <span class="hljs-keyword">let</span> index = state.findIndex(
        <span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> item.lesson.id === action.payload.id
      );
      state[index].count=action.payload.count;
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> actionTypes.CHANGE_CHECKED_CART_ITEMS:
      <span class="hljs-keyword">let</span> checkedIds = action.payload;
      state.forEach(<span class="hljs-function">(<span class="hljs-params">item:any</span>)=&gt;</span>{
        <span class="hljs-keyword">if</span>(checkedIds.includes(item.lesson.id)){
          item.checked =<span class="hljs-literal">true</span>;
        }
      });
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">case</span> actionTypes.SETTLE:
      state = state.filter(<span class="hljs-function">(<span class="hljs-params">item</span>) =&gt;</span> !item.checked);
      <span class="hljs-keyword">break</span>;
    <span class="hljs-keyword">default</span>:
      <span class="hljs-keyword">break</span>;
  }
    <span class="hljs-keyword">return</span> state;
}
</code></pre>
<h3 id="t16517.6 reducers\home.tsx">17.6 reducers\home.tsx <a href="#t16517.6 reducers\home.tsx"> # </a></h3>
<p>src\store\reducers\home.tsx</p>
<pre><code class="lang-diff">import { AnyAction } from &quot;redux&quot;;
import * as TYPES from &quot;../action-types&quot;;
import Slider from &quot;@/typings/slider&quot;;
import Lesson from &quot;@/typings/Lesson&quot;;
export interface Lessons {
  loading: boolean;
  list: Lesson[];
  hasMore: boolean;
  offset: number;
  limit: number;
}
export interface HomeState {
  currentCategory: string;
  sliders: Slider[];
  lessons: Lessons;
}
let initialState: HomeState = {
  currentCategory: &apos;all&apos;,
  sliders: [],
  lessons: {
    loading: false,
    list: [],
    hasMore: true,
    offset: 0,
    limit: 5,
  },
};
export default function (state: HomeState = initialState, action: AnyAction): HomeState {
<span class="hljs-addition">+ switch (action.type) {</span>
<span class="hljs-addition">+   case TYPES.SET_CURRENT_CATEGORY:</span>
<span class="hljs-addition">+     state.currentCategory=action.payload;</span>
<span class="hljs-addition">+     break;</span>
<span class="hljs-addition">+   case TYPES.GET_SLIDERS:</span>
<span class="hljs-addition">+     state.sliders = action.payload.data;</span>
<span class="hljs-addition">+     break;</span>
<span class="hljs-addition">+   case TYPES.SET_LESSONS_LOADING:</span>
<span class="hljs-addition">+     state.lessons.loading = action.payload;</span>
<span class="hljs-addition">+     break;</span>
<span class="hljs-addition">+   case TYPES.SET_LESSONS:</span>
<span class="hljs-addition">+     state.lessons.loading = false;</span>
<span class="hljs-addition">+     state.lessons.hasMore =  action.payload.hasMore;</span>
<span class="hljs-addition">+     state.lessons.list=[...state.lessons.list,...action.payload.list];</span>
<span class="hljs-addition">+     state.lessons.offset += action.payload.list.length;</span>
<span class="hljs-addition">+     break;</span>
<span class="hljs-addition">+   case TYPES.REFRESH_LESSONS:</span>
<span class="hljs-addition">+     state.lessons.loading = false;</span>
<span class="hljs-addition">+     state.lessons.hasMore =  action.payload.hasMore;</span>
<span class="hljs-addition">+     state.lessons.list=action.payload.list;</span>
<span class="hljs-addition">+     state.lessons.offset = action.payload.list.length;</span>
<span class="hljs-addition">+     break;</span>
<span class="hljs-addition">+   default:</span>
<span class="hljs-addition">+     break;</span>
<span class="hljs-addition">+  }</span>
<span class="hljs-addition">+   return state;</span>
}
</code></pre>
<h3 id="t16617.7 reducers\index.tsx">17.7 reducers\index.tsx <a href="#t16617.7 reducers\index.tsx"> # </a></h3>
<p>src\store\reducers\index.tsx</p>
<pre><code class="lang-diff">import { ReducersMapObject, Reducer } from &apos;redux&apos;;
import { connectRouter } from &apos;connected-react-router&apos;;
import history from &apos;../history&apos;;
import home from &apos;./home&apos;;
import mine from &apos;./mine&apos;;
import profile from &apos;./profile&apos;;
<span class="hljs-addition">+import cart from &apos;./cart&apos;;</span>
<span class="hljs-addition">+import { combineReducers } from &apos;redux-immer&apos;;</span>
<span class="hljs-addition">+import produce from &apos;immer&apos;;</span>
let reducers: ReducersMapObject = {
    router: connectRouter(history),
    home,
    mine,
    profile,
<span class="hljs-addition">+   cart</span>
};
type CombinedState = {
    [key in keyof typeof reducers]: ReturnType&lt;typeof reducers[key]&gt;
}
<span class="hljs-addition">+let reducer: Reducer&lt;CombinedState&gt; = combineReducers(produce,reducers);</span>

export { CombinedState }
export default reducer;
</code></pre>
<h3 id="t16717.8 store\index.tsx">17.8 store\index.tsx <a href="#t16717.8 store\index.tsx"> # </a></h3>
<p>src\store\index.tsx</p>
<pre><code class="lang-diff">import { createStore, applyMiddleware} from &apos;redux&apos;;
import reducers from &apos;./reducers&apos;;
import logger from &apos;redux-logger&apos;;
import thunk from &apos;redux-thunk&apos;;
import promise from &apos;redux-promise&apos;;
import { routerMiddleware } from &apos;connected-react-router&apos;;
<span class="hljs-addition">+import { persistStore, persistReducer } from &apos;redux-persist&apos;;</span>
<span class="hljs-addition">+import storage from &apos;redux-persist/lib/storage&apos;;</span>
import history from &apos;./history&apos;;
<span class="hljs-addition">+const persistConfig = {</span>
<span class="hljs-addition">+  key: &apos;root&apos;,</span>
<span class="hljs-addition">+  storage,</span>
<span class="hljs-addition">+  whitelist: [&apos;cart&apos;]</span>
<span class="hljs-addition">+}</span>
<span class="hljs-addition">+const persistedReducer = persistReducer(persistConfig, reducers)</span>

<span class="hljs-addition">+let store = applyMiddleware(thunk, routerMiddleware(history), promise, logger)(createStore)(persistedReducer);</span>
<span class="hljs-addition">+let persistor = persistStore(store);</span>
<span class="hljs-addition">+export  { store, persistor };</span>
</code></pre>
<h3 id="t16817.9 actions\cart.tsx">17.9 actions\cart.tsx <a href="#t16817.9 actions\cart.tsx"> # </a></h3>
<p>src\store\actions\cart.tsx</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> actionTypes <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../action-types&quot;</span>;
<span class="hljs-keyword">import</span> { Lesson } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/typings/lesson&quot;</span>;
<span class="hljs-keyword">import</span> { message } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;antd&quot;</span>;
<span class="hljs-keyword">import</span> { push } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;connected-react-router&quot;</span>;
<span class="hljs-keyword">import</span> { StoreGetState, StoreDispatch } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;../index&quot;</span>;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> {
  addCartItem(lesson: Lesson) {
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">dispatch: StoreDispatch</span>) </span>{
      dispatch({
        <span class="hljs-attr">type</span>: actionTypes.ADD_CART_ITEM,
        <span class="hljs-attr">payload</span>: lesson,
      });
      message.info(<span class="hljs-string">&quot;&#x6DFB;&#x52A0;&#x8BFE;&#x7A0B;&#x6210;&#x529F;&quot;</span>);
    };
  },
  removeCartItem(id: string) {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">type</span>: actionTypes.REMOVE_CART_ITEM,
      <span class="hljs-attr">payload</span>: id,
    };
  },
  clearCartItems() {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">type</span>: actionTypes.CLEAR_CART_ITEMS,
    };
  },
  changeCartItemCount(id: string, <span class="hljs-attr">count</span>: number) {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">type</span>: actionTypes.CHANGE_CART_ITEM_COUNT,
      <span class="hljs-attr">payload</span>: {
        id,
        count,
      },
    };
  },
  changeCheckedCartItems(checkedIds: string[]) {
    <span class="hljs-keyword">return</span> {
      <span class="hljs-attr">type</span>: actionTypes.CHANGE_CHECKED_CART_ITEMS,
      <span class="hljs-attr">payload</span>: checkedIds,
    };
  },
  settle() {
    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">dispatch: StoreDispatch, getState: StoreGetState</span>) </span>{
      dispatch({
        <span class="hljs-attr">type</span>: actionTypes.SETTLE,
      });
      dispatch(push(<span class="hljs-string">&quot;/&quot;</span>));
    };
  },
};
</code></pre>
<h3 id="t16917.10 Cart\index.tsx">17.10 Cart\index.tsx <a href="#t16917.10 Cart\index.tsx"> # </a></h3>
<p>src\routes\Cart\index.tsx</p>
<pre><code class="lang-js"><span class="hljs-keyword">import</span> React, { PropsWithChildren, useState } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react&quot;</span>;
<span class="hljs-keyword">import</span> { connect } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-redux&quot;</span>;
<span class="hljs-keyword">import</span> { RouteComponentProps } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-router-dom&quot;</span>;
<span class="hljs-keyword">import</span> {
  Table,
  Button,
  InputNumber,
  Popconfirm,
  Icon,
  Row,
  Col,
  Badge,
  Modal,
} <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;antd&quot;</span>;
<span class="hljs-keyword">import</span> { CombinedState } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/store/reducers&quot;</span>;
<span class="hljs-keyword">import</span> NavHeader <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/components/NavHeader&quot;</span>;
<span class="hljs-keyword">import</span> { Lesson } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/typings/lesson&quot;</span>;
<span class="hljs-keyword">import</span> { StaticContext } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;react-router&quot;</span>;
<span class="hljs-keyword">import</span> actions <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/store/actions/cart&quot;</span>;
<span class="hljs-keyword">import</span> { CartItem } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;@/typings/cart&quot;</span>;
interface Params {
  <span class="hljs-attr">id</span>: string;
}
type RouteProps = RouteComponentProps&lt;Params, StaticContext, Lesson&gt;;
interface Params {
  <span class="hljs-attr">id</span>: string;
}
type StateProps = ReturnType&lt;<span class="hljs-keyword">typeof</span> mapStateToProps&gt;;
type DispatchProps = <span class="hljs-keyword">typeof</span> actions;
type Props = PropsWithChildren&lt;RouteProps &amp; StateProps &amp; DispatchProps&gt;;
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Cart</span>(<span class="hljs-params">props: Props</span>) </span>{
  <span class="hljs-keyword">let</span> [settleVisible, setSettleVisible] = useState(<span class="hljs-literal">false</span>);
  <span class="hljs-keyword">const</span> confirmSettle = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setSettleVisible(<span class="hljs-literal">true</span>);
  };
  <span class="hljs-keyword">const</span> handleOk = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setSettleVisible(<span class="hljs-literal">false</span>);
    props.settle();
  };
  <span class="hljs-keyword">const</span> handleCancel = <span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {
    setSettleVisible(<span class="hljs-literal">false</span>);
  };
  <span class="hljs-keyword">const</span> columns = [
    {
      <span class="hljs-attr">title</span>: <span class="hljs-string">&quot;&#x5546;&#x54C1;&quot;</span>,
      <span class="hljs-attr">dataIndex</span>: <span class="hljs-string">&quot;lesson&quot;</span>,
      <span class="hljs-attr">render</span>: <span class="hljs-function">(<span class="hljs-params">val: Lesson, row: CartItem</span>) =&gt;</span> (
        <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>{val.title}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>&#x5355;&#x4EF7;:{val.price}<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
        <span class="hljs-tag">&lt;/&gt;</span></span>
      ),
    },
    {
      <span class="hljs-attr">title</span>: <span class="hljs-string">&quot;&#x6570;&#x91CF;&quot;</span>,
      <span class="hljs-attr">dataIndex</span>: <span class="hljs-string">&quot;count&quot;</span>,
      <span class="hljs-attr">render</span>: <span class="hljs-function">(<span class="hljs-params">val: number, row: CartItem</span>) =&gt;</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">InputNumber</span>
          <span class="hljs-attr">size</span>=<span class="hljs-string">&quot;small&quot;</span>
          <span class="hljs-attr">min</span>=<span class="hljs-string">{1}</span>
          <span class="hljs-attr">max</span>=<span class="hljs-string">{10}</span>
          <span class="hljs-attr">value</span>=<span class="hljs-string">{val}</span>
          <span class="hljs-attr">onChange</span>=<span class="hljs-string">{(value:any)</span> =&gt;</span> props.changeCartItemCount(row.lesson.id, value)}
        /&gt;</span>
      ),
    },
    {
      <span class="hljs-attr">title</span>: <span class="hljs-string">&quot;&#x64CD;&#x4F5C;&quot;</span>,
      <span class="hljs-attr">render</span>: <span class="hljs-function">(<span class="hljs-params">val: any, row: CartItem</span>) =&gt;</span> (
        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">Popconfirm</span>
          <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;&#x662F;&#x5426;&#x8981;&#x5220;&#x9664;&#x5546;&#x54C1;?&quot;</span>
          <span class="hljs-attr">onConfirm</span>=<span class="hljs-string">{()</span> =&gt;</span> props.removeCartItem(row.lesson.id)}
          okText=&quot;&#x662F;&quot;
          cancelText=&quot;&#x5426;&quot;
        &gt;
          <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">size</span>=<span class="hljs-string">&quot;small&quot;</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;danger&quot;</span>&gt;</span>
            &#x5220;&#x9664;
          <span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Popconfirm</span>&gt;</span></span>
      ),
    },
  ];
  <span class="hljs-keyword">const</span> rowSelection = {
    <span class="hljs-attr">selectedRowKeys</span>: props.cart
      .filter(<span class="hljs-function">(<span class="hljs-params">item: CartItem</span>) =&gt;</span> item.checked)
      .map(<span class="hljs-function">(<span class="hljs-params">item: CartItem</span>) =&gt;</span> item.lesson.id),
    <span class="hljs-attr">onChange</span>: <span class="hljs-function">(<span class="hljs-params">selectedRowKeys: string[]</span>) =&gt;</span> {
      props.changeCheckedCartItems(selectedRowKeys);
    },
  };
  <span class="hljs-keyword">let</span> totalCount: number = props.cart
    .filter(<span class="hljs-function">(<span class="hljs-params">item: CartItem</span>) =&gt;</span> item.checked)
    .reduce(<span class="hljs-function">(<span class="hljs-params">total: number, item: CartItem</span>) =&gt;</span> total + item.count, <span class="hljs-number">0</span>);
  <span class="hljs-keyword">let</span> totalPrice = props.cart
    .filter(<span class="hljs-function">(<span class="hljs-params">item: CartItem</span>) =&gt;</span> item.checked)
    .reduce(
      <span class="hljs-function">(<span class="hljs-params">total: number, item: CartItem</span>) =&gt;</span>
        total + <span class="hljs-built_in">parseFloat</span>(item.lesson.price.replace(<span class="hljs-regexp">/[^0-9\.]/g</span>,<span class="hljs-string">&apos;&apos;</span>)) * item.count,
      <span class="hljs-number">0</span>
    );
  <span class="hljs-keyword">return</span> (
    <span class="xml"><span class="hljs-tag">&lt;&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">NavHeader</span> <span class="hljs-attr">history</span>=<span class="hljs-string">{props.history}</span>&gt;</span>&#x8D2D;&#x7269;&#x8F66;<span class="hljs-tag">&lt;/<span class="hljs-name">NavHeader</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Table</span>
        <span class="hljs-attr">rowKey</span>=<span class="hljs-string">{(row:any)</span> =&gt;</span> row.lesson.id}
        rowSelection={rowSelection}
        columns={columns}
        dataSource={props.cart}
        pagination={false}
        size=&quot;small&quot;
      /&gt;
      <span class="hljs-tag">&lt;<span class="hljs-name">Row</span> <span class="hljs-attr">style</span>=<span class="hljs-string">{{</span> <span class="hljs-attr">padding:</span> &quot;<span class="hljs-attr">5px</span>&quot; }}&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Col</span> <span class="hljs-attr">span</span>=<span class="hljs-string">{4}</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;danger&quot;</span> <span class="hljs-attr">size</span>=<span class="hljs-string">&quot;small&quot;</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{props.clearCartItems}</span>&gt;</span>
            &#x6E05;&#x7A7A;
          <span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Col</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Col</span> <span class="hljs-attr">span</span>=<span class="hljs-string">{9}</span>&gt;</span>
          &#x5DF2;&#x7ECF;&#x9009;&#x62E9;{totalCount &gt; 0 ? <span class="hljs-tag">&lt;<span class="hljs-name">Badge</span> <span class="hljs-attr">count</span>=<span class="hljs-string">{totalCount}</span> /&gt;</span> : 0}&#x4EF6;&#x5546;&#x54C1;
        <span class="hljs-tag">&lt;/<span class="hljs-name">Col</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Col</span> <span class="hljs-attr">span</span>=<span class="hljs-string">{7}</span>&gt;</span>&#x603B;&#x4EF7;: &#xA5;{totalPrice}&#x5143;<span class="hljs-tag">&lt;/<span class="hljs-name">Col</span>&gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">Col</span> <span class="hljs-attr">span</span>=<span class="hljs-string">{4}</span>&gt;</span>
          <span class="hljs-tag">&lt;<span class="hljs-name">Button</span> <span class="hljs-attr">type</span>=<span class="hljs-string">&quot;danger&quot;</span> <span class="hljs-attr">size</span>=<span class="hljs-string">&quot;small&quot;</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{confirmSettle}</span>&gt;</span>
            &#x53BB;&#x7ED3;&#x7B97;
          <span class="hljs-tag">&lt;/<span class="hljs-name">Button</span>&gt;</span>
        <span class="hljs-tag">&lt;/<span class="hljs-name">Col</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Row</span>&gt;</span>
      <span class="hljs-tag">&lt;<span class="hljs-name">Modal</span>
        <span class="hljs-attr">title</span>=<span class="hljs-string">&quot;&#x53BB;&#x7ED3;&#x7B97;&quot;</span>
        <span class="hljs-attr">visible</span>=<span class="hljs-string">{settleVisible}</span>
        <span class="hljs-attr">onOk</span>=<span class="hljs-string">{handleOk}</span>
        <span class="hljs-attr">onCancel</span>=<span class="hljs-string">{handleCancel}</span>
      &gt;</span>
        <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>&#x8BF7;&#x95EE;&#x4F60;&#x662F;&#x5426;&#x8981;&#x7ED3;&#x7B97;?<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
      <span class="hljs-tag">&lt;/<span class="hljs-name">Modal</span>&gt;</span>
    <span class="hljs-tag">&lt;/&gt;</span></span>
  );
}
<span class="hljs-keyword">let</span> mapStateToProps = (state: CombinedState): <span class="hljs-function"><span class="hljs-params">CombinedState</span> =&gt;</span> state;
<span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> connect(mapStateToProps, actions)(Cart);
</code></pre>
<p><a href="https://gitee.com/zhufengpeixun/zhufengketang-client/">https://gitee.com/zhufengpeixun/zhufengketang-client/</a></p>

    </div>
</div>
<div class="modal fade" id="loginModal" tabindex="-1" role="dialog"
    aria-labelledby="loginModalLabel">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"
                    aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="loginModalLabel">请登录</h4>
            </div>
            <div class="modal-body">
                <form>
                    <div class="form-group">
                        <label for="username" class="control-label">姓名:</label>
                        <input type="text" class="form-control" id="username" placeholder="珠峰架构VIP会员系统用户名">
                    </div>
                    <div class="form-group">
                        <label for="password" class="control-label">密码:</label>
                        <input type="text" class="form-control" id="password" placeholder="珠峰架构VIP会员系统密码">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default"
                    data-dismiss="modal">登录</button>
            </div>
        </div>
    </div>
</div>
<script src="https://cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
<script>
$('.warpper .page-toc ul ul li a').on('click',function(){
  $('.warpper .page-toc ul ul li a').removeClass('my-active')
  $(this).addClass('my-active')
})
$('.logo').on('mouseenter',function(){
  $('.nav').height('450px');
})
$('.nav').on('mouseleave',function(){
  $('.nav').height('80px');
})
$('.logo').on('click',function(){
  $('.nav').css('display','none');
 $('.warpper').css('padding','0px');
})
</script>
</body>
</html>
